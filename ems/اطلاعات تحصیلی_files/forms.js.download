var selfAntiUgly,ParamsAntiUgly,GlobViewModel={};function attachHashToUrl(e,t){return t&&(e+=(e.includes("?")?"&":"?")+"npantihash="+t),e}loadedScripts=new Set,loadedStyles=new Set,NowPardaz=np={apiUrl:"",staticUrl:"",newVersion:!1,faciNote:-1,ng:!!window.NowPardaz_Ng,NoSwitchLangByCtrl:!!window.lang?.NoSwitchByCtrl,ShowLangOption:!window.lang?.NoShowOption,noNg:e=>e(),byNg:e=>e(),stripHtmlTags:e=>$("<A>"+(e||"")+"</A>").text(),loadScript:(e,t)=>(e=attachHashToUrl(e,t),loadedScripts.has(e)?Promise.resolve():new Promise(((t,n)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onload=()=>{loadedScripts.add(e),t()},a.onerror=()=>n(new Error(`Failed to load script: ${e}`)),document.head.appendChild(a)}))),loadStyle:(e,t)=>(e=attachHashToUrl(e,t),loadedStyles.has(e)?Promise.resolve():new Promise(((t,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,a.onload=()=>{loadedStyles.add(e),t()},a.onerror=()=>n(new Error(`Failed to load style: ${e}`)),document.head.appendChild(a)}))),simpleHash:e=>{let t=BigInt("0xcbf29ce484222325");const n=BigInt("0x100000001b3");for(let a=0;a<e.length;a++)t^=BigInt(e.charCodeAt(a)),t=t*n&BigInt("0xFFFFFFFFFFFFFFFF");return t.toString(16).padStart(16,"0")},CmpSvcVar:{},ExtraDataCache:{},GrdColCaptionElem1:"<span class='text-Grdinfo'>",GrdColCaptionElem2:"</span>: ",GrdColCaptionElem3:": </span>",GrdColCaptionClass:"text-Grdinfo",DomainUrl:"",tit:"",NPVars:{},CloseAllFaci:!0,DefaultMenuCmpId:11130,ExitMsg:!0,OPTOPT:"_OPT",ACDesc:"_desc",ACTip:"_tip",VMCmpXml:"_xml",VMCmpXmlUppercase:"_XML",JSFolder:"",tabTemplate:"<li id='#{liid}' title='#{label}' style='float:right'  ><a href='#{href}' class='nav-link' data-toggle='tab' style='box-sizing:content-box;max-width: "+parseInt($(window).width()/6)+"px; text-overflow: ellipsis; white-space: nowrap; overflow: hidden;'><i style='margin-left: 5px' class='glyphicon glyphicon-remove' ></i><i class='np-icon np-icon-loader'   style='display:none;margin-left: 5px;' ></i><span>#{label}</span></a></li>",P_IDIDID:"P_IDIDID",rtl:"undefined"!=typeof npIsLatin&&npIsLatin?"ltr":"rtl",npuuid:0,ValidChars:{Email:"~!~#$%&~~~*+~-./0123456789~~~=~?@ABCDEFGHIJKLMNOPQRSTUVWXYZ~~~^_~abcdefghijklmnopqrstuvwxyz{|}~",AlLatin:" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ABCDEFGHIJKLMNOPQRSTUVWXYZ~~~~~~abcdefghijklmnopqrstuvwxyz~~~~",AlFarsi:" ~~~~~~گ~~~~و~~~~~~~~~~~~~~ك~~~~~شذژيثّلآهتنمءدخحضقس،عرصطغظجپچ~~ژشذزيثبلاهتنمئدخحضقسفعرصطغظ~~~ّ",Al2Latin:" ~~~~%~~~~~~~~~~~~~~~~~~~~~~~~~~~ABCDEFGHIJKLMNOPQRSTUVWXYZ~~~~~~abcdefghijklmnopqrstuvwxyz~~~~",Al2Farsi:" ~~~~%~گ)(~~و~~~~~~~~~~~~~~ك~~~~~شذژيثّلآهتنمءدخحضقس،عرصطغظجپچ~~ژشذزيثبلاهتنمئدخحضقسفعرصطغظ~~~ّ",ANumFarsi:" ~~~~~~گ~~~~و~~~0123456789~ك~~~~~شذژيثّلآهتنمءدخحضقس،عرصطغظجپچ~~ژشذزيثبلاهتنمئدخحضقسفعرصطغظ~~~ّ",ANumLatin:" ~~~~~~~~~~~~~~~0123456789~~~~~~~ABCDEFGHIJKLMNOPQRSTUVWXYZ~~~~~~abcdefghijklmnopqrstuvwxyz~~~~",ANum2Farsi:" ~~~~%~گ)(~~و~~~0123456789~ك~~~~@شذژيثّلآهتنمءدخحضقس،عرصطغظجپچ~~ژشذزيثبلاهتنمئدخحضقسفعرصطغظ~~~ّ",ANum2Latin:" ~~~~%~~~~~~~~~~0123456789~~~~~~~ABCDEFGHIJKLMNOPQRSTUVWXYZ~~~~~~abcdefghijklmnopqrstuvwxyz~~~~",HtmFarsi:' !"#$%،گ)(×+و-./0123456789:ك،=.؟@شذژيثّلآهتنمءدخحضقس،عؤصطغظجپچ^_ژشذزيثبلاهتنمئدخحضقسفعرصطغظ<|>ّ'},IscalendarLoaded:0,FarsiNumbers:["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"]},localStorage.getItem("NoSwitchLangByCtrl")&&("1"==localStorage.getItem("NoSwitchLangByCtrl")?np.NoSwitchLangByCtrl=!1:"2"==localStorage.getItem("NoSwitchLangByCtrl")&&(np.NoSwitchLangByCtrl=!0)),SetJSFolder=function(){var e="";$("script[src]").each((function(t,n){var a=$(n).attr("src");if(e=a.substr(0,a.indexOf("forms.js")))return!1})),np.JSFolder=e}(),$(document).ready((function(){try{var e=$.fn.button.noConflict();$.fn.bootstrapBtn=e}catch(e){}try{$.fn.modal.Constructor.prototype.enforceFocus=function(){}}catch(e){}try{$.fn.tooltip.Constructor.Default.trigger="hover"}catch(e){}np.utils.ControlChangeLastModified(np.JSFolder+"forms.js",(function(e){var t=np.utils.NPLocalStorage(0,1,"FORMSJS"),n=np.simpleHash(e);if(np.utils.NPLocalStorage(0,1,"FORMSJS",n),t&&t!=n&&0!==np.JSFolder.indexOf("https:")){var a=[];return $("head>link[href]",document).each((function(e,t){a.push($(t).attr("href"))})),$("head>script[src]",document).each((function(e,t){a.push($(t).attr("src"))})),void function e(){if(!a.length)return np.utils.NPLocalStorage(0,1,"FORMSJS",n),void np.noNg((()=>setTimeout((function(){np.newVersion=!0}),2e3)));var t=a.pop();np.noNg((()=>$.ajax({url:t,cache:!0,async:!0,dataType:"text",beforeSend:function(e){$.browser.chrome||e.setRequestHeader("If-Modified-Since","Mon, 26 Jul 1997 05:00:00 GMT"),e.setRequestHeader("Cache-Control","no-cache")},success:function(e,t){},error:function(){}}).done((function(){e()}))))}()}}));$('<div np5ht7 id="LangShow" style="position:absolute;display:none;z-index:10000"><div class="ui-state-highlight">Fa</div></div>').prependTo("body"),GlobViewModel.LangShow=$("#LangShow"),GlobViewModel.vm_Time=function(e){},$("body").on("scroll",(function(){GlobViewModel.LangShow.hide()})),$("body").on("mouseenter",'[data-toggle="tooltip"]',(function(e){var t=e.currentTarget,n=$(t);t.offsetWidth>t.scrollWidth?n.removeAttr("title"):n.tooltip("show")}))})),np.fillCmpNames=function(e,t,n){var a=0!==t.indexOf("/frmc/")?n:n+"/"+n,o=0!==t.indexOf("/frmc/")?"controlchange":n+"/controlchange";e.CC_Filename=t+o+".htm",np.loc&&"fa"!==np.loc&&(t=t.replace("/frm/","/frmloc/"+np.loc+"/")),e.Js_FileName=t+a+".js",e.Html_FileName=t+a+".htm",e.Xml_FileName=t+a+".json",e.H_FileName=t+"usrhlp.json"},np.showRep=function(e,t){np.loadnpform($("#repViewer"),{CmpId:110015,AddrPath:"/frm/BAS0237_CMP_ViewReport/",FName:"BAS0237_CMP_ViewReport"},(n=>{setTimeout((()=>{var n=$.data($("#repViewer")[0])["np-BAS0237_CMP_ViewReport"];n.Resp=e,n.ActNo="08",n.Get_Data(null,{MethodType:"1",ActNo:"08",ErLen:0,WarLen:0,UserLvl:"268435457",Usrfrm:"1"}),setTimeout((()=>{n.getHtml(t)}),2e3)}),2e3)}))},np.loadnpform=function(e,t,n){var a;function o(){var o=$(e).uniqueId(),i=o.prop("id"),r=np.utils.NPLocalStorage(a.CmpType,a.CmpId,"HTML");t.IsMakedFullId=!!r.match(np.P_IDIDID),t.IsMakedFullId&&(r=r.replace(new RegExp("#"+np.P_IDIDID+"#*","g"),i)),o.html(r),$("#"+i+"bod",o).css("height","inherit").css("overflow",""),$("#"+i+"dvfrmFooter",o).css({position:"sticky",bottom:"0px"}),$.NPCreateWidget(o,t.FName,t);var l=np.utils.GetWidgetSelf(o,t.FName);t.Itself=l,n&&n(l)}a={CmpId:t.CmpId,CmpType:t.CmpType||0},np.fillCmpNames(a,t.AddrPath,t.FName),a.CmpId&&a.Html_FileName?np.utils.NPLocalStorage(a.CmpType,a.CmpId,"HTML")?o():np.utils.GetComponent(a,o):alert("Wrong CmpId")},np.ManageNpCustom=function(e,t,n){switch($("npCustom",e).attr("type")){case"showpic":var a=(l=$("npCustom",e)).attr("param");a=JSON.parse(a);var o="";$.each(a.attr,(function(e,t){o+=e+"="+t+" "}));try{var i="<img "+o+" src='/frm/showpic/showpic.ashx?src="+a.src+"&a="+t._npform.GetAut()+"&t="+a.t+"&s="+a.s+"&C="+a.C+"&ttt"+parseInt(1e6*Math.random())+"="+Math.random()+"' />"}catch(e){var r=np.utils.GetWidgetSelf($(n.closest(".np-fitdivtoparent.tab-pane")));i="<img "+o+" src='/frm/showpic/showpic.ashx?src="+a.src+"&a="+r.GetAut()+"&t="+a.t+"&s="+a.s+"&C="+a.C+"&ttt"+parseInt(1e6*Math.random())+"="+Math.random()+"' />"}e=t?e.replace(/<\s*npCustom[^>]*>(.*?)<\s*\/\s*npCustom>/g,i):e.replace(/<\s*npcustom[^>]*>(.*?)<\s*\/\s*npcustom>/g,i);break;case"button":for(var l=$("npCustom",e),s=0;s<l.length;s++){a=$(l[s]).attr("param");var d=$(l[s]).attr("caption"),p="";p=void 0===(a=JSON.parse(a)).enable||"1"==a.enable?"<button class='btn btn-outline-primary' type='button' style='margin-left: 5px; margin-right: 5px;' click='"+a.onclick+"'>"+d+"</button>":"<button class='btn btn-outline-info np-npButton-disabled' disabled type='button' style='margin-left: 5px; margin-right: 5px;' click='"+a.onclick+"'>"+d+"</button>",e=e.replace(/<\s*npCustom[^>]*>(.*?)<\s*\/\s*npCustom>/m,p)}break;case"help":for(l=$("npCustom",e),s=0;s<l.length;s++){a=$(l[s]).attr("param");var c="<a class='np-icon-only' click='"+(a=JSON.parse(a)).onclick+"' style='cursor:pointer;padding-right:0px;'><svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='20' style='fill:#337ab7;vertical-align: middle;' height='20' viewBox='0 0 32 32'><path d='M11.772 20.164v2.871q0 0.251 0.162 0.413t0.413 0.162h2.871q0.251 0 0.413-0.162t0.162-0.413v-2.871q0-0.251-0.162-0.413t-0.413-0.162h-2.871q-0.251 0-0.413 0.162t-0.162 0.413zM7.178 11.264q0 0.897 0.269 1.615t0.816 1.238 0.933 0.79 1.068 0.646q0.574 0.323 0.834 0.502t0.467 0.431 0.206 0.52v0.574q0 0.251 0.162 0.413t0.413 0.162h2.871q0.251 0 0.413-0.162t0.162-0.413v-1.22q0-0.628-0.188-1.157t-0.431-0.852-0.7-0.637-0.736-0.458-0.799-0.377q-0.951-0.449-1.346-0.772t-0.395-0.879q0-0.754 0.781-1.283t1.714-0.529q1.005 0 1.705 0.485 0.52 0.359 1.436 1.489 0.162 0.215 0.449 0.215 0.197 0 0.341-0.108l1.938-1.471q0.18-0.126 0.215-0.359t-0.090-0.413q-2.189-3.445-6.263-3.445-2.315 0-4.28 1.606t-1.965 3.849zM13.781 3.225q2.333 0 4.459 0.915t3.661 2.449 2.449 3.661 0.915 4.459-0.915 4.459-2.449 3.661-3.661 2.449-4.459 0.915-4.459-0.915-3.661-2.449-2.449-3.661-0.915-4.459 0.915-4.459 2.449-3.661 3.661-2.449 4.459-0.915zM0 14.709q0 3.75 1.848 6.918t5.016 5.015 6.918 1.848 6.918-1.848 5.015-5.015 1.848-6.918-1.848-6.918-5.015-5.016-6.918-1.848-6.918 1.848-5.016 5.016-1.848 6.918z'></path></svg></a>";e=e.replace(/<\s*npCustom[^>]*>(.*?)<\s*\/\s*npCustom>/m,c)}}return e},np.npUniqueId=function(){return"np-id-"+ ++np.npuuid},np.NPPkgs={epay:{js:[{f:np.JSFolder+"epay.js"}],css:[]},charts:{js:[{f:np.JSFolder+"Chart.bundle.js"},{f:np.JSFolder+"Chart.utils.js"},{f:"/pkg/highchart/highcharts.js"},{f:"/pkg/highchart/highcharts-more.js"},{f:"/pkg/highchart/highcharts-3d.js"},{f:"/pkg/highchart/full-screen.js"},{f:"/pkg/highchart/exporting.js"},{f:"/pkg/highchart/export-data.js"},{f:"/pkg/highchart/modules/drilldown.src.js"},{f:"/pkg/highchart/modules/xrange.js"},{f:"/pkg/highchart/npHighcharts.js"}],css:[]},npmenudrag:{js:[{f:np.JSFolder+"npmenu.js"},{f:np.JSFolder+"npmenudrag.js"}],css:[]},npmenuTemp:{js:[{f:np.JSFolder+"npmenuTemp.js"}],css:[]},npmenu:{js:[{f:np.JSFolder+"npmenu.js"},{f:np.JSFolder+"npmenuMobile.js"},{f:np.JSFolder+"npmenuicon.js"}],css:[]},npviewer:{js:[{f:np.JSFolder+"npviewer.js"}],css:[]},autocomplete:{js:[{f:np.JSFolder+"autocomplete.js"}],css:[]},calendar:{js:[{f:np.JSFolder+"jqui.date.js"},{f:np.JSFolder+"jqui.date.persianDatepicker.js"},{f:np.JSFolder+"jqui.date-fa.js"}],css:[]},cleditor:{js:[{f:"/pkg/cleditor/jquery.cleditor.js"}],css:[{f:"/pkg/cleditor/jquery.cleditor.css"}]},dynatree:{js:[{f:"/pkg/dynatree/jquery.dynatree.js"},{f:"/pkg/dynatree/contextMenu/jquery.contextMenu-custom.js"}],css:[{f:"/pkg/dynatree/skin/ui.dynatree.css"},{f:"/pkg/dynatree/contextMenu/jquery.contextMenu.css"}]},codemirror:{js:[{f:"/pkg/codemirror/lib/codemirror.js"},{f:"/pkg/codemirror/mode/xml/xml.js"},{f:"/pkg/codemirror/addon/dialog/dialog.js"},{f:"/pkg/codemirror/addon/search/searchcursor.js"},{f:"/pkg/codemirror/addon/search/search.js"},{f:"/pkg/codemirror/addon/scroll/annotatescrollbar.js"},{f:"/pkg/codemirror/addon/search/matchesonscrollbar.js"},{f:"/pkg/codemirror/addon/fold/foldcode.js"},{f:"/pkg/codemirror/addon/fold/foldgutter.js"},{f:"/pkg/codemirror/addon/fold/brace-fold.js"},{f:"/pkg/codemirror/addon/fold/xml-fold.js"},{f:"/pkg/codemirror/addon/fold/markdown-fold.js"},{f:"/pkg/codemirror/addon/fold/comment-fold.js"},{f:"/pkg/codemirror/mode/markdown/markdown.js"},{f:"/pkg/codemirror/addon/hint/show-hint.js"},{f:"/pkg/codemirror/addon/hint/javascript-hint.js"},{f:"/pkg/codemirror/addon/hint/sql-hint.js"},{f:"/pkg/codemirror/mode/javascript/javascript.js"},{f:"/pkg/codemirror/mode/css/css.js"},{f:"/pkg/codemirror/mode/vb/vb.js"},{f:"/pkg/codemirror/mode/htmlmixed/htmlmixed.js"},{f:"/pkg/codemirror/mode/sql/sql.js"},{f:"/pkg/codemirror/formatting.js"},{f:"/pkg/codemirror/addon/fullscreen/fullscreen.js"}],css:[{f:"/pkg/codemirror/lib/codemirror.css"},{f:"/css/npcodemirror.css"},{f:"/pkg/codemirror/addon/dialog/dialog.css"},{f:"/pkg/codemirror/addon/search/matchesonscrollbar.css"},{f:"/pkg/codemirror/addon/fold/foldgutter.css"},{f:"/pkg/codemirror/addon/hint/show-hint.css"}]}},np.utils=function(){var SetDefaultExpr=new RegExp("#P_[^#]+#","g"),NPResponseCache={},NPComponentsHtml={},NPComponentsXml={},NPComponentsHelp={},NPComponentsJsCode={},NPComponentsJsRun={},NPComponentState={};function replaceZone(e){return e=e||""}return{SetDefaultExpr:SetDefaultExpr,NPClearLocalStorage:function(){NPResponseCache={},NPComponentsHtml={},NPComponentsXml={},NPComponentsHelp={},NPComponentsJsCode={},NPComponentsJsRun={},NPComponentState={}},eval:function(x){return eval(replaceZone(x))},ResponseCache:function(e,t){return t&&(NPResponseCache[e]=t),NPResponseCache[e]},GetNPComponentState:function(){return NPComponentState},NPLocalStorage:function(e,t,n,a,o){if(!1,t="0_"+t,"HTML"!=n&&"XML"!=n&&"JS"!=n&&"H"!=n)return a&&(localStorage[n+"_"+t]=a),o&&localStorage.removeItem(n+"_"+t),localStorage[n+"_"+t];switch(n){case"HTML":if(""===a)NPComponentsHtml[t]=a;else if(a){var i=a.substring(a.indexOf("<body"),a.indexOf("</body>"))||"";i=i.substring(i.indexOf(">")+1,i.length)||"",NPComponentsHtml[t]=i}return NPComponentsHtml[t];case"XML":return a&&(NPComponentsXml[t]=a),NPComponentsXml[t];case"H":return a&&(NPComponentsHelp[t]=a),NPComponentsHelp[t]}},escapeXml:function(e){return e.replace(/[<>&'"]/g,(function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}}))},unescapeXml:function(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},GetWidgetSelf:function(e,t){return t||(t=e.data("NPWidget")),t?e[t]("instance"):null},ControlChangeLastModified:function(e,t){var n;window.XMLHttpRequest&&(n=new XMLHttpRequest),n.open("HEAD",e+"?t="+Math.random(),!0);var a=!0;n.onreadystatechange=function(){4===n.readyState&&a&&(a=!1,200===n.status?t(n.getResponseHeader("Last-Modified"),n.getResponseHeader("ETag")):t(!1))},np.noNg((()=>n.send()))},StandardHtml:function(e){var t={flag:"",Str:""};return null==e.match(/(<[^>]*\son\w*=[^>]*>)|(<[^>]*\w*=\W\s*javascript\s*:[^>]*>)|(<\s*\/?\s*(script|source|embed|body|head|html|iframe|audio|object|frameset|meta)\s*.*?>)/gi)?(t.Str=e,t.flag=!0):(t.flag=!1,t.Str=np.stripHtmlTags(e)),t},NPTrim:function(e){return null==e||null==e?"":"object"==typeof e?e:e.toString().replace(/(^\s*)|(\s*$)/g,"")},GetComponent:function(e,t){var n,a,o,i,r=e.CmpId,l=e.CmpType,s=e.H_FileName,d={CmpId:r,status:!0,description:""};if(!e||!((n=e.Js_FileName)&&(a=e.Html_FileName)&&(o=e.Xml_FileName)&&(i=e.CC_Filename)))return d.status=!1,d.description="no valid component",void t.call(this,d);var p=np.utils.GetNPComponentState()[r]=np.utils.GetNPComponentState()[r]||{};if(p.Loaded)return d.description="This Cmp is Loaded Before",void setTimeout((function(){t.call(this,d)}),0);p.CallBacks?p.CallBacks.push(t):(p.CallBacks=[],p.CallBacks.push(t),np.utils.ControlChangeLastModified(np.staticUrl+i,(function(e,t){np.utils.NPLocalStorage(l,r,"CC","",!0);var c,u,m,f=0;if(!1===e)return np.utils.NPLocalStorage(l,r,"HTML",""),np.utils.NPLocalStorage(l,r,"XML",""),p.Loaded=!1,d.status=!1,d.description="error in get:"+i,$.each(p.CallBacks,(function(e,t){t.call(this,d)})),void delete p.CallBacks;var h=np.simpleHash(e),g="?npantihash="+h,C=2;function v(){if(++f<C);else{function e(){d.status=!1,$.each(p.CallBacks,(function(e,t){t.call(this,d)})),delete p.CallBacks}if(!c||!u)return void e();np.loadScript(np.staticUrl+n,h).then((()=>{np.utils.NPLocalStorage(l,r,"HTML",c),np.utils.NPLocalStorage(l,r,"XML",u),np.utils.NPLocalStorage(l,r,"H",m),p.Loaded=!0,d.description="success in get:"+n+","+a,$.each(p.CallBacks,(function(e,t){t.call(this,d)}))})).catch((t=>{console.error("loadScript:"+t),e()}))}}var b={cache:!0,async:!0,dataType:"text",beforeSend:function(e){e.setRequestHeader("ngsw-bypass","true")},error:function(){v()},success:function(e){this.url==np.staticUrl+o+g&&(u=e),this.url==np.staticUrl+a+g&&(c=e),this.url==np.staticUrl+s+g&&(m=e),v()}};s&&(C++,b.url=np.staticUrl+s+g,np.noNg((()=>$.ajax(b)))),b.url=np.staticUrl+o+g,np.noNg((()=>$.ajax(b))),b.url=np.staticUrl+a+g,np.noNg((()=>$.ajax(b)))})))},GetScrollbarWidth:function(e){if(void 0===np.NPVars.ScrollbarWidth||e){var t=$("<div />").css({width:100,height:100,overflow:"scroll",position:"absolute",top:-200,left:-200}).append($("<div />").css({width:200,height:200})).appendTo("body");np.NPVars.ScrollbarWidth=t[0].offsetWidth-t[0].clientWidth,t.remove()}return np.NPVars.ScrollbarWidth},NPChangeNumToFarsi:function(e){try{e=e.toString()}catch(e){}var t,n=e.length;for(t=0;t<n;t++){var a=e.charCodeAt(t);a>47&&a<58&&(e=e.substr(0,t)+String.fromCharCode(a+1776-48)+e.substr(t+1))}return e},NPChangeNumToLatin:function(e){return e},NPChangeNumToUnicode:function(e){return e}}}(),function($,np){$.widget("np.nptinybutton",{options:{icon:"edit",title:null,attr:null},_create:function(){var e=this.options,t=this.element;e.title||(e.title="edit"==e.icon?"اصلاح":"delete"==e.icon?"حذف":"view"==e.icon?"نمايش":"help"==e.icon?"راهنما":"send"==e.icon?"ارسال":"confirm"==e.icon?"تاييد":"confsend"==e.icon?"تایید و ارسال":"detail"==e.icon?"جزييات":"viewflow"==e.icon?"مشاهده گردش کار":"cancel"==e.icon?"لغو درخواست":"viewflowA"==e.icon?"مشاهده گردش کار اتوماسيون":"-"),t.html("&nbsp;").attr("title",e.title).attr("np-icon",e.icon).addClass("np-tinyicon np-tinyicon-"+e.icon),e.attr&&$.each(e.attr,(function(e,n){t.attr(e,n)}))},cont:function(){this.options;return this.element.OuterHTML()},_destroy:function(){$(this.element).removeClass("np-tinyicon np-tinyicon-"+this.options.icon).removeAttr("np-icon").removeAttr("title")}}),$.widget("np.SimpleDialog",{options:{show:!1,appendTo:null,class:"col-lg-9 col-12",beforeClose:null,close:null,onShow:null,closeButton:!1,title:"",destroyOnClose:!1,parShowElem:[]},_create:function(){var e=this,t=e.options,n=e.element;if(t.appendTo){for(var a=$(t.appendTo),o=null,i=null;a;){if(i=a.data("NPWidget"))try{o=a[i]("instance");break}catch(e){}a=a.parent()}t.formsWidgetSelf=o}else t.appendTo=$("body");e.htmlOrBody=$("html");var r=e.ol=$("<div class='flex-grow-1 w-100 np-d-none d-flex flex-column align-items-center'/>").prependTo(t.appendTo);e.uid=r.uniqueId().attr("id");var l=e.wr=$("<div class='np-SimpleDialog flex-grow-1 d-flex flex-column "+t.class+"'/>").appendTo(r);t.closeButton&&(e.$titwr=$('<div class="d-flex"/>'),e.$Backbtndv=$('<button class="btn btn-outline-info" style="border:0"><svg version="1.1" xmlns="http://www.w3.org/2000/svg"   xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 170 150" xml:space="preserve">   <path style="fill:#2b5989;stroke-width:0.35660052;fill-opacity:1" inkscape:connector-curvature="0" d="m 0.39537578,80.46493 a 80.235119,80.235119 0 1 0 160.47023422,0 80.235119,80.235119 0 1 0 -160.47023422,0" ></path>   <path  d="m 6.8704361,80.46493 a 73.760058,73.760058 0 1 0 147.5201139,0 73.760058,73.760058 0 1 0 -147.5201139,0" inkscape:connector-curvature="0" style="fill:#ffffff;stroke-width:0.32782248"></path>   <path style="fill:#2b5989;stroke-width:0.11146249;fill-opacity:1" inkscape:connector-curvature="0" d="m 27.181084,87.0289 h 81.175586 l -37.415216,37.53242 9.689032,9.35302 53.449414,-53.4494 -53.449414,-53.44941 -9.352702,9.35333 37.078886,37.4149 H 27.181084 v 13.36235 z" ></path></svg></button>').on("click",(function(){e.close()})).wrap("<div />").parent(),e.$titwr.append(e.$Backbtndv),e.$title=$("<div></div>").html(t.title||"").addClass("pr-2").appendTo(e.$titwr),l.append(e.$titwr)),e.saveCSS={style:n.attr("style"),class:n.attr("class")},n.addClass("d-flex flex-column flex-grow-1"),e.saveParent=n.wrap("<div/>").parent(),l.append(n),t.show?e.show():e.hide()},open:function(e){this.show(e)},show:function(e){var t=this,n=t.options;t._isOpen||(n.formsWidgetSelf?.GetngData()&&np.byNg((()=>{n.formsWidgetSelf.GetngData().AngularTab.openSimpleDialog?n.formsWidgetSelf.GetngData().AngularTab.openSimpleDialog(n.title,(()=>{t.close()})):n.formsWidgetSelf.GetngData().AngularFaci.setHideBackButton&&n.formsWidgetSelf.GetngData().AngularFaci.setHideBackButton(!0)})),t.saveScroll={top:t.htmlOrBody.scrollTop(),left:t.htmlOrBody.scrollLeft()},t._isOpen=!0,t.ol.removeClass("np-d-none"),t.$childstate=[],n.appendTo.children().each((function(e,a){var o=$(a).attr("orgid"),i=$(a).attr("id"),r=[];n.parShowElem&&n.parShowElem.includes(o)||i==t.uid||($(a).hasClass("d-none")&&r.push("d-none"),$(a).hasClass("np-d-none")&&r.push("np-d-none"),$(a).addClass("np-d-none")),t.$childstate.push(r)})),t._trigger("onShow",e),t.htmlOrBody[0].scrollTop=0)},hide:function(){var e=this,t=e.options;e._isOpen&&(e._isOpen=!1,t.formsWidgetSelf?.GetngData()&&np.byNg((()=>t.formsWidgetSelf.GetngData().AngularFaci.setHideBackButton&&t.formsWidgetSelf.GetngData().AngularFaci.setHideBackButton(!1))),e.ol.addClass("np-d-none"),t.appendTo.children().each((function(n,a){var o=$(a).attr("orgid"),i=$(a).attr("id");t.parShowElem&&t.parShowElem.includes(o)||i==e.uid||($(a).removeClass("np-d-none"),$(e.$childstate[n]).each((function(e,t){$(a).addClass(t)})))})),e.htmlOrBody[0].scrollTop=e.saveScroll.top)},close:function(e){var t=this,n=t.options;!1!==t._trigger("beforeClose",e)&&($(".tooltip","body").remove(),t.hide(),t._trigger("close",e),n.destroyOnClose&&t.destroy())},_setOption:function(e,t){this._super(e,t),"title"===e&&this.$title&&this.$title.html(t)},_destroy:function(e,t){var n=this,a=(n.options,n.element);n.hide(),a.find("iframe").prop("src","../blank.htm").remove(),a.attr("style",n.saveCSS.style),a.attr("class",n.saveCSS.class),a.appendTo(n.saveParent).unwrap(),n.ol.remove()}}),$.widget("np.npUiDialog",$.ui.dialog,{options:{dialogClass:"np-npDialog",MobilityWeight:5,closeText:"بستن",draggable:!1,StopDraggable:!1,parentModal:null,IsEditor:!1,width:"auto",height:"auto",resizable:!1,CloseParentModal:!0,ParentIsDialog:!1,Top:null,contentMarginBottom:0,title:null,Class:null,position:{my:"center",at:"center",of:window},IsMessage:!1,OverlayClickEvent:!1,maxHeight:null,npDialog:null,CloseIcon:null,ClosePosition:"right",overflowX:"hidden",overflowY:"auto",npform:null,appendTo:"body"},_createTitlebar:function(){this._super(),this.uiDialogTitlebarClose.html('<i class="glyphicon glyphicon-remove text-danger" style="font-size:16px;padding-left:10px;vertical-align: top;margin-right:10px"></i>'),this.uiDialogTitlebar.css({position:"sticky",top:0,zIndex:1,backgroundColor:"white"})},_create:function(){var e,t=this,n=t.options;(n.OverlayClickEvent||(n.OverlayClickEvent=n.closeOnEscape),n.IsHelp||n.Class||n.size)||(n.Class=n.Class?n.Class:"col-lg-8 col-12",n.width=n.width&&"auto"!=n.width?n.width:"auto","auto"!=n.width?e=isNaN(n.width)?n.width.split("px")[0]:n.width+"":n.Class="col-lg-11 col-12",e&&t.ConvertWidthToClass(e));(n.size&&("lg"==n.size&&(n.Class="col-lg-7 col-12"),"md"==n.size&&(n.Class="col-lg-4 col-12"),"sm"==n.size&&(n.Class="col-lg-3 col-12")),n.IsHelp&&!isNaN(n.width)&&(n.width+=12),this.options.appendTo&&this.options.position.of==window&&(this.options.position.of=this.options.appendTo,delete this.options.position.collision),this._super(),n.Class)&&($(t.element).parent().addClass("row").addClass(n.Class).css("padding","0px"),n.width="none");this.uiDialogTitlebarClose.removeAttr("class").css({width:"32px"}).addClass("close"),"left"==n.ClosePosition&&$(this.uiDialogTitlebar).prepend(this.uiDialogTitlebarClose),n.CloseIcon&&$("i",this.uiDialogTitlebar).removeClass("glyphicon-remove").addClass(n.CloseIcon),this.fixTitle(),$(this.uiDialogTitlebar).css({display:"flex","flex-direction":"row-reverse"}),this.uiDialogTitlebar.next("div").removeClass("ui-widget-content"),t._on({"mousedown button.close":function(){return!1}}),$(window).width()<=768&&(this.options.StopDraggable=!0),!this.options.StopDraggable&&this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",start:function(e,t){t.helper.removeClass("np-ui-dialog-top")},stop:function(e,t){var n=$(window).width(),a=$(window).height();t.helper.position().top<0&&t.helper.css("top","50px"),t.helper.position().left>n-50&&t.helper.css("left",n-50+"px"),t.helper.position().left<50-t.helper.width()&&t.helper.css("left",50-t.helper.width()+"px"),t.helper.position().top>a-200&&t.helper.css("top",a-200+"px")}}),$(this.element).parent().addClass("np-ui-dialog-position").on("click",(function(e){$(e.target).is("i.glyphicon-remove")||t.SetZIndex($(t.element).parent())}))},fixTitle:function(){var e=this,t=(e.options,$(".ui-dialog-title",e.uiDialogTitlebar).text());$(".ui-dialog-title",e.uiDialogTitlebar).html(t).addClass("text-danger").css({width:"calc(100% - 32px)"})},_setOption:function(e,t){(this._super(e,t),"title"===e&&this.uiDialogTitlebar.find(".ui-dialog-title").attr("np-title",t),"contentMarginBottom"===e&&this.element.css("margin-bottom",t),"disabled"===e&&$(this.element).prop("disabled",t),"label"===e&&t&&$(this.element).text(t),"height"===e&&(this.options.height="auto"),"width"===e)&&(this.ConvertWidthToClass(t),this.options.Class&&($(this.element).parent().addClass("row").addClass(this.options.Class).css("padding-right","0px"),this.options.width="none"));if("type"===e)switch($(this.element).attr("class",""),t){case"default":case"info":$(this.element).addClass("btn btn-outline-info");break;case"success":$(this.element).addClass("btn btn-outline-success");break;case"warning":$(this.element).addClass("btn btn-outline-warning");break;case"danger":$(this.element).addClass("btn btn-outline-danger")}},ConvertWidthToClass:function(e){var t=this.options;$(this.element).parent().removeClass((function(e,t){return(t.match(/\S*col-\S+/g)||[]).join(" ")})),(e=isNaN(e)?e.split("px")[0]:e+"")<=300&&(t.Class="col-lg-3 col-12"),300<e&&e<=400&&(t.Class="col-lg-4 col-12"),400<e&&e<=500&&(t.Class="col-lg-5 col-12"),500<e&&e<=600&&(t.Class="col-lg-6 col-12"),600<e&&e<=700&&(t.Class="col-lg-7 col-12"),700<e&&e<=800&&(t.Class="col-lg-8 col-12"),800<e&&e<=1e3&&(t.Class="col-lg-9 col-12"),1e3<e&&e<=1200&&(t.Class="col-lg-10 col-12"),e>=1200&&(t.Class="col-lg-12 col-12"),-1!=e.indexOf("%")&&((e=e.split("%")[0])<=50&&(t.Class="col-lg-6 col-12"),e>50&&e<70&&(t.Class="col-lg-8 col-12"),e>=70&&e<90&&(t.Class="col-lg-10 col-12"),e>=90&&(t.Class="col-lg-11 col-12"))},_moveToTop:function(e,t){return!!this.options.IsHelp&&this._super.apply(this,arguments)},open:function(e,t,n){var a=this,o=this.options,i=$(".scrollable-container");o.modal&&($("body").addClass("modal-open"),i&&i.length>0&&i.addClass("modal-open")),(!isNaN(o.width)&&o.width>$(window).width()||!isNaN(o.height)&&o.height>$(window).height())&&(o.width="95%",o.height=$(window).height()-100);var r=$(o.appendTo).attr("id")?o.appendTo.attr("id"):o.appendTo,l=$(".modal.show[parent="+r+"]",this.options.appendTo);this.options.IsEditor?this.options.parentModal.modal("hide"):this.options.CloseParentModal&&!o.IsHelp&&l.modal("hide"),this.SetZIndex($(this.element).parent(),"All"),$(this.element).parent().addClass("np-ui-dialog-top"),this._super(),(o.IsHelp||o.npDialog)&&(a.element.parent().css({"max-height":"80%","overflow-y":"auto"}),a.element.css({"max-height":"100%","overflow-y":o.overflowY,"overflow-x":o.overflowX})),o.maxHeight&&a.element.parent().css({"max-height":o.maxHeight+"px","overflow-y":"auto"}),$(".tooltip","body").remove(),np.noNg((()=>setTimeout((function(){o.modal&&($("#ScrollTop_Btn").fadeOut(),$("#ScrollBottom_Btn").fadeOut()),a.offScreen(a.element.parent()[0])&&a.element.parent().animate({top:parseInt(a.element.parent().css("top"))-250+"px"},500),o.IsMessage&&a.element.css("height","auto")}),0))),$(".ui-widget-overlay").css("top",0),o.OverlayClickEvent&&$(".ui-widget-overlay").click((function(){a.close()}))},offScreen:function(e){var t=e.getBoundingClientRect(),n=!1;return t.top-250>60&&t.height+t.top>$(document).height()&&(n=!0),n},SetZIndex:function(e,t){e=e||$(this.element).parent();if("All"==t)var n=$(".modal.show ,.ui-dialog:visible,.ui-widget-overlay,nb-layout-header").map((function(){var e=+$(this).css("z-index");return isNaN(e)?0:e})).get();else n=$(".modal.show,.ui-widget-overlay,nb-layout-header").map((function(){var e=+$(this).css("z-index");return isNaN(e)?0:e})).get();(n=Math.max.apply(null,n)||1)<0||(n+=1,$(e).css("z-index",n))},close:function(e,t,n){var a=this.options;$(".tooltip","body").remove(),$(this.element).find("iframe").prop("src","../blank.htm").remove(),this._super(),!a.modal||n||this.appendTo&&$(".ui-widget-overlay",this.appendTo).length>0||($("body").removeClass("modal-open"),$(".scrollable-container").removeClass("modal-open"))},destroy:function(e,t){this._super()}}),$.widget("np.npDialog",$.np.npUiDialog,{options:{Class:null,minWidth:null,maxHeight:null,size:null,npDialog:1},_create:function(){this.options.height="auto",this.options.minWidth&&(this.options.width=this.options.minWidth),this._super(),$(this.uiDialog).css("padding","1rem")},show:function(e){e?this.open():this.close()},hide:function(e,t){this.close()},setTit:function(e){this._setOption("title",e)},setWidth:function(e){this._setOption("width",e.toString())},setHeight:function(e){},appendChild:function(e,t){var n=this.element;$(n).append(t.$np("#"+e))},SetButtons:function(e){var t=this,n=(t.options,$(t.element),$("<div style='margin:10px'/>"));$(t.element).append(n),$.each(e,(function(e,t){var a=$("<button class='btn btn-outline-info' style='margin-left:5px;text-align: center;'   >"+t.text+"</button>");a.appendTo(n),a.on("click",t.click)}))}}),$.widget("np.npButton",$.ui.button,{options:{type:"default",marginLeft:"5px",marginRight:"5px"},_create:function(){var e=this.options,t=this.element,n=e.icons?e.icons.secondary||e.icons.primary:null;if(n&&t.is("button")){var a=$('<i style="padding-left:5px;padding-right:5px" ></i>');""==t.text()&&$(t).css("padding","0px 6px"),"<svg"==n.substr(0,4)?(a.html(n),$(t).css("padding","1px")):a.addClass("ui-icon").addClass(n),e.icons.secondary?$(t).prepend($(a)):$(t).append($(a))}switch(t.attr("title",e.tip),t.css({"margin-left":t[0].style.marginLeft?t[0].style.marginLeft:e.marginLeft,"margin-right":t[0].style.marginRight?t[0].style.marginRight:e.marginRight,"margin-bottom":t[0].style.marginBottom?t[0].style.marginBottom:e.marginBottom,"margin-top":t[0].style.marginTop?t[0].style.marginTop:e.marginTop}),t.addClass("btn").attr("type","button"),e.type){case"default":case"info":t.removeClass("btn-info").addClass("btn-outline-info");break;case"success":t.removeClass("btn-success").addClass("btn-outline-success");break;case"warning":t.removeClass("btn-warning").addClass("btn-outline-warning");break;case"danger":t.removeClass("btn-danger").addClass("btn-outline-danger")}},_updateIcon:function(e,t){var n="iconPosition"!==e,a=n?this.options.iconPosition:t;this.icon?n&&this._removeClass(this.icon,null,this.options.icon):(this.icon=$("<i style='padding-left:5px;padding-right:5px'>"),this._addClass(this.icon,"ui-icon")),n&&this._addClass(this.icon,null,t),this._attachIcon(a)},_setOption:function(e,t){if(this._super(e,t),"disabled"===e&&$(this.element).prop("disabled",t),"label"===e&&t&&$(this.element).text(t),"icon"===e&&t&&this._updateIcon("icon",t),"type"===e)switch($(this.element).attr("class",""),t){case"default":case"info":$(this.element).addClass("btn btn-outline-info");break;case"success":$(this.element).addClass("btn btn-outline-success");break;case"warning":$(this.element).addClass("btn btn-outline-warning");break;case"danger":$(this.element).addClass("btn btn-outline-danger")}},_destroy:function(){var e=this;e.options,e.element;e._super()}}),$.widget("np.ContextMenu",{options:{list:[{name:"ایجاد",act:"26",icon:"fa-plus"},{name:"اصلاح",act:"27",icon:"fa-edit"},{name:"حذف",act:"28",icon:"glyphicon-remove"}],grid:!1},_create:function(){var e=this,t=e.options,n=e.element,a=$('<ul class="dropdown-menu pull-right" style="text-align: right;font-size:12px"  ></ul>');$.each(t.list,(function(e,t){a.append('<li><a href="#" act='+t.act+'><i class="fa '+t.icon+'"></i><span style="padding-right:10px">'+t.name+"</span></a></li>")})),t.grid?($(n).addClass("dropdown"),$("div",n).attr("data-toggle","dropdown"),$(n).append(a),e.dropdown=$(n)):(e.dropdown=$(n).wrap('<div class="dropdown" ></div>'),$(n).attr("data-toggle","dropdown").after(a)),e.dropdown.on("show.bs.dropdown",(function(e){})),$("a",a).on("click",(function(e){alert("DoAct:"+$(this).attr("act"))}))}}),ko.bindingHandlers.UniHtml={init:function(e,t,n,a){return{controlsDescendantBindings:!0}},update:function(element,valueAccessor,allBindingsAccessor,viewModel){var value=ko.unwrap(valueAccessor())||"",HasCustomTag=0,patt=new RegExp("<npCustom");patt.test(value)&&(HasCustomTag=!0,value=np.ManageNpCustom(value,viewModel,element));try{value=value&&np.utils.NPChangeNumToUnicode(value)}catch(e){}var id=$(element).attr("orgid"),ShowTag=id&&viewModel._npform&&viewModel._npform.W_.FrmFld[id]&&"1"==viewModel._npform.W_.FrmFld[id].Valid.ShowTag;allBindingsAccessor()&&allBindingsAccessor().ShowTag&&(ShowTag=parseInt(allBindingsAccessor()&&allBindingsAccessor().ShowTag)),ShowTag&&(value=np.utils.escapeXml(value));var NoCheckHtml=id&&viewModel._npform&&viewModel._npform.W_.FrmFld[id]&&"1"==viewModel._npform.W_.FrmFld[id].Valid.NoCheckHtml;if(NoCheckHtml=NoCheckHtml||allBindingsAccessor()&&allBindingsAccessor().NoCheckHtml,NoCheckHtml||ShowTag)ko.utils.setHtml(element,value);else{var Result=np.utils.StandardHtml(value);Result.flag?ko.utils.setHtml(element,value):ko.utils.setHtml(element,Result.Str)}if(HasCustomTag){var clickHandler=function(){var elem=event.currentTarget,self=viewModel._npform;eval($(elem).attr("click"))};ko.utils.registerEventHandler($("a,button",element),"click",clickHandler)}}},ko.bindingHandlers.GridUniHtml={init:function(e,t,n,a){return{controlsDescendantBindings:!0}},update:function(e,t,n,a){var o=ko.unwrap(t())||"";try{o=o&&np.utils.NPChangeNumToUnicode(o)}catch(e){}if("1"==(n().ShowTagGrid||"0")){var i=o.indexOf(np.GrdColCaptionElem2);o=0==o.indexOf(np.GrdColCaptionElem1)&&i>0?o.substr(0,i+np.GrdColCaptionElem2.length-1)+np.utils.escapeXml(o.substr(i+np.GrdColCaptionElem2.length-1)):np.utils.escapeXml(o),ko.utils.setHtml(e,o)}else{var r=np.utils.StandardHtml(o);r.flag?ko.utils.setHtml(e,o):ko.utils.setHtml(e,r.Str)}}},ko.bindingHandlers.UniText={init:function(e,t,n,a){return{controlsDescendantBindings:!0}},update:function(e,t,n,a){var o=ko.unwrap(t())||"";try{o=o&&np.utils.NPChangeNumToUnicode(o)}catch(e){}ko.utils.setTextContent(e,o)}},ko.bindingHandlers.fadeInText={update:function(e,t){$(e).hide(),ko.bindingHandlers.text.update(e,t),$(e).fadeIn("slow")}},ko.virtualElements.allowedBindings.UniText=!0,ko.bindingHandlers.FadeVisible={update:function(e,t,n,a,o){var i=ko.utils.unwrapObservable(t());void 0===i?$(e).hide():i?$(e).show("blind",300,(function(){o.$root._npform.ShapeFrm()})):$(e).hide("blind",300,(function(){o.$root._npform.ShapeFrm()}))}},ko.bindingHandlers.FadeVisibility={update:function(e,t,n,a,o){var i=ko.utils.unwrapObservable(t());console.log(i),void 0===i?$(e).css("visibility","hidden"):i?$(e).animate({opacity:100},300,(function(){o.$root._npform.ShapeFrm()})):$(e).animate({opacity:0},300,(function(){o.$root._npform.ShapeFrm()}))}},ko.bindingHandlers.BindingCmp={init:function(e,t,n,a){var o=n.get("Desc"),i=n.get("Tip"),r=n.get("CmpId"),l=a._npform.W_.FrmFld[r].WidgetSelf;return l.options.SelValChanged=function(e,n){var o=l.GetValOfCmp();t()()!=o&&a._npform.Val(r,o)},l.options.TxtValChanged=function(e,t){var n=l.GetTxtOfCmp();o()!=n&&a._npform.Val(r+np.ACDesc,n)},l.options.TipValChanged=function(e,t){var n=l.GetTipOfCmp();i()!=n&&a._npform.Val(r+np.ACTip,n)},$(e).focus((function(){$("input:first",e).focus()})),{controlsDescendantBindings:!0}},update:function(e,t,n,a){var o=ko.utils.unwrapObservable(t()),i=ko.utils.unwrapObservable(n.get("Desc")),r=ko.utils.unwrapObservable(n.get("Tip")),l=n.get("CmpId"),s=a._npform.W_.FrmFld[l],d=s.WidgetSelf;"MS"!=s.Type2&&(d.SetTxtOfCmp(i),d.SetTipOfCmp(r),d.SetValOfCmp(o))}},ko.bindingHandlers.StopBindings={init:function(){return{controlsDescendantBindings:!0}}},ko.bindingHandlers.bdoValue={init:function(e,t,n){var a=function(){t()(e.innerHTML)};ko.utils.registerEventHandler(e,"keyup",a),ko.utils.registerEventHandler(e,"input",a)},update:function(e,t){var n=ko.utils.unwrapObservable(t())||"";n!==e.innerHTML&&(e.innerHTML=n)}},ko.bindingHandlers.npEditorValue={after:["options","foreach"],init:function(e,t,n,a){var o=$(e),i=o.attr("minimize")?o.attr("minimize"):"0",r=!(!o.attr("HideIcon")||"true"!=o.attr("HideIcon")),l=o.attr("title");o.npeditor({npform:a._npform,Minimize:i,HideIcon:r,title:l,change:function(e,n){var a=t(),o=""==np.stripHtmlTags(n.Val)?"":n.Val;a.peek()!==o&&a(o)}}),ko.utils.domNodeDisposal.addDisposeCallback(e,(function(){o.npeditor("destroy")}))},update:function(e,t){var n=$(e),a=ko.utils.unwrapObservable(t()),o=n.npeditor("Val");if(a!==o){n.npeditor("Val",a)}}},ko.bindingHandlers.HtmValue={after:["options","foreach"],init:function(e,t,n){var a=$(e);a.cleditor({width:$(e).width(),height:$(e).height()}).change((function(){var n=t(),a=ko.selectExtensions.readValue(e);n.peek()!==a&&n(a)})),ko.utils.domNodeDisposal.addDisposeCallback(e,(function(){$.data(a[0],"cleditor").destroy()}))},update:function(e,t){var n=ko.utils.unwrapObservable(t()),a=ko.selectExtensions.readValue(e);if(n!==a){ko.selectExtensions.writeValue(e,n),$.data(e,"cleditor").updateFrame($.data(e,"cleditor"))}}},ko.bindingHandlers.npcb={after:["value","attr"],init:function(e,t,n){"checkbox"==e.type&&ko.utils.registerEventHandler(e,"change",(function(){var a=e.checked,o=1==(n.has("noy")?ko.utils.unwrapObservable(n.get("noy")):0)?a?"2":"1":a?"1":"0";t()(o)}))},update:function(e,t,n){var a=ko.utils.unwrapObservable(t()),o=1==(n.has("noy")?ko.utils.unwrapObservable(n.get("noy")):0)?"2"==a:"1"==a;e.checked=o}},ko.bindingHandlers.enterkey={init:function(e,t,n,a){$(e).keypress((function(n){return 13!==(n.which?n.which:n.keyCode)||(t().call(a,null,e),!1)}))}},ko.bindingHandlers.visibility=function(){function e(e,t){var n=ko.unwrap(t());$(e).css("visibility",n?"visible":"hidden")}return{init:e,update:e}}()}(jQuery,NowPardaz),function(e,t){npImages=[];for(var n=["/img/waiting1.gif"],a=0;a<1;a++){var o=new Image;o.src=n[a],npImages.push(o)}e.NPCreateWidget=function(n,a,o){n.data("NPWidget",a),n[a](o);var i=n[a]("instance"),r=i.options,l=i.element,s=r.CmpId;if(t.faciNote&&i.$ValidXml.r.hasnote){var d=!1;function p(){d=!d,e("[np-frmnote]",l).each(((t,n)=>{e(n).toggleClass("np-notes-readytoselect").removeClass("np-notes-hide")})),d&&introJs().setOption("nextLabel"," بعدی ").setOption("prevLabel"," قبلی ").setOption("doneLabel"," تمام ").onbeforeexit((function(){return p(),!0})).start()}n.css("position","relative"),e('<div class="row"><div class="col-12 d-flex justify-content-end"><button editnote class="">ویرایش شرح ها</button></div></div>').appendTo(i.$np("#dvfrmCenter")).find("button").click((()=>{p()})),n.on("click",".np-notes-readytoselect",((t,n)=>{introJs().exit();var a=e(t.currentTarget);console.log(a);const o=a.attr("np-frmnote");if(o){const e=o.substr(7);var r={OpenInDialog:!1,OpenInDialog_ShowModal:!1,HideOpener:!0,CloseOpener:!1,DisableOpener:!1,AfterClose:(e,t)=>{p();var n=t?.confirm;if(n){var o=t?.note||"";"1"==a.attr("np-frmnote-modal")?a.attr("title",o):a.html(o)}},AfterOpen:null,ReturnParam:{},After:!0,Width:"auto",Height:"auto",inxml:{outpar:{BEYF:"4",BEZo:1,BEYO:e,BEYL:e,BEYR:s,BEYI:s},doact:{}}};r.inxml.doact.act="08",i.OpenNewForm("0",22180,0,r)}}))}n.on("mouseenter mouseleave mousedown mouseup focus blur","a.np-icon-only,a.np-a-help,input.ui-autocomplete-input,div[np-act],img.Comm,button[np-act],button.Comm",(function(t,n){var a,o=e(this);if(!o.hasClass("ui-button-disabled")&&!o.hasClass("ui-state-disabled"))switch(t.type){case"mouseenter":var r=o.prop("src");o.hasClass("Comm")&&r&&-1==r.indexOf("_Focus")&&o.prop("src",r.replace(".gif","_Focus.gif")),o.is(":button")&&o.addClass("ui-state-hover");var l=o.attr("np-act");i.Acts["act"+l]&&(a=i.Acts["act"+l].HlpArrElem)&&"_ShowError"!=n&&(e.each(a,(function(e,n){var a=n.Elem,o=a.prop("tagName");if(t.target!=document.activeElement)if(o&&"DIV"==o.toUpperCase()){var i=a.css("borderTopWidth"),r=a.css("borderBottomWidth"),l=a.css("borderLeftWidth"),s=a.css("borderRightWidth");a.addClass("ui-state-highlight"),i!==a.css("borderTopWidth")&&a.css("borderTopWidth",i),r!==a.css("borderBottomWidth")&&a.css("borderBottomWidth",r),l!==a.css("borderLeftWidth")&&a.css("borderLeftWidth",l),s!==a.css("borderRightWidth")&&a.css("borderRightWidth",s)}else a.addClass("ui-state-highlight")})),t.stopPropagation());break;case"mouseleave":r=o.prop("src");o.hasClass("Comm")&&r&&o.prop("src",r.replace("_Focus.gif",".gif").replace("_Clicked.gif",".gif")),o.removeClass("ui-state-hover"),o.removeClass("ui-state-active");l=o.attr("np-act");i.Acts["act"+l]&&(a=i.Acts["act"+l].HlpArrElem)&&(e.each(a,(function(e,t){t.Elem.removeClass("ui-state-highlight")})),t.stopPropagation());break;case"mousedown":r=o.prop("src");o.hasClass("Comm")&&r&&o.prop("src",r.replace("_Focus.gif",".gif").replace("_Clicked.gif",".gif").replace(".gif","_Clicked.gif")),o.is(":button")&&o.addClass("ui-state-active");break;case"mouseup":r=o.prop("src");o.hasClass("Comm")&&r&&o.prop("src",r.replace("_Focus.gif",".gif").replace("_Clicked.gif",".gif").replace(".gif","_Focus.gif")),o.removeClass("ui-state-active");break;case"focus":o.is(":button")&&o.addClass("ui-state-active");break;case"blur":o.removeClass("ui-state-active")}})),i.NPGen=i.$ValidXml.r.NPGen,(i.NPGen?i.NPGen.ver:0)<300&&n.find("fieldset").removeClass("ui-widget-content").end().find(':input[type="text"]').addClass("form-control").end().find("select").addClass("form-control").end().find("button.np-icon-only").each((function(t,n){var a=e(n).attr("style")?e(n).attr("style"):"";e(n).after("<a id="+e(n).attr("id")+' style="cursor:pointer;padding-right:5px;'+a+'"  orgid='+e(n).attr("orgid")+" np-act="+e(n).attr("np-act")+' class="np-icon-only"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" class="svg-info" style="vertical-align: middle;" height="20" viewBox="0 0 32 32"><path d="M11.772 20.164v2.871q0 0.251 0.162 0.413t0.413 0.162h2.871q0.251 0 0.413-0.162t0.162-0.413v-2.871q0-0.251-0.162-0.413t-0.413-0.162h-2.871q-0.251 0-0.413 0.162t-0.162 0.413zM7.178 11.264q0 0.897 0.269 1.615t0.816 1.238 0.933 0.79 1.068 0.646q0.574 0.323 0.834 0.502t0.467 0.431 0.206 0.52v0.574q0 0.251 0.162 0.413t0.413 0.162h2.871q0.251 0 0.413-0.162t0.162-0.413v-1.22q0-0.628-0.188-1.157t-0.431-0.852-0.7-0.637-0.736-0.458-0.799-0.377q-0.951-0.449-1.346-0.772t-0.395-0.879q0-0.754 0.781-1.283t1.714-0.529q1.005 0 1.705 0.485 0.52 0.359 1.436 1.489 0.162 0.215 0.449 0.215 0.197 0 0.341-0.108l1.938-1.471q0.18-0.126 0.215-0.359t-0.090-0.413q-2.189-3.445-6.263-3.445-2.315 0-4.28 1.606t-1.965 3.849zM13.781 3.225q2.333 0 4.459 0.915t3.661 2.449 2.449 3.661 0.915 4.459-0.915 4.459-2.449 3.661-3.661 2.449-4.459 0.915-4.459-0.915-3.661-2.449-2.449-3.661-0.915-4.459 0.915-4.459 2.449-3.661 3.661-2.449 4.459-0.915zM0 14.709q0 3.75 1.848 6.918t5.016 5.015 6.918 1.848 6.918-1.848 5.015-5.015 1.848-6.918-1.848-6.918-5.015-5.016-6.918-1.848-6.918 1.848-5.016 5.016-1.848 6.918z"></path></svg></a>'),e(n).remove()})).end().find("textarea").addClass("form-control").css("white-space","pre-wrap").end()},e.fn.NPFocus=function(){this.focus().select()},e.fn.OuterHTML=function(){return e("<div></div>").append(this.clone()).html()},e((function(){var n;e(window.document).on("keyup",(function(n){if("keyup"===n.type){var a,o;e.ui.keyCode;a=n.keyCode?n.keyCode:n.which,n.which,o=n.shiftKey,n.altKey&&o&&67==a&&confirm("آیا مطمئن هستید می خواهید حافظه های موقت پاک شود؟")&&t.utils.NPClearLocalStorage()}})),e.fn.size=function(){return this.length},e.fn.scrollIntoView||t.noNg((()=>e.ajax({url:t.JSFolder+"jq_scrollintoview.js",cache:!0,dataType:"script"}))),n="<script type='text/html' id='ColgroupNPGrid'><col data-bind=\"attr:{width:Width()+'px'}\" ></col><\/script>",e("body").append(e(n)),n="<script type='text/html' id='HeaderTrNPGrid'><tr data-bind=\"template:{name:'ThNPGrid', foreach:$parent.ThTdNoHide($data,'Th',$context)}, npresizable: { animate: true  },npdraggable: { cursor: 'crosshair' }\" ></tr><\/script>",e("body").append(e(n)),n="<script type='text/html' id='ThNPGrid'>\x3c!-- ko if:(typeof(CheckBox)!='undefined') --\x3e"+String.fromCharCode(10)+'<th class=\'npgrid-header\' > <input type="checkbox" data-bind="click:function($data,ev){return $root.NpAllCheckedClick(ev,$data)}, checked:$root.IsNpAllChecked($context) " /></th>\x3c!-- /ko --\x3e'+String.fromCharCode(10)+"\x3c!-- ko if:(typeof(CheckBox)=='undefined') --\x3e"+String.fromCharCode(10)+"<th class='npgrid-header' data-bind=\"    attr:{rowspan:RowSpan,colspan:ColSpanTemp(),       dir:typeof(HDir) !== 'undefined' ? HDir : null,        align:typeof(HAlign) !== 'undefined' ? HAlign : null},    click:function($data,ev){return $root.HeaderRowClick(ev,$data)}\" >    <span data-bind=\"UniHtml:Html() \"  ></span>    <span class='npgrid-sort'>       <nobr>          <span data-bind=\"css:$root.ClassName($data) \" ></span>       </nobr>    </span></th>\x3c!-- /ko --\x3e"+String.fromCharCode(10)+"<\/script>",e("body").append(e(n)),n="<script type='text/html' id='TBodyNPGrid'><tr class='TR-NPGrid' style='border: currentColor; font-weight: normal;cursor: pointer;'    data-bind=\"template:{name:'TdNPGrid', foreach:$parent.ThTdNoHide($data,'Td',$context)}      ,css: $root.RowClassName($data,$context)      ,click:function($data,ev){return $parent.RowClick(ev,$data)}       ,event: { mouseover: $parent.mov, mouseout: $parent.mou }      ,attr:{RadifIndex:$index}\" ></tr><\/script>",e("body").append(e(n)),n="<script type='text/html' id='TdNPGrid'>"+String.fromCharCode(10)+" <td class='npgrid-body-cell np-border-left-right'    data-bind=\"css:{'npgrid-header ui-state-default':id=='R'}     ,attr:{rowspan:RowSpan,colspan:ColSpanTemp(),        dir:typeof(Dir) !== 'undefined' ? Dir : null,         align:typeof(Align) !== 'undefined' ? Align : null }      ,NpMultiLine:((typeof(MultiLine) !== 'undefined')&&(MultiLine=='1'))?'1':'0'      ,template:{name:$data.TempName}   \"  ></td>"+String.fromCharCode(10)+"<\/script>",e("body").append(e(n)),n="<script type='text/html' id='TdNPGrid_Check'>"+String.fromCharCode(10)+" <input type=\"checkbox\" data-bind=\" checked:$root.IsNpCheck($data,$context) \" /><\/script><script type='text/html' id='TdNPGrid_Html'>"+String.fromCharCode(10)+' <span   data-bind="UniHtml:Html()   "  ></span>'+String.fromCharCode(10)+"<\/script><script type='text/html' id='TdNPGrid_Text'>"+String.fromCharCode(10)+' <span   data-bind="UniText:Html()   "  ></span>'+String.fromCharCode(10)+"<\/script>",e("body").append(e(n))}))}(jQuery,NowPardaz),function(e,t){var a="NPCommanderButtons";e.fn.zIndex=function(t){try{if(t)return e(this[0]).css("z-index",t),t;var n=e(this[0]).css("z-index");return"auto"==n?1:n}catch(e){}},e.fn.SetZIndex=function(){var t=this[0],n=e(".modal.show,.ui-dialog:visible").map((function(){var t=+e(this).css("z-index");return isNaN(t)?0:t})).get();n=Math.max.apply(null,n)||1,n+=1,t&&e(t).css("z-index",n)},e.fn.xml2=function(t){var n="";for(this.length&&(void 0!==t&&t?this:e(this[0]).contents()).each((function(){try{n+=(new XMLSerializer).serializeToString(this)}catch(e){n+=this.xml}}));n.indexOf(String.fromCharCode(10))>-1;)n=n.replace(String.fromCharCode(10),"&#10;");return n},Array.max=function(e){return Math.max.apply(Math,e)},Array.min=function(e){return Math.min.apply(Math,e)},e.fn.npicon=function(e,t,n){n||(n="ui-state-default");var a=("np"==e.substr(0,2)?"np":"ui")+"-icon";return this.addClass("np-icon-only ui-corner-all "+n).attr("role","button").attr("href","#").children("div").addClass("size"+t+" "+e+" "+a),this},e.widget("np.npform",{options:{fname:"",inxml:null,AfterClose:null,AfterOpen:null,ReturnParam:null,AfterAct:null},_create:function(){var n=this,a=n.options,o=n.element,i=o;n.WebBusy=!1,n.ExitFromSystem=!1,n.BackSpaceFocus=!0,n.EmptyMessage={msg:{errors:[],war:[],suc:[]}},n.ContId=o.uniqueId().attr("id"),n.$ValidXml={r:{n:{},acts:{},iacts:{}}},n.Acts=n.$ValidXml.r.acts,n.iacts=n.$ValidXml.r.iacts,n.V_={},n.W_={RunDoActInQueue:0,OpenedDialogs:{},StayedForm:{},FrmFld:{},FrmFld_Grd:{},FrmFld_StateNo:{},FrmFld_Htm:{},FrmFld_PDat:{},FrmFld_GDat:{},HelpDialogs:{},HelpGrids:{},Alias2Id:{}};var r=e(window),l=r.width(),s=r.height();(l<=768||l<=900&&s<=400)&&(n.W_.IsInMobile=!0);n.Valid_={IsChangeInProgress:!1,CurLang:null,ML:[[31,31,31,31,31,31,31,30,30,30,30,30,30],[31,31,29,31,30,31,30,31,31,30,31,30,31]],ControlKeys:[18,e.ui.keyCode.BACKSPACE,1,17,e.ui.keyCode.DELETE,e.ui.keyCode.DOWN,e.ui.keyCode.END,e.ui.keyCode.HOME,e.ui.keyCode.INSERT,e.ui.keyCode.LEFT,e.ui.keyCode.RIGHT,16,e.ui.keyCode.UP,e.ui.keyCode.TAB]};n.Resp=null,n.UserLvl=0,n._SndXML=null,n.ActNo="",n.FMod="",n.ModeCode="",n.NextAct="",n._Grd=[],n.IsBindingInProgress=!1,a.IsMakedFullId||(e("[id]",i).each((function(t,a){var o,i=e(a);o=i.prop("id"),i.attr("orgid",o),i.prop("id",n.MakeFullId(o))})),e("label[for]",o).each((function(t,a){var o=e(a),i=n.MakeFullId(o.attr("for"));o.prop("for",i)}))),n.W_.$dvfrmHeader=e("#"+n.MakeFullId("dvfrmHeader"),i),n.W_.$dvfrmCenter=e("#"+n.MakeFullId("dvfrmCenter"),i),n.W_.$dvfrmCenter.on("scroll",(function(){GlobViewModel.LangShow.hide(),e(".ui-autocomplete",i).hide()})),a.IsCmp||n.W_.$dvfrmCenter.addClass("panel-body m-md-2 p-md-2 pr-md-2 m-0 p-0 pr-1 np-overflow-x-auto"),a.OpenInline&&a.OpenerSelf.W_.$dvfrmCenter.removeClass("np-overflow-x-auto"),n.W_.$dvfrmFooter=e("#"+n.MakeFullId("dvfrmFooter"),i),n.W_.$bod=e("#"+n.MakeFullId("bod"),i).addClass("panel-default").removeClass("ui-widget").removeClass("ui-widget-content"),n.W_.$dvfrmHeader.length&&!a.IsCmp&&n.W_.$dvfrmHeader.height()>0&&n.W_.$dvfrmHeader.addClass("panel-heading"),(a.ShowFooter||void 0===a.HideFooter)&&(a.HideFooter=!1),a.OpenInline&&a.HideFooter||(n.W_.$dvfrmFooter.addClass("panel-footer nobr").removeClass("ui-widget-header"),e(n.W_.$bod).css("overflow",""),a.OpenInDialog||a.OpenedByDashboard&&a.OpenerSelf&&a.OpenerSelf.options.OpenInDialog?n.W_.$dvfrmFooter.css({position:"sticky",bottom:a.NavStepSelf?"":"0px",width:"100%",left:"0px"}):n.W_.$dvfrmFooter.css({position:"sticky",bottom:"0px"}).css({width:"100%",right:"0px"})),e("hr",n.W_.$dvfrmHeader).remove(),n.ViewModel={ContId:n.ContId,_npform:n,WebBusy:ko.observable(!1),OpenWaiting:ko.observable(0),OpenLoading:ko.observable(0),vm_FullId:function(e){return n.MakeFullId(e)},vm_ResetClicked:function(){n.ResetClick()},vm_FaciHelp:function(){try{n.parsedHelpJson&&"undefined"!=typeof introJs?n.IntroHelp(0):n.FaciHelp()}catch(e){n.FaciHelp()}},vm_Trigger:function(e){n._trigger(e)},vm_ValText:function(e,n,a){return function(e,n,a){for(var o=n[a+t.OPTOPT](),i=n[a](),r=0;r<o.length;r+=1){var l=o[r];if(l.val===i)return l.val+") "+l.dsc}}(0,n.$root,a)},vm_DoAct:function(e,t){n.ErLen=0,n.WarLen=0,n.W_.IMs[t]&&(e=n.W_.IMs[t].actno||e),n.DoAct(e)},vm_DisableCommanderButtons:ko.observableArray([]),vm_CommanderButtonDisable:function(e){return n.ViewModel.WebBusy()||n.ViewModel.vm_DisableCommanderButtons.indexOf(e)>-1},vm_ReturnBack:function(){n.ReturnButtonClick()}},a.ParentCmp||(n.ViewModel.vm_Respmsg=ko.observable({c:ko.observableArray([])}),n.ViewModel.vm_ShowRespmsg=ko.observable(!1)),n.ViewModel.WebBusy.subscribe((function(e){n.GetngData()?.AngularTab?.openWaiting&&n.GetngData()?.AngularTab?.openWaiting(!!e)})),n.ViewModel.OpenLoading.subscribe((function(e){n.GetngData()?.AngularTab?.openWaiting&&n.GetngData()?.AngularTab?.openWaiting(!!e,!0)})),a.ParentCmp?(a.HideFooter=!0,n.EnableAllField=!1,n.ReadyCallBack_cnt=0):(n._CreateCommanderButtons(),e("td span.ui-icon-help",n.W_.$dvfrmHeader).remove()),a.NewFormAutJSON&&a.NewFormAutJSON.tit&&(a.ftitle=a.NewFormAutJSON.tit),a.IsCmp||a.UseOpenerAut||(n.Aut={rp:a.rp}),a.CmpId&&n.GetXmlValidation()},clearDashDoAct:function(){var e=this.options;this.element;e.inxml?.doact?.act&&e.inxml?.outpar?.F77771&&delete e.inxml.doact.act},gettinybutton:function(t,n){var a="edit"==t?"اصلاح":"delete"==t?"حذف":"view"==t?"نمايش":"help"==t?"راهنما":"send"==t?"ارسال":"confirm"==t?"تاييد":"detail"==t?"جزييات":"viewflow"==t?"مشاهده گردش کار":"viewflowA"==t?"مشاهده گردش کار اتوماسيون":"-";n=n||{};var o="";return e.each(n,(function(e,t){o=e+'="'+t+'" '})),'<button title="'+a+'" np-icon="'+t+'" class="np-tinyicon np-tinyicon-'+t+'" '+o+">&nbsp;</button>"},SetHyper:function(t,n){var a=(t=t||{}).tagName||"span",o=t.name&&' name="'+t.name+'"'||"",i=t.attr||{},r=t.style&&' style="'+t.style+'"'||"",l=" ",s="np-hypertext",d=t.title&&' title="'+t.title+'"'||"";return t.class&&(s=s+" "+t.class),e.each(i,(function(e,t){l+=e+'="'+t+'" '})),"<"+a+d+r+o+l+" class='"+s+"'>"+n+"</"+a+">"},GetGlyphIcon:function(t){t=t||{};this.options,this.element;var n=t.tagName||"span",a=t.name||"",o=t.attr||{},i=t.style||"",r=" ",l=t.type||"",s="",d=' title="'+t.title+'"'||"";switch(e.each(o,(function(e,t){r+=e+'="'+t+'" '})),a.toLowerCase()){case"key":s="glyphicon npglyph-key-stroke";break;case"write":case"nextstep":s="glyphicon npglyphicon-esc";break;case"download":s="glyphicon glyphicon-download";break;case"confirm":s="glyphicon glyphicon-check";break;case"delete":s="glyphicon glyphicon-close2-solid";break;case"edit":s="glyphicon npglyphicon-pen";break;case"rep1":s="glyphicon glyphicon-paper";break;case"rep2":s="glyphicon glyphicon-paper-stack";break;case"rep3":s="glyphicon glyphicon-file";break;case"send":s="glyphicon npglyphicon-send";break;case"view":s="glyphicon glyphicon-search";break;case"viewflow":s="glyphicon npglyphicon-map";break;case"confsend":s="glyphicon npglyphicon-confsend";break;case"sendcomm":s="glyphicon glyphicon-comment";break;case"comm":s="glyphicon npglyphicon-COMM";break;case"nconfsend":s="glyphicon npglyphicon-nconfsend";break;case"faci1":case"faci4":case"faci7":s="glyphicon glyphicon-book";break;case"faci2":case"faci5":case"faci8":s="glyphicon glyphicon-folder-close";break;case"faci3":case"faci6":case"faci9":s="glyphicon npglyphicon-clipboard";break;case"makecmp":s="glyphicon glyphicon-cog";break;case"paramsandfields":s="glyphicon glyphicon-layout";break;case"columns":s="glyphicon glyphicon-fire";break;case"grid2":s="glyphicon npglyphicon-grid2";break;case"server":s="glyphicon npglyphicon-server";break;case"help":s="glyphicon glyphicon-question-sign";break;case"info":s="glyphicon glyphicon-info-solid";break;case"validation":s="glyphicon glyphicon-ok-circle";break;case"hlp":s="glyphicon npglyphicon-Hlp";break;case"arrow-up":s="glyphicon npglyphicon-arrow-up-outline";break;case"arrow-down":s="glyphicon npglyphicon-arrow-down-outline";break;case"cancel":s="glyphicon npglyphicon-cancel"}if(t.class&&(s=s+" "+t.class),"svg"==l){var p='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32">',c="";if("download"===a.toLowerCase())c='<path d="M26.202 9.455l1.881 1.881-12.035 12.035-9.34-9.34v6.143h-2.695v-10.719h10.719v2.695h-6.143l7.459 7.459z"></path>';return e(p).append(c),e(p)}return"<"+n+d+r+" class='"+s+"' name='"+a+"' style='"+i+"'></"+n+">"},_UpdateCommanderButtons:function(){var t=this,n=(t.options,t.element,e(".table>div:eq(1)",t.W_.$tbFooterAlignment));e("button",n).each((function(n,a){t.W_.IMs[e(a).attr("orgid")]&&t.W_.IMs[e(a).attr("orgid")].Icon&&e(a).npButton("option","icon",t.W_.IMs[e(a).attr("orgid")].Icon)}))},_CreateCommanderButtons:function(){var t=this,n=t.options,o=(t.element,t.W_.$dvfrmFooter.children());t.W_.$tbFooterAlignment=e('<div id="'+t.MakeFullId("tbFooterAlignment")+'" style="dis_play:table;width:100%"><div style="display:flex;flex-wrap: nowrap;align-items:center" class="table"><div data-bind="click:function(){$root.vm_ShowRespmsg(!$root.vm_ShowRespmsg())}, style: { transform: $root.vm_ShowRespmsg()?\'rotate(-180deg)\': \'rotate(0deg)\' }" style=" position: absolute;top: 0px;right:4px; transform: rotate(0deg);display:inline-block;cursor:pointer;-webkit-transition-duration: 0.4s;-moz-transition-duration: 0.4s;-o-transition-duration: 0.4s;transition-duration: 0.4s;-webkit-transition-property: -webkit-transform;-moz-transition-property: -moz-transform;transition-property: transform;"><div style="display:none" data-bind="visible:($root.vm_Respmsg().c().length > 0)">   <svg class="svg-info" viewBox="0 0 20 20" style="max-height:28px" height="17" width="17">      <path d="M0 10c0-5.523 4.477-10 10-10s10 4.477 10 10v0c0 5.523-4.477 10-10 10s-10-4.477-10-10v0zM10 18c4.418 0 8-3.582 8-8s-3.582-8-8-8v0c-4.418 0-8 3.582-8 8s3.582 8 8 8v0zM10.7 7.46l3.55 3.54-1.41 1.41-2.84-2.81-2.83 2.8-1.41-1.4 4.24-4.24 0.7 0.7z"></path>   </svg></div></div><div class="flex-grow-1" style="overflow-x: auto;"><div style="white-space: nowrap;wid_th: calc(100% - 100px);" id="'+t.MakeFullId("tbFooterAlignmentRight")+'"></div></div><div style="dis_play:table-cell;direction:ltr;text-align: left;wid_th:100px"></div></div></div>').appendTo(t.W_.$dvfrmFooter);var i=e(".table>div:eq(1)",t.W_.$tbFooterAlignment);if(o.appendTo(i),t.W_.$dvfrmFooter.prepend(e("<div data-bind=\"template:{name:'_ErrorTmpl',data:vm_Respmsg }\"></div>")),t.W_.IMs={},e("button",i).each((function(n,o){var i,r=t.MakeOrgId(o.id);switch(t.W_.IMs[r]={LastShow:!1,LastEnable:!0,LasText:null,LastIcon:null},r){case"IM01":i="np-icon-check";break;case"IM02":i="ui-icon-submit";break;case"IM03":i="ui-icon-close";break;case"IM04":case"IM09":i="np-icon-submit";break;case"IM08":i="np-icon-search";break;case"IM99":i=""}e(o).addClass(a).npButton({icons:{secondary:i},type:"default"})})),e("button.NPCommanderButtons",t.W_.$dvfrmFooter).hide(),!n.ParentCmp){var r=e(".table>div:eq(2)",t.W_.$tbFooterAlignment);void 0!==n.ReturnCaption||n.OpenerSelf&&n.OpenerSelf.options.NoReturn||(n.ReturnCaption="بازگشت"),n.NoReturn=!n.ReturnCaption,n.ReturnCaption||(n.ReturnCaption="بازگشت"),t.W_.$ReturnButton=e('<button id="'+t.MakeFullId("ReturnButton")+'" class="np-d-none" style="display:none" title="بازگشت به منوی اصلی"></button>').attr("title",n.ReturnCaption||"بازگشت به منوی اصلی").appendTo(r).npButton({icons:{secondary:"np-icon-return"},type:"default"}),t.W_.$ScrollToTop=e('<span class="np-d-none"><svg  version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  class="svg-secondary" style="padding-top:5px;opacity:0.9" height="32" width="32" viewBox="0 0 32 32"><path d="M5.081 15.95c0-1.078 0.419-2.090 1.181-2.852l9.569-9.569 9.569 9.57c1.522 1.522 1.522 4.179 0 5.702-0.761 0.761-1.774 1.18-2.85 1.18s-2.090-0.419-2.852-1.181l-3.867-3.867-3.869 3.867c-0.761 0.762-1.774 1.181-2.85 1.181s-2.090-0.419-2.852-1.181c-0.761-0.761-1.18-1.772-1.18-2.85zM15.832 7.33l-7.669 7.67c-0.508 0.508-0.507 1.393 0 1.9 0.254 0.254 0.59 0.394 0.95 0.394s0.696-0.14 0.95-0.394l5.769-5.768 5.769 5.768c0.254 0.254 0.591 0.394 0.95 0.394s0.696-0.14 0.95-0.394c0.509-0.508 0.508-1.393 0.001-1.9l-7.67-7.67z"></path> </svg></span>').appendTo(r),t.W_.$ScrollToBot=e('<span><svg  version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  class="np-d-none svg-secondary" style="padding-top:5px;opacity:0.9" height="32" width="32" viewBox="0 0 32 32"><path d="M5.081 11.919c0-1.078 0.419-2.090 1.181-2.852 0.761-0.761 1.774-1.18 2.85-1.18s2.090 0.419 2.852 1.181l3.867 3.867 3.869-3.867c0.761-0.762 1.774-1.181 2.85-1.181s2.090 0.419 2.852 1.181c1.521 1.522 1.522 4.178-0.001 5.702l-9.569 9.569-9.569-9.57c-0.762-0.761-1.181-1.772-1.181-2.85zM23.894 11.919c0-0.36-0.14-0.696-0.392-0.95-0.255-0.254-0.593-0.394-0.951-0.394s-0.696 0.14-0.95 0.394l-5.769 5.768-5.769-5.768c-0.254-0.254-0.59-0.394-0.95-0.394s-0.696 0.14-0.95 0.394c-0.509 0.508-0.508 1.393-0.001 1.9l7.67 7.67 7.669-7.67c0.254-0.254 0.394-0.59 0.394-0.95z"></path></svg></span>').appendTo(r),e("html,body").scroll((function(){t.W_&&(t.W_.$ScrollToTop.addClass("np-d-none"),e(document).height()>e(window).height()&&e(this).scrollTop()>5&&t.W_.$ScrollToTop.removeClass("np-d-none"))})),t._on(t.W_.$ScrollToTop,{click:function(){e("html,body").animate({scrollTop:0},"fast")}}),t._on(t.W_.$ScrollToBot,{click:function(){e("html,body").animate({scrollTop:document.body.scrollHeight},"fast")}}),t._on(t.W_.$ReturnButton,{click:function(){t.ReturnButtonClick()}})}},ReturnButtonClick:function(){var e=this,t=e.options;t.NavStepSelf&&t.NavStepSelf.GetParentCmp()&&t.NavStepSelf.GetParentCmp().options.NavStepSelf&&!t.OpenInDialog&&t.NavStepSelf.GetParentCmp().options.NavStepSelf.Close(),t.NavStepSelf&&!t.OpenInDialog?t.NavStepSelf.Close():t.$FaciDialogDiv?e.CloseDialog():e.Close()},SetReturnCaption:function(e){this.W_.$ReturnButton.attr("title",e)},HideReturnButton:function(e){e?this.W_.$ReturnButton.hide():this.W_.$ReturnButton.show()},GetCover:function(e){var t=this;if(!e)return null;for(;e.parent();){if(e.parent()[0].id==t.MakeFullId("dvfrmFooter")||e.parent()[0].id==t.MakeFullId("dvfrmCenter")||e.parent()[0].id==t.MakeFullId("bod")||e.parent()[0].id==t.MakeFullId("dvfrmCenter"))return e.parent();e=e.parent()}return null},ShapeFrm:function(){var e=this,t=e.options;e.W_&&t.OpenInDialog&&e.dvfrmCenterHeight()},_init:function(){var e=this;e.options.HideFooter&&e.W_.$dvfrmFooter.hide(),e.ShapeFrm()},ReplaceParameter:function(n,a,o){this.options,this.element;var i=o.EscapeXml,r=o.EscapeJSON;return n&&e.each(n,(function(e,n){var o;r&&(o=n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')),i&&(o=t.utils.escapeXml(n)),a=e==t.P_IDIDID?a.replace(new RegExp("#"+t.P_IDIDID+"#*","g"),o):a.replace(new RegExp("#"+e+"#[^;\"']*","g"),o)})),a=a.replace(t.utils.SetDefaultExpr,"")},SetDefToChild:function(t,n){var a=this,o=a.W_.FrmFld[t].md;o&&e.each(o,(function(e,o){var i=a.W_.FrmFld[o.P].WidgetSelf.W_.FrmFld[o.C].Valid.Def;n!=i&&("$"==n&&a.W_.FrmFld[o.P].WidgetSelf.ViewModel[o.C](a.ViewModel[t]()),a.W_.FrmFld[o.P].WidgetSelf.W_.FrmFld[o.C].Valid.Def=n,a.W_.FrmFld[o.P].WidgetSelf.SetDefToChild(o.C,n))}))},CreateFrmFlds:function(){var n=this,a=(n.options,n.element);e.each(n.W_.FrmFld,(function(a,o){if(o.Help&&n.W_.FrmFld[a+"_Div"]){var i=n.$np("#"+o.Help);n.$np("#"+a+"_Div").append(i)}if(o.md&&e.each(o.md,(function(e,a){var o=/#(\w*)#(\w*)/.exec(a.C);if(o){var i=n.W_.FrmFld[a.P];i.WidgetSelf=i.WidgetSelf||t.utils.GetWidgetSelf(i.Elem,i.WidgetName);var r=i.WidgetSelf.W_.Alias2Id[o[1]];a.C=r||a.C.replace("#"+o[1]+"#","")}})),o.mdChild&&e.each(o.mdChild,(function(e,n){var a=/#(\w*)#(\w*)/.exec(n.ChId);if(a){o.WidgetSelf=t.utils.GetWidgetSelf(o.Elem,o.WidgetName);var i=o.WidgetSelf.W_.Alias2Id[a[1]];n.ChId=i||n.ChId.replace("#"+a[1]+"#","")}})),"Cmp"==o.Valid.Typ){o.WidgetSelf=t.utils.GetWidgetSelf(o.Elem,o.WidgetName);var r=o.WidgetSelf.$ValidXml.r.KeyObjId;if(110025==o.WidgetSelf.options.CmpId){var l,s=n.W_.Alias2Id.MULTIVAL,d=n.W_.Alias2Id.SINGLVAL,p=o.WidgetSelf.W_.Alias2Id.MULTIVAL,c=o.WidgetSelf.W_.Alias2Id.SINGLVAL;s&&p&&(l=n.W_.FrmFld[s])&&(l.md=l.md||[],l.md.push({P:a,C:p}),o.mdChild=o.mdChild||[],o.mdChild.push({PId:s,ChId:p})),d&&c&&(l=n.W_.FrmFld[d])&&(l.md=l.md||[],l.md.push({P:a,C:c}),o.mdChild=o.mdChild||[],o.mdChild.push({PId:d,ChId:c}))}!r||o.Valid.P_MSAutoC&&"0"!=o.Valid.P_MSAutoC||(o.md=o.md||[],o.md.push({P:a,C:r}),o.mdChild=o.mdChild||[],o.mdChild.push({PId:a,ChId:r}))}var u,m=o.Valid.MasterCmp;if(m&&(u=n.W_.FrmFld[m])){if(u.Valid.CmpId!=o.Valid.CmpId)return void alert('CmpId of "'+a+'" must same as its MasterCmp("'+m+'")');var f=o.Valid.npMode;if(!f)return void alert('npMode is Require for "'+a+'" object');var h=n.W_.FrmFld[m+t.VMCmpXml];h.SubFrmBrothers=h.SubFrmBrothers||[],h.SubFrmBrothers.push({id:a,idXml:a+t.VMCmpXml,npMode:f,self:o.WidgetSelf})}})),e.each(n.W_.FrmFld,(function(a,o){var i=o.Valid,r=o.md;if(r){var l=o.Valid.HasDesc,s=n.W_.FrmFld[a].Valid.Def;s||(e.each(r,(function(e,t){var a=n.W_.FrmFld[t.P].WidgetSelf.W_.FrmFld[t.C].Valid.Def;if(a&&"$"!=a)return s=a,!1})),n.W_.FrmFld[a].Valid.Def=s),s&&n.SetDefToChild(a,s),n.ViewModel[a].subscribe((function(o){e.each(r,(function(e,i){var r={outpar:{}};r.outpar[i.C]=o,l&&(r.outpar[i.C+t.ACDesc]=n.ViewModel[a+t.ACDesc](),r.outpar[i.C+t.ACTip]=n.ViewModel[a+t.ACTip]()),n.W_.FrmFld[i.P].WidgetSelf._XML2ViewModel(r,{SetByMd:!0,NoInternalChg_OnSubs:!n.InternalChg_OnSubs})}))}))}"Cmp"==i.Typ?(o.mdChild&&e.each(o.mdChild,(function(e,t){o.WidgetSelf.SetRelationChildToParent(t.ChId,t.PId,o.WidgetSelf.W_.FrmFld[t.ChId].Valid.HasDesc)})),i.UrlF?(o.IsFaci=!1,i.OnAC||n.ViewModel[a+t.VMCmpXml].subscribe((function(a){var i={outpar:{}},r=e(a);r.length&&(e.each(r[0].attributes,(function(e,n){var a=n.name.toUpperCase();-1==a.indexOf(t.ACDesc.toUpperCase())&&-1==a.indexOf(t.ACTip.toUpperCase())&&(i.outpar[a]=n.value),a.indexOf(t.ACDesc.toUpperCase())>-1&&(i.outpar[a.replace(t.ACDesc.toUpperCase(),t.ACDesc)]=n.value),a.indexOf(t.ACTip.toUpperCase())>-1&&(i.outpar[a.replace(t.ACTip.toUpperCase(),t.ACTip)]=n.value)})),o.WidgetSelf._XML2ViewModel(i,{NoInternalChg_OnSubs:!n.InternalChg_OnSubs}))}))):o.IsFaci=!0):o.Elem=n.GetFldElem(a)})),e("label[for]",a).each((function(t,o){var i=e(o),r=i.attr("for"),l=e("#"+r,a),s=l.prop("tagName");if(s&&(s=s.toUpperCase())&&("DIV"==s||"SELECT"==s)){var d=l.attr("orgid"),p=l.hasClass("groupInput");if(d=d&&n.W_.FrmFld[d],"DIV"==s){var c=l.find("input:first");r=c.prop("id")||r,i.prop("for",r),p&&d&&(d.LabelElemCmp=i,c.css("box-shadow","none","important").data("LabelElemCmp",i).parent().css("box-shadow","none","important"))}p&&d&&"SELECT"==s&&i.insertAfter(l)}}))},GetFldElem:function(t){var n=this,a=n.W_.FrmFld[t],o=a.Elem;return o||"_Var"===a.Valid.Typ||(o=e("#"+n.MakeFullId(t),n.W_.$bod),a.Elem=o),o},GetFldWidgetElem:function(e){var t,n=this.W_.FrmFld[e],a=n.WidgetElem;if(!a){if(!(t=this.GetFldElem(e)))return;n.Valid.IsAC&&t.is(":np-npAutoComplete")&&(a=t.npAutoComplete("widget")),"Grd"==n.Valid.Typ&&t.is(":np-npgrid")&&(a=t.npgrid("widget")),"But"==n.Valid.Typ&&t.is(":np-npButton")&&(a=t.npButton("widget")),n.WidgetElem=a}return a},GetXmlValidation:function(){var n,a=this,o=a.options;a.element;function i(e){o.PreLoad?a.$ValidXml=o.PreLoad.$ValidXml:a.$ValidXml=JSON.parse(a.ReplaceParameter(o.P_,e||'{"r":{"n":{},"acts":{}}}',{EscapeJSON:!0})),a.Acts=a.$ValidXml.r.acts,a.iacts=a.$ValidXml.r.iacts,"0"==a.$ValidXml.r.Return&&(o.NoReturn=!0),o.NoReturn||a.W_.$ReturnButton&&a.W_.$ReturnButton.show();var t=a.$ValidXml.r.NoAuth;t&&"1"!=t&&delete a.$ValidXml.r.NoAuth,a.AfterGetXmlValidation(null,(function(){a.CreateFrmFlds(),a.CreateViewModelFinal()}),o.PreLoad?1:0)}if(o.CmpId&&(n=t.utils.NPLocalStorage(o.CmpType,o.CmpId,"XML")))i(n);else{var r={dataType:"text",cache:!0,error:function(e,t,n){alert("error occur at get xml validation")},success:function(e){i(e)}};t.noNg((()=>e.ajax(t.staticUrl+o.fname+".json",r)))}},CreateViewModel:function(n,a,o){var i=this;n=n||{},a=a||{},e.each(i.$ValidXml.r.n,(function(r,l){if(!o||r==o){var s=i.W_.FrmFld[r];if(l.id=r,!s){s=i.W_.FrmFld[r]={},(s=e.extend(s,{LastReq:null,Enable:!0,LastEnable:null,Show:null,LastShow:null,SetClear:null,DisAC:null,LastDisAC:null,relfield:"",Lastrelfield:""})).Valid=l;var d,p,c=s.Valid;if(c.Typ=c.Typ||"Txt",c.Nex=c.Nex||"",c.Dec=c.Dec||"",c.Req=c.Req||"0",c.Fro=c.Fro||"",c.To=c.To||"",c.Min=c.Min||"",c.Max=c.Max||"",c.Lan=c.Lan||"3",c.Fil=c.Fil||"",c.Jus=c.Jus||"",c.Cap=c.Cap||"",c.OnCh=c.OnCh||"","Tmpl"==c.Typ&&(i.ViewModel[r+t.OPTOPT]=ko.observableArray([])),"Grd"==c.Typ&&(i.W_.FrmFld_Grd[r]=s,s.ColsValid=l.col),c.StateNo&&(i.W_.FrmFld_StateNo[r]=s),"Htm"!=c.Typ&&"SHtm"!=c.Typ||(i.W_.FrmFld_Htm[r]=s),"PDat"==c.Typ&&(i.W_.FrmFld_PDat[r]=s),"GDat"==c.Typ&&(i.W_.FrmFld_GDat[r]=s),"Radio"==c.Typ&&(i.ViewModel[r+"_Enable"]=ko.observable(!0)),"1"==c.Opt){var u=[];l.d&&e.each(l.d,(function(t,n){var a={};e.each(n,(function(e,t){a[e]=t})),""===a.val&&""===a.dsc||u.push(a)})),i.ViewModel[r+t.OPTOPT]=ko.observableArray(u)}!c.Max&&c.To&&(c.Max=c.To.length),c.Max||"PDat"!=c.Typ&&"GDat"!=c.Typ||(c.Max=8),!c.Dec&&(d=c.To)&&(p=d.indexOf("."))>-1&&(c.Dec=d.substr(p+1).length),s.Help=c.Hlp,s.Req=c.Req,s.Act=c.Act,s.Alias=c.Alias,"DLbl"==c.Typ&&(c.ValidInc||(c.ValidExc="1"),c.RO="1");var m=c.Def;m||(m="");try{m.indexOf("(")>-1&&(m=m.replaceAll("(","").replaceAll(")",""),c.Def=m)}catch(e){}var f,h,g=m+="",C=m.indexOf("$");if(C>-1&&(g="$$"==m?"$":m.substr(0,C),m="$",c.Def=m),i.ViewModel[r]=ko.observable(g),i.ViewModel[r].extend({notify:"always"}),n[r]&&(s.md=JSON.parse(n[r])),a[r]&&(s.mdChild=a[r]),(f=c.Alias)&&(f=f.toUpperCase(),i.W_.Alias2Id[f]=r,-1==r.indexOf(t.ACDesc)&&-1==r.indexOf(t.ACTip)&&-1==r.indexOf(t.VMCmpXml)&&(i.W_.Alias2Id[f+t.ACDesc]=r+t.ACDesc,i.W_.Alias2Id[f+t.ACTip]=r+t.ACTip,i.W_.Alias2Id[f+t.VMCmpXml]=r+t.VMCmpXml,i.W_.Alias2Id[f+t.VMCmpXmlUppercase]=r+t.VMCmpXml)),c.MSAutoC&&"0"!=c.MSAutoC&&(s.Type2="MS"),"But"==c.Typ){var v=s.Elem=e("#"+i.MakeFullId(r),i.W_.$bod),b={},_=c.RIcon,F=c.LIcon,w=c.Label;if((_||F)&&(b.icons={},F&&(b.icons.primary=F),_&&(b.icons.secondary=_)),c.BtnClass&&(b.type=c.BtnClass),void 0===w&&(w=v.html()),""==w?b.text=!1:b.label=w,v.npButton(b),"1"==c.IsCurSubFrm){var y=e("<div id="+v.attr("id")+" class='btn btn-success' orgid="+v.attr("orgid")+" style='display:inline-block;cursor:auto' >"+v.text()+"</div>");e(y).insertAfter(v),v.remove()}}S("OpenFaci"),S("OnOvr"),S("OnOut"),S("OnClk"),S("OnBl"),S("OnCh"),(h=c.OnSubs)&&i.ViewModel[r].subscribe((function(e){i._trigger(h,null,{NewValue:e,IsUsrChg:!i.InternalChg_OnSubs})}))}}function S(e){var t=c[e];t&&(s["np-"+e]=t)}}))},HideHeader:function(){this.$np("#dvfrmHeader").parent().addClass("np-d-none")},ShowHeader:function(){this.$np("#dvfrmHeader").parent().removeClass("np-d-none").removeClass("d-none")},AfterGetXmlValidation:function(n,a,o){var i=this,r=i.options,l=(i.element,t.utils.NPLocalStorage(0,r.CmpId,"H"));if(i.W_.$dvfrmHeader.wrapAll("<div class='d-flex flex-row w-100 flex-nowrap' ></div>"),i.W_.$dvfrmHeader.css("overflow-x","auto").addClass("d-flex flex-row flex-nowrap p-0 flex-grow-1"),!r.ParentCmp&&!i.HHlpIconIsAdded){try{i.parsedHelpJson=l&&JSON.parse(l)?.help}catch(e){}i.parsedHelpJson&&(i.parsedHelpJson.forEach((e=>{e.h=e.h||[],e.h=e.h.filter((e=>2==e.cnf))})),i.parsedHelpJson=i.parsedHelpJson.filter((e=>e.h.length))),("1"==r.HHLP||i.parsedHelpJson&&i.parsedHelpJson[0]?.mode)&&(i.W_.HelpBox=e('<div class="pl-2"><button class="p-2 btn" style="border:0px" data-bind="click: vm_FaciHelp"><span title="راهنما"  class="ui-icon ui-icon-Texthelp FaciHelp"></span></span></button></div>'),i.W_.$dvfrmHeader.parent().prepend(i.W_.HelpBox)),r.OpenInDialog||r.OpenInline||i.GetngData()?.AngularFaci?.hideBackButton&&i.GetngData().AngularFaci.hideBackButton()||(r.HideBackButton=!0),i.W_.$dvfrmHeader.parent().prepend(e('<div class="d-flex pl-2 align-items-start"><button class="btn btn-outline-info'+(r.HideBackButton?" np-d-none":"")+'" style="border:0;border-radius:0" data-bind="click: vm_ReturnBack"><svg version="1.1" xmlns="http://www.w3.org/2000/svg"   xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 170 150" xml:space="preserve">   <path style="fill:#2b5989;stroke-width:0.35660052;fill-opacity:1" inkscape:connector-curvature="0" d="m 0.39537578,80.46493 a 80.235119,80.235119 0 1 0 160.47023422,0 80.235119,80.235119 0 1 0 -160.47023422,0" ></path>   <path  d="m 6.8704361,80.46493 a 73.760058,73.760058 0 1 0 147.5201139,0 73.760058,73.760058 0 1 0 -147.5201139,0" inkscape:connector-curvature="0" style="fill:#ffffff;stroke-width:0.32782248"></path>   <path style="fill:#2b5989;stroke-width:0.11146249;fill-opacity:1" inkscape:connector-curvature="0" d="m 27.181084,87.0289 h 81.175586 l -37.415216,37.53242 9.689032,9.35302 53.449414,-53.4494 -53.449414,-53.44941 -9.352702,9.35333 37.078886,37.4149 H 27.181084 v 13.36235 z" ></path></svg></button></div>')),e(i.W_.$dvfrmHeader.find("td").get().reverse()).each((function(t,n){var a=e(n);""!=a.html()&&(a.contents().wrapAll('<div style="padding-left:5px;white-space:nowrap" class="align-self-center" ></div>').parent().attr("np-frm-title",a.attr("np-frm-title")).prependTo(i.W_.$dvfrmHeader),a.removeAttr("np-frm-title"))})),i.HHlpIconIsAdded=!0}a||(a=n,n=null);var s=[];o||e.each(i.$ValidXml.r.load,(function(e,n){var a=n;t.NPPkgs[a]&&!t.NPPkgs[a].Loaded&&s.push(a)})),t.IscalendarLoaded||(t.IscalendarLoaded=1,s.push("calendar")),i.NewComponentsObj={};var d=0;i.FormComponentsIdArr=[],i.FormFacisIdArr=[];var p={},c={},u=r.PreLoad?1:0;e.each(i.$ValidXml.r.n,(function(n,a){var o=i.NPGen?i.NPGen.ver:0;!u&&o<302&&("2"==a.Lan&&e("#"+i.MakeFullId(n),i.W_.$bod).addClass("IsLatin"));if("Cmp"==a.Typ&&(a.OnAC?(i.$ValidXml.r.n[n].HasDesc=!0,i.$ValidXml.r.n[n+t.ACDesc]={Typ:"_Var",Cap:"desc",Alias:i.$ValidXml.r.n[n].Alias+t.ACDesc},i.$ValidXml.r.n[n+t.ACTip]={Typ:"_Var",Cap:"tip",Alias:i.$ValidXml.r.n[n].Alias+t.ACTip},i.$ValidXml.r.n[n+t.ACDesc].Def=i.$ValidXml.r.n[n].Def,i.$ValidXml.r.n[n].Alias||(delete i.$ValidXml.r.n[n+t.ACDesc].Alias,delete i.$ValidXml.r.n[n+t.ACTip].Alias)):(i.$ValidXml.r.n[n+t.VMCmpXml]={Typ:"_Var",Cap:"CmpXml",Alias:i.$ValidXml.r.n[n].Alias+t.VMCmpXml},i.$ValidXml.r.n[n].Alias||delete i.$ValidXml.r.n[n+t.VMCmpXml].Alias)),a.d&&(a.Opt="1"),a.md&&e.each(a.md,(function(e,t){var a=t.PId,o=t.ChId,i=n,r=p[a];r=r?r.substr(0,r.length-1)+",":"[",r+='{"P":"'+i+'","C":"'+o+'"}]',p[a]=r,c[i]=c[i]||[],c[i].push({PId:a,ChId:o})})),"Cmp"==a.Typ){var r=a.UrlF,l=a.UrlP,s=a.CmpId;r&&l&&!t.utils.NPLocalStorage(a.CmpType,s,"HTML")&&!i.NewComponentsObj[s]&&(i.NewComponentsObj[s]={},t.fillCmpNames(i.NewComponentsObj[s],l+"/",r),++d),s?i.FormComponentsIdArr.push(n):i.FormFacisIdArr.push(n)}}));var m=s.length,f=0,h=!1,g=function(){++f<m+d||(h||(h=!0,i.CreateViewModel(p,c)),i.AfterGetAllPkgCmp(n,(function(){a.call(i)})))};m&&e.each(s,(function(e,t){i.GetPkg(t,g)})),d&&e.each(i.NewComponentsObj,(function(e,t){i.GetComponent(e,g)})),h||(h=!0,i.CreateViewModel(p,c)),m||d||i.AfterGetAllPkgCmp(n,a)},AfterGetAllPkgCmp:function(t,n){var a=this,o=a.FormComponentsIdArr.length,i=a.FormFacisIdArr.length,r=0;if(t&&t.call(a),o||i){var l=function(){++r<o||(r-o<i?a.CreateComponent(a.FormFacisIdArr[r-o],l):n.call(a))};e.each(a.FormComponentsIdArr,(function(e,t){a.CreateComponent(t,l)})),0==o&&a.CreateComponent(a.FormFacisIdArr[0],l)}else n.call(a)},_SetValueOf_P_:function(t,n){t.P_={},e.each(n,(function(e,n){var a=e,o=n;0==a.indexOf("P_")&&(t.P_[a]=o,!0)}))},CreateComponent:function(n,a){var o,i,r,l=this,s=l.options,d=(l.element,l.W_.FrmFld[n]),p=d.Valid,c=d.Valid,u=p.UrlF,m=p.CmpId,f=0;if(s.PreLoad&&s.PreLoad.Childs&&s.PreLoad.Childs[n]?(i=s.PreLoad.Childs[n],f=1):(i={},l._SetValueOf_P_(i,c)),i.ParentCmp=l,i.IdInFather=n,i.ReadyCallBack=function(e,t){1==t.cnt&&a&&a.call(this,"success in Create:"+u)},!u){i.IsCmp=!1,i.IsFaci=!0,o='<div style="position:relative" id="'+l.MakeFullId(n)+'_W_"></div>',r=l.$np("#"+n,l.W_.$bod).html(o),i.InlineBox=d.Elem=l.$np("#"+n+"_W_",r);var h=p.FType,g=p.FId,C=p.SubFId;return i.ReturnCaption="",i.Width="auto",i.Height="auto",i.inxml=null,i.OpenInline=!0,void l.OpenNewForm(h,g,C,i)}i.IsCmp=!0,i.IsFaci=!1,i.CmpId=m,i.Usrfrm=s.Usrfrm,i.UserLvl=s.UserLvl,f||(i.P_[t.P_IDIDID]=l.MakeFullId(n)+"_W_",o=t.utils.NPLocalStorage(0,m,"HTML"),i.IsMakedFullId=o.indexOf(t.P_IDIDID)>-1,i.IdPrefix=i.IsMakedFullId?"#"+l.MakeFullId(n)+"_W_":"#",o=l.ReplaceParameter(i.P_,o,{EscapeXml:!0}),o='<div style="position:relative" id="'+l.MakeFullId(n)+'_W_">'+o+"</div>",i.AddrPath=p.UrlP+"/",i.FName=u,i.fname=i.AddrPath+i.FName);var v=function(a){if(l.W_){r=l.$np("#"+n,l.W_.$bod),f||(r.html(a),e(i.IdPrefix+"bod",r).css("overflow","visible").removeClass("ui-widget-content"),e(i.IdPrefix+"dvfrmCenter",r).css("overflow","visible"),p.OnAC&&r.attr("data-bind","BindingCmp:"+n+",Desc:"+n+t.ACDesc+",Tip:"+n+t.ACTip+',CmpId:"'+n+'"')),d.Elem=l.$np("#"+n+"_W_",r),d.WidgetName=u;var o=c.npMode;o&&(i.npMode=o),e.NPCreateWidget(d.Elem,d.WidgetName,i)}};f?v.call(l,o):(i.PreLoad={},i.PreLoad.html_core=e(o),i.PreLoad.PreId=l.MakeFullId(n)+"_W_",l.GetCmpInStr(i,(function(){v(i.PreLoad.html_core)})))},CreateDynaComponent:function(e,n){var a=this,o=e.id,i=a.$ValidXml.r.n[o]={};i.CmpId="110010",i.UrlF="BAS0245_CMP_DYNAFRM",i.UrlP="/frm/BAS0245_CMP_DYNAFRM",i.Typ="Cmp","1"==e.Req&&(i.Req="1"),a.$ValidXml.r.n[o+t.VMCmpXml]={Typ:"_Var",Cap:"CmpXml"},a.CreateViewModel(null,null,o),a.CreateComponent(o,n)},GetDynaComponent:function(e){var t="/frm/BAS0245_CMP_DYNAFRM/BAS0245_CMP_DYNAFRM",n="/frm/BAS0245_CMP_DYNAFRM/",a={CmpId:110010,CmpType:0,Js_FileName:t+".js",Html_FileName:t+".htm",Xml_FileName:t+".json",CC_Filename:n+"controlchange.htm",H_FileName:n+"usrhlp.json"};this.GetComponent(a,e)},GetComponent:function(e,n){"object"!=typeof e&&(this.NewComponentsObj[e].CmpId=e,(e=this.NewComponentsObj[e]).CmpType=e.CmpType||0),t.utils.GetComponent(e,n)},GetPkg:function(n,a){var o,i,r=this,l={description:""};if(!(o=t.NPPkgs[n])||!(i=o.js?.length)||!o.css)return i?o.css?l.description="This Pkg is Unknown":l.description="This Pkg hasnt css":l.description="This Pkg hasnt any js",void a.call(this,l);if(o.Loaded)return l.description="This Pkg is Loaded Before",void a.call(this,l);if(o.CallBacks)o.CallBacks.push(a);else{o.CallBacks=[],o.CallBacks.push(a);var s=t.utils.NPLocalStorage(0,1,"FORMSJS");o.css.map((e=>t.loadStyle(e.f,s).then((()=>{e.Loaded=!0})).catch((()=>{console.warn('style:"'+e.f+'" not loaded')})))),e.each(o.js,(function(e,t){t.Loading=!1,t.Loaded=!1}));var d=0,p=function(t){if(++d<i)r.GetJs(o.js[d],p,s);else if(d==i){var n=!0;e.each(o.js,(function(e,t){t.Loaded||(n=!1)})),o.Loaded=n,t.description=n?"Get Pkg Compeleted":"Get Pkg has error",e.each(o.CallBacks,(function(e,n){n.call(this,t)})),n||delete o.CallBacks}};r.GetJs(o.js[d],p,s)}},GetJs:function(e,n,a){var o="";e||(o="no input"),e.f||(o="file not defined"),e.Loading&&(o="js in loading"),e.Loaded&&(o="js loaded before"),o?n.call(this,o):(e.Loading=!0,t.loadScript(e.f,a).then((()=>{e.Loaded=!0,n.call(this,"success in get:"+e.f)})).catch((()=>{e.Loading=!1,n.call(this,"error in get:"+e.f)})))},AddStyleSheet:function(e,t,n){},AddStyleSheet_Core:function(e){},BeforeBinding:function(){},ShowACData:function(e,t,n){var a=this,o=(a.options,a.element,a.W_.FrmFld[e].Valid.OnAC),i=a.W_.FrmFld[e].Valid.OnACSMC;if(o){n&&(t.IsHelp=!0,t.MaxHlp=t.MaxHlp||200,t.HelpId=a.MakeFullId(e));var r=function(){return a._trigger(o,null,t)};if(!n||!i)return t.NotRunFromShowMore=!1,r.call(this);t.NotRunFromShowMore=!0,a._trigger(i,null,{CallBack:r,Params:t})}},CreateViewModelFinal:function(){var n=this,a=n.options,o=n.element,i=n.$ValidXml.r;n.W_.RAttrOfValidation={},e.each(i,(function(e,t){n.W_.RAttrOfValidation[e]=t})),n.UseModeCode=1;var r=i.MChanger;n.NPGen=i.NPGen,r||(r=""),n.MChanger=r,n.CreateHlpInOut_Act(),n.ViewModel.vm_bod=n.Get$bod().parent(),n.ViewModel.vm_rst=n.ViewModel,n.ViewModel.vm_npform=n,e.each(n.W_.FrmFld,(function(t,o){var i,r;if(o.Valid.Typ&&"Check"==o.Valid.Typ){var l=n.GetFldElem(t);if(0!=e(l).next("label").length){var s=e(l).next("label");s.attr("for")||s.attr("for",e(l).attr("id")),e(l).hide().wrap("<div class='checkbox checkbox-success' style='display:inline;white-space:nowrap;margin:0px'></div>"),e(l).parent().append(s)}}if(!o.Valid.Typ||"Radio"!=o.Valid.Typ||"1"!=o.Valid.SimpleRadio&&"1"!=o.Valid.BreakRadio){if(o.Valid.Typ&&"Radio"==o.Valid.Typ){d="<label class='btn btn-outline-primary' style='border:1px dashed;height:24px' data-bind=\"css:{'active':$root."+t+'()==val} "><input type="radio" data-bind="enable:$root[\''+t+"_Enable'],attr: {id:$root.vm_FullId('"+t+"')+'_'+val, value: val , name:$root.vm_FullId('"+t+"')}, checked: $root."+t+"\" /><label data-bind=\"attr:{'for':$root.vm_FullId('"+t+"')+'_'+val}, html:dsc\" ></label></label>";(l=n.GetFldElem(t)).addClass("btn-group").attr("data-toggle","buttons").attr("data-bind","foreach: "+t+"_OPT").html(d)}else if(o.Valid.Opt&&"1"==o.Valid.Opt){r=i=(l=n.GetFldElem(t))&&l.attr("data-bind"),o.Valid.OptEq&&(r=r.replace(/options:\w*_OPT/g,"options:"+o.Valid.OptEq+"_OPT")),i&&-1==i.indexOf("foreach")&&-1==i.indexOf("attr:{")&&!l.attr("title")&&(r=r+",attr:{title:$root.vm_ValText($data,$context,'"+t+"')}"),i!=r&&l.attr("data-bind",r)}}else{var l=n.GetFldElem(t),d="<input type=\"radio\" style='margin-right:5px;margin-left:5px' data-bind=\"enable:$root['"+t+"_Enable'],attr: {id:$root.vm_FullId('"+t+"')+'_'+val, value: val , name:$root.vm_FullId('"+t+"')}, checked: $root."+t+"\" /><label style='display:inline;' data-bind=\"attr:{'for':$root.vm_FullId('"+t+"')+'_'+val}, html:dsc\" ></label>";"1"==o.Valid.BreakRadio&&(d+="<br/>"),l.addClass("btn-group").attr("data-bind","foreach: "+t+"_OPT").html(d)}var p=o.Valid.Act;p&&(l=n.GetFldElem(t)).attr("np-act",p);if(o.Valid.SAC&&o.Valid.Dat&&(o.Valid.OnAC=1),o.Valid.OnAC&&!o.Valid.CmpId){o.Valid.IsAC=!0;l=n.GetFldElem(t);var c=o.Valid.MSAutoC,u=o.Valid.OnACRFR,m=o.Valid.SAC,f=o.Valid.MaxHlp,h=o.Valid.SingleS,g=o.Valid.Ltl,C=o.Valid.BoxWidth,v=o.Valid.SCol,b=o.Valid.disabled,_=o.Valid.TipCol,F=o.Valid.Dat,w=o.Valid.KCol;i="npAutoComplete:"+t+",valueUpdate:'afterkeydown'"+(c&&"0"!=c?",MSAutoC:"+c:"")+",ACOptions:{Cmpid:'"+t+"',ACid:'"+t+"',vm_npform:vm_npform,appendTo:vm_bod,rst:["+n.Acts["act"+p].rst+"],csq:["+n.Acts["act"+p].csq+"],ActNo:'"+p+"'"+(m?",SAC:'"+m+"'":"")+(f?",MaxHlp:'"+f+"'":"")+(h?",SingleS:'"+h+"'":"")+(C?",BoxWidth:'"+C+"'":"")+(v?",SCol:'"+v+"'":"")+(b?",disabled:"+(1==b?"true":"false"):"")+(g?",Ltl:'"+g+"'":"")+(F?",Dat:'"+F+"'":"")+(_?",TipCol:'"+_+"'":"")+(w?",KCol:'"+w+"'":"")+(u?",NPRender:"+t+"_Ren":"")+"}",u&&(n.ViewModel[t+"_Ren"]=a[u]),l.attr("data-bind",i)}})),n._trigger("CreateViewModel"),n.BeforeBinding(),n.IsBindingInProgress=!0,i.DontApplyBinding||ko.applyBindings(n.ViewModel,o[0]),n.IsBindingInProgress=!1,n.StartValidationCheck(),n.$ValidXml.r.NoAuth&&n.ReFillLookup(),e.each(n.W_.FrmFld,(function(t,a){"Cmp"==a.Valid.Typ&&110025==a.Valid.CmpId&&a.Valid.SAC&&"1"==a.Valid.SAC&&(n.$ValidXml.r.NoAuth?n.$ValidXml.r.NoAuthSAC="1":(n.$ValidXml.r.AuthSAC="1",e.each(a.WidgetSelf.W_.FrmFld,(function(e,t){t.Valid.IsAC&&(a.Valid.npAutoCompleteWidget=t.Elem.npAutoComplete("instance"))}))))})),e.each(n.W_.FrmFld_Htm,(function(t,a){var i=a.Valid,r=i.Typ;if("Htm"==r||"SHtm"==r){e("label[for='"+n.MakeFullId(t)+"']",o).each((function(a,o){e(o).prop("for",n.MakeFullId(t)+"_Editor")}));var l=i.Lan;l&&"Htm"==r&&n.GetFldElem(t).each((function(t,n){e.data(n,"cleditor").ChangeLang(2==l?"latin":1==l?"farsi":"both")}))}})),n.SetDatePickers(),e.each(n.W_.FrmFld_Grd,(function(t,a){var o=a.Valid,i=o.Act;i&&(n.$ValidXml.r.acts["act"+i].help="0");var r,l,s,d={npform:n,IsNotHelp:!0,DefaultNoRadif:!0,ActNo:o.Act,MaxRowId:o.MaxRowId,NoRowColor1:!(!o.NoRowColor1||"1"!=o.NoRowColor1),NoRowColor2:!(!o.NoRowColor2||"1"!=o.NoRowColor2),NoRowColor3:!(!o.NoRowColor3||"1"!=o.NoRowColor3),NoTdPadding:!(!o.NoTdPadding||"1"!=o.NoTdPadding),NoShowHeader:!(!o.NoShowHeader||"1"!=o.NoShowHeader),StopSort:!(!o.StopSort||"1"!=o.StopSort)},p=null;(r=o.Switch)&&((p=p||{}).Switch=r),a.Valid.mode&&e.each(a.Valid.mode,(function(e,t){(p=p||{}).All=p.All||[];var n=p.All[e]={};(l=t.id)&&(n.Mode=l),n.ModeXml=t,(s=t.DisableF)&&(n.DisableF=s.split(","))})),p&&(d.Modes=p),n.CreateNPGrid(a.Valid,d,n.GetFldElem(t))}));var l,s,d=i.CmpState;if(d&&(n.CmpStateId=d,n.CmpStateVal=n.ViewModel[d](),n.ViewModel[d].subscribe((function(e){n.CmpStateVal=e||"",n.InitFrm_Core()}))),n.MChanger?(n.FMod=n.ViewModel[n.MChanger](),n.ViewModel[n.MChanger].extend({notify:""}).subscribe((function(e){n.FMod_Changed()})),n.UseModeCode||n.FMod_Changed()):n.FMod=0,n._trigger("AfterLoad"),l=a.inxml&&a.inxml.doact&&"0"==a.inxml.doact.act00,s=a.inxml&&a.inxml.doact&&a.inxml.doact.act,l||(l="0"==i.Act00),l&&a.CmpId){var p={NoAct00:!0};n.ActNo=p.ActNo="00",p.ErLen=n.ErLen=0,p.WarLen=n.WarLen=0,n.CalcModeCode("00",0),n._XML2ViewModel(a.inxml,{NoAct00:!0});try{t.noNg((()=>n.Get_Data_Core(0,p)))}catch(e){console.error("Get_Data_Core"),console.error(e)}s?t.noNg((()=>n.DoAct(s,null,{RunInQueue:!0}))):(n.CalcModeCode("00",0),a.ParentCmp||n.InitFrm())}else//!op.CmpId==>in first form must doact00 for get oaut
n.DoAct("00",null)},MakeFullId:function(e){return this.ContId+e},MakeOrgId:function(e){return e&&e.substring(this.ContId.length,e.length)},SetDatePickers:function(){var n=this;e.each(n.W_.FrmFld_PDat,(function(a,o){var i=o.Valid.Fro?o.Valid.Fro.substring(0,4):"1300",r=o.Valid.To?o.Valid.To.substring(0,4):"1420";n.GetFldElem(a).parent()&&"TD"==n.GetFldElem(a).parent()[0]?.tagName&&n.GetFldElem(a).css("width","80px");n.GetFldElem(a).datepicker({dateFormat:"yy/mm/dd",changeYear:!0,yearRange:i+":"+r,showOn:"button"==o.Valid.ShowOn?"button":"focus",buttonImage:"../../img/calendar.gif",buttonImageOnly:!0,buttonText:"",beforeShow:function(n,a){if(e(this).prop("readonly"))return!1;e("body").on("scroll",(function(){a.dpDiv.css({top:e(n).offset().top+a.input.outerHeight()})})),t.noNg((()=>setTimeout((function(){a.dpDiv.css({top:e(n).offset().top+a.input.outerHeight()})}),0)))},onClose:function(e,t){}})})),e.each(n.W_.FrmFld_GDat,(function(t,a){var o=a.Valid.Fro?a.Valid.Fro.substring(0,4):"1900",i=a.Valid.To?a.Valid.To.substring(0,4):"2040";n.GetFldElem(t).datepicker({dateFormat:"yy/mm/dd",calendar:Date,changeYear:!0,yearRange:o+":"+i,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["January","February","March","April","May","June","July","August","September","October","November","December"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],showOn:"button"==a.Valid.ShowOn?"button":"focus",buttonImage:"../../img/calendar.gif",buttonText:"",buttonImageOnly:!0,beforeShow:function(t,n){if(e(this).prop("readonly"))return!1}})}));var a=e("#ui-datepicker-div");a.length&&(parBox=a.parent(),parBox.length&&!parBox.hasClass("np5ht7")&&a.wrap('<div np5ht7 class="np5ht7"/>'))},OpenWaitingDialog:function(e){},CloseWaitingDialog:function(){},$np:function(t,n){var a,o,i=t;return(a=i.indexOf("#"))>=0&&(o=i.substring(a+1,i.length),i=i.substring(0,a)+"#"+this.MakeFullId(o)),e(i,n)},GetFrmFld:function(e){return this.W_.FrmFld[e]},GetCmpSelf:function(e){var n=this.W_.FrmFld[e];return!n.WidgetSelf&&n.Elem&&n.WidgetName&&(n.WidgetSelf=t.utils.GetWidgetSelf(n.Elem,n.WidgetName)),n.WidgetSelf},Xml2Obj:function(t){var n={};return e.each(t[0].attributes,(function(e,t){n[t.name]=t.value})),n},_Init_SndXML:function(e){var t=this,n=(t.options,e&&e.NavType||"");if("nav"==n)t._SndNavXML=null,t._SndNavXML={...t.AutXml()},t._SndNavXML.rp&&(t._SndNavXML.rp={...t._SndNavXML.rp},delete t._SndNavXML.rp.seq);else if("logout"==n)t._SndNavXML=null,t._SndNavXML={...t.AutXml()};else{if(e.AnotherSvc||(t._SndXML=null),t.$ValidXml.r.NoAuth)return void(t._SndXML={r:{}});t._SndXML={...t.AutXml(),r:t._SndXML?t._SndXML.r:{}}}},OpenerTicketSelf:function(){var e=this.options;return e.OpenerTicketSelf||e.OpenerSelf},SetAutByResp:function(e,t){var n,a=this,o=e?.t;if(o&&a.setTicket(o),t){var i={rp:{...e.oaut?.rp,sp:{...e.oaut?.sp}}};a.GetngData().AngularTab?.setDataByUrl(i),(n=i.rp).sp.UsrType=n.sp.UsrType||localStorage.getItem("ut"),n.ut=n.sp.UsrType,n.b=n.sp.BrnNo,n.sp=JSON.stringify(n.sp),n.sid=localStorage.getItem("sid");var r=a.AutXml().rp;r&&(delete r.fop,delete r.foh)}else(n={...a.AutXml().rp}).fop=e?.oaut?.rp?.fop,n.foh=e?.oaut?.rp?.foh,n.fop||e?.oaut?.rp?.fop,n.foh||e?.oaut?.rp?.foh,a.AutXml().rp=n;return n},GetngData:function(){var e=this.options;return(e.IsCmp||e.IsFaci)&&e.ParentCmp?e.ParentCmp.GetngData():e.UseOpenerAut?this.OpenerTicketSelf().GetngData():e.ngData||e?.OpenerSelf?.GetngData()},AutUT:function(){return this.AutXml().rp.ut},RunDoActInQueueCnt:function(e){var t=this,n=t.options;return n.IsCmp&&n.ParentCmp?n.ParentCmp.RunDoActInQueueCnt(e):n.UseOpenerAut?t.OpenerTicketSelf().RunDoActInQueueCnt(e):!!t.W_&&("inc"==e&&t.W_.RunDoActInQueue++,"dec"==e&&t.W_.RunDoActInQueue--,t.W_.RunDoActInQueue)},IsFreezServer:function(){var e=this,t=e.options;return t.IsCmp&&t.ParentCmp?t.ParentCmp.IsFreezServer():t.UseOpenerAut?e.OpenerTicketSelf().IsFreezServer():e.FreezServer},SetFreezServer:function(e){var t=this,n=t.options;return n.IsCmp&&n.ParentCmp?n.ParentCmp.SetFreezServer(e):n.UseOpenerAut?t.OpenerTicketSelf().SetFreezServer(e):(t.FreezServer=!!e,t.SetWebBusy(e))},SetWebBusy:function(e){var t=this,n=t.options;return n.IsCmp&&n.ParentCmp?n.ParentCmp.SetWebBusy(e):n.UseOpenerAut?t.OpenerTicketSelf().SetWebBusy(e):(t.WebBusy=!!e,t.ViewModel.WebBusy(!!e),t.WebBusy)},IsWebBusy:function(e){var t=this,n=t.options;if(n.IsCmp&&n.ParentCmp)return n.ParentCmp.IsWebBusy(e);if(n.UseOpenerAut)return t.OpenerTicketSelf().IsWebBusy(e);if(t.IsFreezServer())return!0;if(t.W_.TokenQueue||(t.W_.TokenQueue=[]),e){for(var a=t.W_.TokenQueue,o=0;o<a.length;o++)if(a[o].Params.Key==e)return!0;return!1}return 0!==t.W_.TokenQueue.length},_DoServer:function(e,t,n,a){var o=this,i=o.options;if(i.IsCmp&&i.ParentCmp)return i.ParentCmp._DoServer(e,t,n);if(i.UseOpenerAut)return o.OpenerTicketSelf()._DoServer(e,t,n,a||o);if(o.W_.TokenQueue||(o.W_.TokenQueue=[]),!o.W_.TokenQueue.length){var r=function(e){o.W_&&(o.WebBusy=!1,(e||o).ViewModel.WebBusy(!1),o.W_.TokenQueue=o.W_.TokenQueue.slice(1),o.W_.TokenQueue.length>0&&(o.WebBusy=!0,(o.W_.TokenQueue[0].RealSelf||o).ViewModel.WebBusy(!0),o.W_.TokenQueue[0].CB(r,!0,o.W_.TokenQueue[0].RealSelf)))};return o.WebBusy=!0,(a||o).ViewModel.WebBusy(!0),o.W_.TokenQueue=[{CB:t,Params:n}],o.W_.TokenQueue[0].CB(r,!1,a)}return!!e&&o.W_.TokenQueue.push({CB:t,Params:n,RealSelf:a})},QueueAct:function(e,t){this._DoServer(!0,e,t)},ImmedAct:function(e,t){return this._DoServer(!1,e,t)},AutXml:function(){var e=this,t=e.options;if(t.IsCmp&&t.ParentCmp)return t.ParentCmp.AutXml();if(t.UseOpenerAut)return e.OpenerTicketSelf().AutXml();const n=localStorage.getItem("t");return e.Aut.t=n,e.Aut},getFid:function(){return this.AutXml().rp.f},getUt:function(){return this.AutXml().rp.ut},RootContId:function(){var e=this.options;return e.ParentCmp?e.ParentCmp.RootContId():e.OpenInDialog||e.OpenInline?e.OpenerSelf.RootContId():this.ContId},setTicket:function(e){this.GetngData()?.AngularTab?.setTicket?this.GetngData()?.AngularTab?.setTicket(e):localStorage.setItem("t",e)},GetAut:function(t){var n,a="";n=t?[t]:["ft","f","seq","subfrm","t","ut","act"];var o=this.AutXml();return e.each(n,(function(e,t){a=a+"  "+("t"==t||"act"==t?o[t]:o.rp[t])})),a.substr(2)},PassValueToParent:function(e,n){var a=this;e.indexOf(t.ACDesc)>1&&!a.W_.FrmFld[e.substring(0,e.indexOf(t.ACDesc))].Valid.HasDesc||e.indexOf(t.ACTip)>1&&!a.W_.FrmFld[e.substring(0,e.indexOf(t.ACTip))].Valid.HasDesc||a.Val(e)!==a.NPFix(e,n)&&a.Val(e,n)},SetRelationChildToParent:function(n,a,o){var i=this,r=i.options;i.W_.FrmFld[n].dm||(i.W_.FrmFld[n].dm=[],i.ViewModel[n].subscribe((function(a){var l,s;o&&(l=i.ViewModel[n+t.ACDesc](),s=i.ViewModel[n+t.ACTip]()),e.each(i.W_.FrmFld[n].dm,(function(e,n){o&&r.ParentCmp.PassValueToParent(n+t.ACDesc,l),o&&r.ParentCmp.PassValueToParent(n+t.ACTip,s),r.ParentCmp.PassValueToParent(n,a)}))}))),i.W_.FrmFld[n].dm.push(a)},GetHlpInsteadElem:function(){return this.element},GetHlpIn:function(t,n,a,o){var i=this,r=i.options;if(n.push(i.MakeFullId(t)),i.W_.FrmFld[t]){if(a.push(i.W_.FrmFld[t].Valid.Typ),o){var l,s,d=i.GetFldElem(t);if(d){if("Cmp"==i.W_.FrmFld[t].Valid.Typ){var p=i.W_.FrmFld[t].WidgetSelf;s=3,l=p&&p.GetHlpInsteadElem()}else s=2,(l=i.GetFldWidgetElem(t))||(l=d,s=1);l&&o.push({Elem:l,HlpElemType:s})}}var c=i.W_.FrmFld[t].dm;c&&e.each(c,(function(e,t){var i=r.ParentCmp.MakeFullId(t);-1==n.indexOf(i)&&r.ParentCmp.GetHlpIn(t,n,a,o)}));var u=i.W_.FrmFld[t].md;u&&e.each(u,(function(e,t){var r=i.GetCmpSelf(t.P).MakeFullId(t.C);-1==n.indexOf(r)&&i.GetCmpSelf(t.P).GetHlpIn(t.C,n,a,o)}))}},Reset:function(n){var a=this,o=(a.options,a.element,a.ActNo);a.W_.$dvfrmCenter[0].scrollLeft=a.W_.$dvfrmCenter[0].offsetWidth,n||(a.ActNo="00",a.CalcModeCode(a.ActNo,0),a.ResizeHandler()),a.IsBindingInProgress=!0,a.InternalChg_OnSubs=!0;try{e.each(a.W_.FrmFld,(function(e,i){var r=e,l=i.Valid.Typ,s=i.Valid.Def;switch(void 0===s&&(s=""),l){case"Cmp":a.GetFldElem(r);"$"!=s&&(n||i.WidgetSelf.Reset(n),a.Val(r,s),i.Valid.XmlDef=i.Valid.XmlDef||i.Valid.P_XmlDef,i.Valid.XmlDef&&a.Val(r+t.VMCmpXml,i.Valid.XmlDef));break;case"Grd":"00"!==o&&"$"!=s&&a.GetFldElem(r).npgrid("refresh","<Root/>");break;default:"$"==s||n&&""==s||a.Val(r,s)}}))}finally{a.InternalChg_OnSubs=!1,a.IsBindingInProgress=!1}},ResetClick:function(e){var t=this;t.IsWebBusy()||(t.ClearRespmsg(),t.Reset(e),t.InitFrm())},Get_Data_Core:function(t,n){var a=this,o=a.options,i=a.element;o.ReturnActParam=null,n=n||{},a.fromdash=!1;var r=a.W_.Alias2Id.F77771;if("00"==n.ActNo&&r){var l=a.Val(r);if(""!=l&&(a.fromdash=!0,l=l.split("@@"),a.Val(r,l[0]),l[1])){a.fromdashact=l[1];var s=a.W_.Alias2Id.F00111;s&&a.Val(s,l[1])}}try{a.Get_Data(t,n)}catch(e){console.error("Get_Data"),console.error(e)}(a.RequireInitFrm&&a.InitFrm(!0),"00"==n.ActNo&&a.Resp?.outpar._frmNote)&&(JSON.parse(a.Resp?.outpar._frmNote).forEach((t=>{var n=e('[np-frmnote="frmnote'+t.Seq+'"]',i);1==n.length&&(n.attr("data-intro",t.Note).attr("data-title",t.Seq),"1"==n.attr("np-frmnote-modal")?(n.addClass("np-frmnote-modal"),n.attr("title",t.Note),t.Note||n.addClass("np-notes-hide")):n.html(t.Note))})),e("[np-frmnote]",i).each(((t,n)=>{var a=e(n),o=a.attr("np-frmnote").split("frmnote");o[1]&&!a.attr("data-title")&&(a.attr("data-title",o[1]),a.attr("data-intro"," "),"1"==a.attr("np-frmnote-modal")&&(a.addClass("np-frmnote-modal"),a.addClass("np-notes-hide")))})),i.off("click",".np-frmnote-modal"),i.on("click",".np-frmnote-modal",((t,n)=>{var o=e(t.currentTarget);if(!o.hasClass("np-notes-readytoselect")){var i=o.attr("title");return a.Message({text:i,title:" "}),!1}})));o.ParentCmp&&!a.WebBusy&&0==a.ReadyCallBack_cnt&&(++a.ReadyCallBack_cnt,a._trigger("ReadyCallBack",null,{cnt:a.ReadyCallBack_cnt})),o.ReturnActParam&&a._trigger("AfterAct",null,o.ReturnActParam),n.AfterAct&&n.AfterAct(n.ErLen)},IntroHelp:function(e){var t,n=this;n.options;if(n.parsedHelpJson){if(n.parsedHelpJson.forEach((e=>{e.mode==n.ModeCode&&(t=e.h)})),!t)return;for(var a=0;a<t.length;a++)t[a].gid&&(t[a].element="#"+n.MakeFullId(t[a].gid)),e?(t[a].hint=t[a].intro,t[a].hintPosition=t[a].position):t[a].position=t[a].position}n.intro||(n.intro=introJs());try{n.intro.onexit((()=>{n.W_.$dvfrmFooter.css({position:"sticky"})})),n.intro.onskip((()=>{n.W_.$dvfrmFooter.css({position:"sticky"})})),n.intro.onstart((()=>{n.W_.$dvfrmFooter.css({position:"static"})}))}catch(e){}n.intro.setOptions({nextLabel:"بعدی",prevLabel:"قبلی",doneLabel:"پایان",hintButtonLabel:"بستن"}),e?n.intro.setOptions({hints:t}):n.intro.setOptions({steps:t}),e?n.intro.addHints():n.intro.start()},ClearRespmsg:function(){var e=this,n=e.options;n.ParentCmp?n.ParentCmp.ClearRespmsg():n.HideFooter?n.OpenerSelf.ClearRespmsg():(e.W_.ClearShowErrorBox_TimeOut&&(t.noNg((()=>clearTimeout(e.W_.ClearShowErrorBox_TimeOut))),e.W_.ClearShowErrorBox_TimeOut=null),e.GetngData()?.AngularTab?.clearRespmsg&&t.byNg((()=>e.GetngData().AngularTab.clearRespmsg())),n.OpenInline&&n.OpenerSelf.GetngData()?.AngularTab?.clearRespmsg&&t.byNg((()=>n.OpenerSelf.GetngData().AngularTab.clearRespmsg())))},SetRespmsg:function(n){var a,o=this,i=o.options;if(i.ParentCmp)return a=i.ParentCmp.SetRespmsg(n),o.ErLen=a?.ErLen,o.WarLen=a?.WarLen,a;if(i.HideFooter)return a=i.OpenerSelf.SetRespmsg(n),o.ErLen=a?.ErLen,o.WarLen=a?.WarLen,a;return o.ErLen=0,o.WarLen=0,e.each(n.c,(function(t,n){"0"!=n.m[0].e&&0,e.each(n.m,(function(e,t){o.ErLen+="2"==t.e?1:0,o.WarLen+="1"==t.e?1:0;var n=t.m.indexOf("::");n>0&&(t.m=t.m.substring(0,n))}))})),o.GetngData()?.AngularTab?.setRespmsg?t.byNg((()=>o.GetngData().AngularTab.setRespmsg(n))):i.OpenInline&&i.OpenerSelf.GetngData()?.AngularTab?.setRespmsg&&t.byNg((()=>i.OpenerSelf.GetngData().AngularTab.setRespmsg(n))),{ErLen:o.ErLen,WarLen:o.WarLen}},DoActServer:function(n,a,o){var i=this,r=i.options;i.element;if(!(o=o||{}).NoAuth){var l=o.AutoComplete&&r.CmpId+"_"+n,s=i.IsWebBusy(),d=i.RunDoActInQueueCnt(),p="00"==n||o.RunInQueue||d||o.AutoComplete&&i.IsWebBusy(l)||o.AutoComplete&&!s;if(i.IsFreezServer()&&(p=!1),s&&!p)return i.SetRespmsg({c:[{m:[{e:"1",m:"لطفا صبر کنید"}]}]}),i.W_.ClearShowErrorBox_TimeOut=t.noNg((()=>setTimeout((function(){i.W_&&i.ClearRespmsg()}),3e3))),!1}function c(l,s,p){var c;if(!i.W_)return l(p),!1;i.$ValidXml.r.acts["act"+n]&&(c=i.$ValidXml.r.acts["act"+n].help),c&&"1"==c&&(o.IsHelp=!0),s||d||o.NoAuth||i.ClearRespmsg(),i.ActNo=n,"00"==n&&i._XML2ViewModel(r.inxml,{inxml:!0}),i._Init_SndXML({CmpId:r.CmpId,AnotherSvc:o.AnotherSvc});const u=i._ViewModel2XML(n,o);if(i._SndXML.r.MaxHlpMaxHlp&&(i._SndXML.MaxHlp=i._SndXML.r.MaxHlpMaxHlp,delete i._SndXML.r.MaxHlpMaxHlp),!u)return o.AutoComplete&&o.Get_Data_AC&&o.Get_Data_AC(),l(p),!1;if(r.ParentCmp&&!i.$ValidXml.r.NoAuth&&(i.WebBusy=!0),!o.AnotherSvc){i.NPGen&&i.NPGen.ver;0!==r.fname.indexOf("/frmc/")?i.url=t.apiUrl+r.fname+".svc/":i.url=t.apiUrl+r.fname+""}var m,f,h;function g(e){for(var t=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){for(var o=n[a];" "==o.charAt(0);)o=o.substring(1);if(-1!=o.indexOf(t))return o.substring(t.length,o.length)}return null}i.$ValidXml.r.NoAuth&&((f=g("Unvno"))&&(i._SndXML.Unvno=f),(h=g("Hasbranch"))&&(i._SndXML.Hasbranch=h)),i.$ValidXml.r.NoAuth&&e.each(i._SndXML.r,(function(e,t){0==t.toString().indexOf("<r><row")&&delete i._SndXML.r[e]})),m=JSON.stringify(i._SndXML);var C=i.$ValidXml.r.NoAuth?"GET":"POST",v=i.$ValidXml.r.NoAuth?""+m.replace(/\$/g,"$0").replace(/\:/g,"$1").replace(/\//g,"$2").replace(/\\/g,"$3").replace(/\*/g,"$4").replace(/\?/g,"$5").replace(/\"/g,"$6").replace(/\</g,"$7").replace(/\>/g,"$8").replace(/\|/g,"$9").replace(/\%/g,"$a"):"",b=i.url+v,_={type:C,xhrFields:{withCredentials:!0},url:b,dataType:"json",contentType:"application/json; charset=utf-8",processData:!1,async:!0,data:m,beforeSend:function(e,t){e.setRequestHeader("ngsw-bypass","true")}};if(i.$ValidXml.r.NoAuth&&delete _.data,_.complete=function(e,s){if(i.W_){if(r.ParentCmp&&(i.WebBusy=!1),"success"==s){if(i.Resp=null,"GET"==C){var d=t.utils.ResponseCache(b);d.responseText=e.responseText,d.ready||(d.ready=!0,d.callback.forEach((t=>{t(e.responseText)})),d.callback=[])}i.Resp=JSON.parse(e.responseText),i.GetngData().AngularTab?.doActResp(i.Resp),i.SetRespmsg(i.Resp.msg),o=o||{},i.ActNo=o.ActNo=n,o.ErLen=i.ErLen,o.WarLen=i.WarLen,o.UserLvl=r.UserLvl??0,o.Usrfrm=r.Usrfrm??0,0==i.UserLvl&&(i.UserLvl=o.UserLvl),i.SetAutByResp(i.Resp),i.RunDoActInQueueCnt("inc"),t.noNg((()=>i.Get_Data_Core(a,o))),i.RunDoActInQueueCnt("dec")}else o.AutoComplete&&o.Get_Data_AC&&t.noNg((()=>o.Get_Data_AC()));var c;l(p),"success"==s&&"00"==n&&r.inxml&&r.inxml.doact&&(c=r.inxml.doact.act)&&t.noNg((()=>i.DoAct(c,null,{RunInQueue:!0})))}},_.error=function(e,t,n){if(i.W_)if("rejected"==e.state()){t=e.responseText||"";i.Message({type:"alert",text:t,title:"خطا رد درخواست"})}else this._errMsg=e.responseText,alert("this._errMsg"),alert(this._errMsg)},"GET"==C){var F=t.utils.ResponseCache(b);if(F){if(F.ready){var w=F.responseText;return void t.noNg((()=>setTimeout((function(){_.complete({responseText:w},"success")}),0)))}return void F.callback.push((e=>{_.complete({responseText:e},"success")}))}t.utils.ResponseCache(b,{ready:!1,callback:[],responseText:""})}t.noNg((()=>e.ajax(_)))}if(o.NoAuth)return c(e.noop,!1),!0;var u={Key:l};return u.OpenWaitingDialog=o.AutoComplete?{NoText:!0,NoDisable:!0,NoOverlay:!0}:{NoOverlay:!0},p&&s?(u.Key||(u.Key=n),i.QueueAct(c,u),!0):i.ImmedAct(c,u)},DecodeDfi:function(){this.DoAct("DF",null,{RunInQueue:!0})},CanDoAct:function(e,t){var n=this,a=n.IsWebBusy(),o=n.RunDoActInQueueCnt(),i="00"==e||t.RunInQueue||o||t.AutoComplete&&n.IsWebBusy(ACKey)||t.AutoComplete&&!a;return!(a&&!i)},DoActClient:function(e,t){var n=this;return n.CanDoAct(e,t)?0==n.CheckValAct(e)?0:(n.CalcModeCode(e,0),1):0},DoAct:function(t,n,a){var o=this;if(a=a||{},o.$ValidXml&&o.W_)return o.$ValidXml.r.acts["act"+t]?(a.MethodType=o.$ValidXml.r.acts["act"+t].MethodType,a.MethodType&&"1"!=a.MethodType?(a.myEvent=n,Ret=o.DoActClient(t,a)):(Ret=o.DoActServer(t,n,a),GlobViewModel.MsgSelf&&e.now()-GlobViewModel.LastMsgFormCalled>3e5&&GlobViewModel.MsgSelf.ReloadMessages(),GlobViewModel.LastMsgFormCalled=e.now()),Ret):void 0},SetModeCode:function(e){var t=this;return t.ModeCode=e,t.ModeCode&&(t.ModeCodeJSON=t.$ValidXml.r.modes["mod"+t.ModeCode],t.ModeCodeJSON||alert("mode "+t.ModeCode+" is not declared")),e},CalcModeCode:function(n,a){var o=this,i=o.options;if("00"==n&&i.npMode)return o.SetModeCode(i.npMode),o.ModeCode;if(0!=a&&"00"!=n)return o.ModeCode;var r=o.$ValidXml.r.acts;r||alert("acts was not declared");var l=r["act"+n];l||alert("act"+n+" was not declared");var s=l.NexMod;return s?(o.ModeCode="",selfAntiUgly=o,e.each(s,(function(e,n){var a=n.cond,i=n.condId;if(i&&o["Cond"+i]){if(o["Cond"+i]())return o.ModeCode=n.mod,!1}else if(""==a||(a="var self=selfAntiUgly;"+a)&&t.utils.eval(a))return o.ModeCode=n.mod,!1})),o.ModeCode=o.SetModeCode(o.ModeCode),o.ModeCode):o.ModeCode?o.ModeCode:void 0},CalcCheckValModeCode:function(n){var a,o=this,i=o.$ValidXml.r.acts["act"+n].ChkMod;if(i)return selfAntiUgly=o,e.each(i,(function(e,n){var i=n.cond,r=n.condId;if(r&&o["Cond"+r]){if(o["Cond"+r]())return a=n.mod,!1}else if(""==i||(i="var self=selfAntiUgly;"+i)&&t.utils.eval(i))return a=n.mod,!1})),a},_GetLabelOfElem:function(t){var n=this,a=n.W_.FrmFld[t].Elem;if(a){if(""!==n.W_.FrmFld[t].LabelOfElem&&!n.W_.FrmFld[t].LabelOfElem){var o=n.W_.FrmFld[t].Valid.LabelId;if(o){if("0"!=o)return n.W_.FrmFld[t].LabelOfElem=n.$np("#"+o)}else{var i,r=a.prop("tagName")||"";r=r.toUpperCase(),["TABLE","TR","TD"].indexOf(r)>-1?i="":((i=a.next("label")).length||(i=e("label",a.parent())),i.length>1&&(i=e(i[0]))),n.W_.FrmFld[t].LabelOfElem=i}}return n.W_.FrmFld[t].LabelOfElem}},_RemoveReqStar:function(t,n){var a=this;if("1"!=a.$ValidXml.r.NoReqStar&&!a.W_.FrmFld[t].Valid.NoReqStar){var o=a.W_.FrmFld[t].Elem;if(a.W_.FrmFld[t].LabelElemCmp&&"1"!=a.W_.FrmFld[t].LabelElemCmp){var i=a.W_.FrmFld[t].LabelElemCmp.text().replace(/\*/g,"");a.W_.FrmFld[t].LabelElemCmp.text(i)}else if(a.W_.FrmFld[t].IsgroupInput||(a.W_.FrmFld[t].IsgroupInput=o.hasClass("groupInput")?"1":"0"),"1"!=a.W_.FrmFld[t].IsgroupInput)if(a.W_.FrmFld[t].Type2&&"MS"==a.W_.FrmFld[t].Type2)o.npAutoComplete("Require",!1);else if("Htm"!=n)if("SHtm"!=n){var r=a.W_.FrmFld[t].ElemReqStar;r&&r.hide()}else o.npeditor("Require",!1);else o.each((function(t,n){e.data(n,"cleditor").NpSetReq(!1)}));else{var l=a._GetLabelOfElem(t);if(!l)return;i=l.text().replace(/\*/g,"");l.text(i)}}},_AddReqStar:function(t,n){var a=this;if("1"!=a.$ValidXml.r.NoReqStar&&!a.W_.FrmFld[t].Valid.NoReqStar){var o=a.W_.FrmFld[t].Elem;if(a.W_.FrmFld[t].LabelElemCmp||(a.W_.FrmFld[t].LabelElemCmp=o.data("LabelElemCmp")||"1"),"1"==a.W_.FrmFld[t].LabelElemCmp)if(a.W_.FrmFld[t].IsgroupInput||(a.W_.FrmFld[t].IsgroupInput=o.hasClass("groupInput")?"1":"0"),"1"!=a.W_.FrmFld[t].IsgroupInput)if(a.W_.FrmFld[t].Type2&&"MS"==a.W_.FrmFld[t].Type2)o.npAutoComplete("Require",!0);else if("Htm"!=n)if("SHtm"!=n){var i=a.W_.FrmFld[t].ElemReqPar,r=a.W_.FrmFld[t].ElemReqStar;if(a.W_.FrmFld[t].ElemReqIsLabel||(a.W_.FrmFld[t].ElemReqIsLabel=o.is("label")?"1":"0"),"1"!=a.W_.FrmFld[t].ElemReqIsLabel)if(i)r.css("display","inline-block");else if(a.W_.FrmFld[t].Valid.IsAC&&!a.W_.FrmFld[t].Valid.MSAutoC)i=a.W_.FrmFld[t].ElemReqPar=o.parent().wrap('<SPAN class="npRquire col-12" style="width:100%;white-space:nowrap;display:block"></SPAN>'),r=a.W_.FrmFld[t].ElemReqStar=e('<SPAN class="npRquire" style="position:absolute;white-space:nowrap;display:inline-block;top:0px;left:-7px/*loat:right*/">*</SPAN>').appendTo(i.parent());else{o=o.add(e("label",o.parent())),i=a.W_.FrmFld[t].ElemReqPar=o.wrapAll('<SPAN class="npRquire col-12" style="width:100%;white-space:nowrap"></SPAN>').parent(),r=a.W_.FrmFld[t].ElemReqStar=e('<SPAN class="npRquire" style="white-space:nowrap">*</SPAN>').appendTo(i)}}else o.npeditor("Require",!0);else o.each((function(t,n){e.data(n,"cleditor").NpSetReq(!0)}));else{var l=a._GetLabelOfElem(t);if(!l)return;(s=l.text().replace(/\*/g,""))&&l.text(s+"*")}else{var s=a.W_.FrmFld[t].LabelElemCmp.text().replace(/\*/g,"");a.W_.FrmFld[t].LabelElemCmp.text(s+"*")}}},EnableField:function(t,n,a){var o,i,r,l,s,d=this;if(Array.isArray(t))e(t).each((function(e,t){d.EnableField(t,n,a)}));else if(o=d.W_.FrmFld[t].Elem){var p=o.prop("tagName")||"",c=d.W_.FrmFld[t];return r=c.Help,l=c.Req,s=c.Valid.Typ,c.LastEnable=n,c.LastReq=l,"BDO"==(p=p&&p.toUpperCase())&&e(o).attr("contenteditable",n),"Radio"==s&&d.ViewModel[t+"_Enable"](n),"DIV"==p?(l="0",o.hasClass("btn-group")&&("Radio"!=s&&(n?o.removeClass("np-state-readonly"):o.addClass("np-state-readonly")),n?e("input",o).removeAttr("disabled"):e("input",o).attr("disabled",!0),n?e("label.btn",o).removeClass("disabled"):e("label.btn",o).addClass("disabled"))):["FIELDSET","TABLE","TR","TD"].indexOf(p)>-1||("Htm"==s?o.each((function(t,a){e.data(a,"cleditor").disable(!n)})):"SHtm"==s?n?o.npeditor("enable"):o.npeditor("disable"):c.Valid.IsAC?n?o.npAutoComplete("enable"):o.npAutoComplete("disable"):o.is("input")||e(o).is("textarea")?(o.prop("readonly",!n),"checkbox"!=o[0].type&&"radio"!=o[0].type&&"text"!=o[0].type||o.prop("disabled",!n)):o.is("button")?o.toggleClass("ui-state-disabled",!n):o.is("select")?(o.prop("disabled",!n),o.attr("readonly",!n),o.toggleClass("np-select-readonly",!n),c.LastVal=d.ViewModel[t]()):(o.is("img")&&o.prop("src",o.prop("src").replace("_Focus.gif",".gif").replace("_Clicked.gif",".gif")),o.toggleClass("ui-state-disabled",!n).toggleClass("ui-button-disabled",!n),(o.is("a")||o.is("img"))&&(n?o.attr("disabled",!1):o.attr("disabled",!0)))),r&&d.W_.FrmFld[r]&&(i=d.W_.FrmFld[r].Elem)&&(d.W_.FrmFld[r].LastEnable=n,d.W_.FrmFld[r].LastReq="0",n?i.removeClass("ui-button-disabled").removeClass("ui-state-disabled").attr("disabled",!1):(i.blur().addClass("ui-button-disabled").addClass("ui-state-disabled").attr("disabled",!0),i.is("img")&&i.prop("src",i.prop("src").replace("_Focus.gif",".gif").replace("_Clicked.gif",".gif")))),n&&"0"!=l?"1"==l&&"Check"!=s&&d._AddReqStar(t,s):d._RemoveReqStar(t,s),"HLnk"!=s&&"BUTTON"!=p&&"LABEL"!=p||(n?o.removeClass("ui-button-disabled").removeClass("ui-state-disabled"):o.addClass("ui-button-disabled").addClass("ui-state-disabled")),o}},CreateHlpInOut_Act:function(){var t=this;e.each(t.$ValidXml.r.acts,(function(n,a){var o=n.substr(3,2);if(t.Acts["act"+o].HlpArrElem=[],a.hlpin&&a.hlpin.length){var i=[],r=[];e.each(a.hlpin,(function(e,n){var a=n;t.GetHlpIn(a,i,r,t.Acts["act"+o].HlpArrElem)}))}var l="",s="";a.relfield&&a.relfield.length&&e.each(a.relfield,(function(e,t){t.colD=t.colD||"",t.col=t.col||t.data||"",l+=",'"+t.id+"'",s+=",'"+(parseInt(t.colD||t.col)-1).toString()+"'"})),t.Acts["act"+o].rst=l.substr(1),t.Acts["act"+o].csq=s.substr(1)}))},CommitEnableF:function(){var t,n=this;e.each(n.W_.FrmFld,(function(a,o){"Cmp"==o.Valid.Typ?(o.WidgetSelf.ComponentReq=o.Req,o.WidgetSelf.EnableAllField=!!o.Enable,o.WidgetSelf.InitFrm_Core(),(t=o.LabelElemCmp)&&"1"!=t&&(n.Val(a)||!o.Enable||""!=e("input.ui-autocomplete-input",o.Elem).val()||e("input.ui-autocomplete-input",o.Elem)[0]===document.activeElement?t.addClass("groupInputFocus"):t.removeClass("groupInputFocus"))):(o.LastVal=n.ViewModel[a](),o.Enable==o.LastEnable&&o.Req==o.LastReq||n.EnableField(a,o.Enable),o.Valid.OnAC&&(t=n._GetLabelOfElem(a))&&(n.Val(a)||!o.Enable||""!=e(o.Elem).val()||e(o.Elem)[0]===document.activeElement?t.addClass("groupInputFocus"):t.removeClass("groupInputFocus")));if(o.Show!=o.LastShow&&null!=o.Show){o.LastShow=o.Show;var i=n._GetLabelOfElem(a),r=o.Elem;"SHtm"==o.Valid.Typ&&(r=r.parent()),"1"==o.Valid.VisibleType?(r&&r.css("visibility",o.Show?"visible":"hidden"),(t=o.LabelElemCmp)&&"1"!=t&&t.css("visibility",o.Show?"visible":"hidden"),i&&i.css("visibility",o.Show?"visible":"hidden")):(r&&r.css("display",o.Show?"":"none"),(t=o.LabelElemCmp)&&"1"!=t&&t.css("display",o.Show?"":"none"),i&&i.css("display",o.Show?"":"none"))}"1"==o.SetClear&&(o.SetClear=null,n.Val(a,""),void 0!==o.Valid.OnAC?n.ValDesc(a,""):"Cmp"==o.Valid.Typ&&o.WidgetSelf.Reset())})),n.W_.IMs&&e.each(n.W_.IMs,(function(t,a){if(a.Show){if(a.LastShow||e("#"+n.MakeFullId(t),n.W_.$dvfrmFooter).show(),a.Enable!=a.LastEnable)(n.NPGen?n.NPGen.ver:0)>303?(a.Enable||-1!=n.ViewModel.vm_DisableCommanderButtons.indexOf(t)||n.ViewModel.vm_DisableCommanderButtons.push(t),a.Enable&&n.ViewModel.vm_DisableCommanderButtons.remove(t)):e("#"+n.MakeFullId(t),n.W_.$dvfrmFooter).npButton(a.Enable?"enable":"disable");if(a.Text&&a.Text!=a.LastText&&e("#"+n.MakeFullId(t),n.W_.$dvfrmFooter).npButton("option","label",a.Text),a.Icon&&a.Icon!=a.LastIcon){var o={};o.primary=a.Icon,e("#"+n.MakeFullId(t),n.W_.$dvfrmFooter).npButton("option","icons",o)}a.LastEnable=a.Enable,a.LastText=a.Text,a.LastIcon=a.Icon}else a.LastShow&&e("#"+n.MakeFullId(t),n.W_.$dvfrmFooter).hide(),a.Enable=a.LastEnable,a.Text=a.LastText,a.Icon=a.LastIcon;a.LastShow=a.Show}))},SetFocusToFirst:function(e){this.W_.DontFocus=!e},InitFrm:function(e){var t=this;if(t.InitFrm_Core(),!(e||t.W_&&t.W_.DontFocus)){var n=t.SelectFirstElem();n&&n&&t.NPSetFocus(n,null,!0,!1)}},SelectFirstElem:function(){for(var t=this,n=null,a=t.$ValidXml.r.FirstElem,o=0,i=t.W_.FrmFld;a&&o<1e3;){var r=i[a];if(r&&r.Enable&&0!=r.Show){if(r.Valid&&"Cmp"==r.Valid.Typ)n=r.WidgetSelf.SelectFirstElem();else{var l=r.Elem?r.Elem.prop("tagName"):"";l&&["TABLE","TR","TD","DIV","SPAN","LABEL","A"].indexOf(l)<0&&r.Elem.is(":visible")&&(n=t.MakeFullId(a))}if(n)return n}a=r&&r.Valid&&r.Valid.Nex,o++}return n||e.each(i,(function(e,a){if(a.Enable&&0!=a.Show){if(a.Valid&&"Cmp"==a.Valid.Typ)n=a.WidgetSelf.SelectFirstElem();else{var o=a.Elem?a.Elem.prop("tagName"):"";(o=o&&o.toUpperCase())&&["TABLE","TR","TD","DIV","SPAN","LABEL","A"].indexOf(o)<0&&a.Elem.is(":visible")&&(n=t.MakeFullId(e))}if(n)return!1}})),n},InitFrm_Core:function(n){var a=this,o=a.options;a.RequireInitFrm=!1;var i,r,l,s=a.ComponentReq,d=n&&n.CheckValModeCodeJSON;if(i=d||a.ModeCodeJSON){r=i.defSH,l=i.defDE,a.CreateHlpInOut_Act(),e.each(a.W_.FrmFld,(function(e,t){var n=t.Valid.Req||"0";d?t.Valid.ValidExc||(t.CheckValEnable="0"!=l,t.CheckValReq=s&&"0"==s?"0":n):(t.Valid.ValidExc||(t.Req=s&&"0"==s?"0":n,t.Enable="0"!=l,t.Help&&a.W_.FrmFld[t.Help]&&(a.W_.FrmFld[t.Help].Enable="0"!=l)),!o.ParentCmp||a.EnableAllField||t.Valid.ValidExc||(t.Enable=!1),t.Show=" "==r?null:"0"!=r,t.SetClear=null,t.DisAC=null)}));var p=a.W_.FrmFld;selfAntiUgly=a,i.Cond&&e.each(i.Cond,(function(n,i){var r=i.if,l=i.ifJsId;(l&&a["Cond"+l]&&a["Cond"+l]()||(!l||!a["Cond"+l])&&(""==r||(r="var self=selfAntiUgly;"+r)&&t.utils.eval(r)))&&e.each(i,(function(t,n){(!o.ParentCmp||a.EnableAllField)&&"ExcDis"==t&&e.each(n,(function(e){var t=p[e];if(!t.Valid.ValidExc){if(d)return void(t.CheckValEnable=!1);t.Enable=!1,t.Help&&p[t.Help]&&(p[t.Help].Enable=!1)}})),(!o.ParentCmp||a.EnableAllField)&&"ExcEna"==t&&e.each(n,(function(e){var t=p[e];if(!t.Valid.ValidExc){if(d)return void(t.CheckValEnable=!0);t.Enable=!0,t.Help&&p[t.Help]&&(p[t.Help].Enable=!0)}})),"ExcHide"==t&&e.each(n,(function(e){var t=p[e];d?t.Valid.ValidExc||(t.CheckValEnable=!1):t.Show=!1})),"ExcShow"==t&&e.each(n,(function(e){var t=p[e];d||(t.Show=!0)})),"ExcNReq"==t&&e.each(n,(function(e){var t=p[e];if(!t.Valid.ValidExc){if(d&&!t.Valid.ValidExc)return void(t.CheckValReq="0");t.Req="0"}})),(!s||"1"==s)&&"ExcReq"==t&&e.each(n,(function(e){var t=p[e];if(!t.Valid.ValidExc){if(d)return void(t.CheckValReq="1");t.Req="1"}})),"ExcClear"==t&&e.each(n,(function(e){var t=p[e];d||(t.SetClear="1")}))}))})),!d&&e.each(a.W_.FrmFld_StateNo,(function(e,t){var n=t.Valid.StateNo;if(e&&n&&!isNaN(n)){n=parseInt(n)-1;var o=a.CmpStateVal[n];o&&"3"==o&&(a.W_.FrmFld[e].Show=!1),o&&"4"==o&&(a.W_.FrmFld[e].Show=!0)}})),e.each(a.W_.FrmFld_Grd,(function(t,n){if("Grd"==n.Valid.Typ){var o,i,r=n.Valid.Switch;r&&(o=a.Val(r)),o&&e.each(n.Valid.mode,(function(e,t){t.id==o&&(i=t.DisableF)})),i&&e.each(i.split(","),(function(e,t){if(""!=t){var n=p[t];if(d)return void(n.CheckValEnable=!1);n.Enable=!1,n.Help&&(a.W_.FrmFld[n.Help].Enable=!1)}}))}})),!d&&e.each(a.W_.FrmFld_StateNo,(function(e,t){var n=t.Valid.StateNo;if(e&&n&&!isNaN(n)){n=parseInt(n)-1;var o=a.CmpStateVal[n];o&&"1"==o&&(a.W_.FrmFld[e].Enable=!1),o&&"2"==o&&(a.W_.FrmFld[e].Enable=!0),o&&"5"==o&&(a.W_.FrmFld[e].Req="1"),o&&"5"!=o&&(a.W_.FrmFld[e].Req=a.W_.FrmFld[e].Valid.Req)}})),d||(a.W_.IMs&&(e.each(a.W_.IMs,(function(e,t){t.Show=!1})),selfAntiUgly=a,i.imgCond&&e.each(i.imgCond,(function(n,o){var i=o.if,r=o.ifJsId;(r&&a["Cond"+r]&&a["Cond"+r]()||(!r||!a["Cond"+r])&&(""==i||(i="var self=selfAntiUgly;"+i)&&t.utils.eval(i)))&&e.each(o,(function(e,t){"if"!=e&&a.W_.IMs[e]&&(a.W_.IMs[e].Show=!0,t.Hidden&&(a.W_.IMs[e].Show=!1),a.W_.IMs[e].Enable="2"==t.Enable,a.W_.IMs[e].Text=t.text,a.W_.IMs[e].Icon=t.icon,a.W_.IMs[e].actno=t.actno)}))}))),o.ParentCmp||a._UpdateCommanderButtons(),a.CommitEnableF(),o.ParentCmp||"10700"==o.CmpId||a.dvfrmCenterHeight())}},dvfrmCenterHeight:function(){},FMod_Changed:function(){var e=this;e.MChanger?e.FMod=e.ViewModel[e.MChanger]():e.FMod=0,e.CalcModeCode("00",0),e.InitFrm(),e.ResizeHandler()},Get$dvfrmCenter:function(){return this.W_.$dvfrmCenter},Get$bod:function(){var e=this.options;return e.ParentCmp?e.ParentCmp.Get$bod():e.OpenerSelf&&e.OpenInDialog?e.OpenerSelf.Get$bod():this.W_.$bod},parent$bod:function(){this.options;return this.Get$bod().parent()},GetWaitDialogParent:function(){var e=this.options;return e.ParentCmp?e.ParentCmp.GetWaitDialogParent():e.OpenerSelf&&e.OpenInDialog?e.OpenerSelf.GetWaitDialogParent():this.WaitDialogParent},GetParentCmp:function(){var e=this.options;return e.ParentCmp?e.ParentCmp.GetParentCmp():e.OpenerSelf&&e.OpenInDialog?e.OpenerSelf.GetParentCmp():this},Get_Data:function(t,n){n=n||{};var a=this,o=(a.element,a.options),i=n.IsHelp;if(a.Resp&&a.Resp.oaut&&a.Resp.oaut.oa&&a.Resp.oaut.oa.time&&GlobViewModel.vm_Time(a.Resp.oaut.oa.time),"00"!=n.ActNo||o.IsCmp||(e("div.hideDvfrmCenter",a.W_.$bod).removeClass("hideDvfrmCenter").css("visibility","visible"),a.W_.$dvfrmCenter.css("overflow","")),null!==t&&"object"==typeof t&&(t=t&&t.currentTarget&&t.currentTarget.id?t.currentTarget.id:""),!t&&n.HelpId&&(t=n.HelpId),!n.NoAct00){var r=a.ModeCode;if(a.CalcModeCode(n.ActNo,a.ErLen),a._XML2ViewModel(a.Resp),a.CalcModeCode(n.ActNo,a.ErLen)){if(a.InitFrm("00"!=a.ActNo&&r==a.ModeCode),"00"==a.ActNo&&a.ResizeHandler(),n&&n.AutoComplete)n.Get_Data_AC&&n.Get_Data_AC(a._Grd[0]);else if(i){if(0==a.ErLen){var l;t&&((l=a.W_.FrmFld[a.MakeOrgId(t)].Valid).KCol=a._Grd[0].KCol||l.KCol,l.TipCol=a._Grd[0].TipCol||l.TipCol,l.id=a.MakeOrgId(t),l.MoreGridOnRowClickSelf=n.MoreGridOnRowClickSelf);var s=null,d=null;if(!a.W_.IsInMobile&&a.W_.HelpDialogs["ACT"+n.ActNo]&&a.W_.HelpDialogs["ACT"+n.ActNo].data("npgrdstruc")!=a._Grd[0].struc){var p=a.W_.HelpDialogs["ACT"+n.ActNo].npUiDialog("widget");s=p.css("top"),d=p.css("left"),a.W_.HelpDialogs["ACT"+n.ActNo].npUiDialog("close")}if(a.W_.HelpDialogs["ACT"+n.ActNo]){var c=a.W_.HelpGrids["ACT"+n.ActNo].npgrid("instance")._vm.Cols(),u=a._Grd[0].titrow&&a._Grd[0].titrow.IDNUMBERCOL;if(isNaN(u)||u==c.length)return a.W_.HelpGrids["ACT"+n.ActNo].npgrid("refresh",a._Grd[0].dat),a.W_.HelpGrids["ACT"+n.ActNo].npgrid("option","MaxRow",a._Grd[0].MaxRow),a.W_.HelpGrids["ACT"+n.ActNo].npgrid("option","UpDat",a._Grd[0].UpDat),a.W_.HelpGrids["ACT"+n.ActNo].npgrid("option","HideHeader",a._Grd[0].HideHeader),a.W_.HelpGrids["ACT"+n.ActNo].npgrid("option","HideFooter",a._Grd[0].HideFooter),a.W_.HelpGrids["ACT"+n.ActNo].npgrid("option","HideGrid",a._Grd[0].HideGrid),a.W_.HelpGrids["ACT"+n.ActNo].npgrid("option","Height",a._Grd[0].Height),a.W_.HelpGrids["ACT"+n.ActNo].npgrid("option","NoRowColor1",a._Grd[0].NoRowColor1),a.W_.HelpGrids["ACT"+n.ActNo].npgrid("option","NoRowColor2",a._Grd[0].NoRowColor2),a.W_.HelpGrids["ACT"+n.ActNo].npgrid("option","NoRowColor3",a._Grd[0].NoRowColor3),a.W_.IsInMobile?a.W_.HelpDialogs["ACT"+n.ActNo].SimpleDialog("option","title",a._Grd[0].tit):(a.W_.HelpDialogs["ACT"+n.ActNo].npUiDialog("option","title",a._Grd[0].tit).npUiDialog("SetZIndex"),a.W_.HelpDialogs["ACT"+n.ActNo].npUiDialog("SetZIndex").npUiDialog("fixTitle")),void(a._Grd=[]);!a.W_.IsInMobile&&a.W_.HelpDialogs["ACT"+n.ActNo].npUiDialog("close"),a.W_.IsInMobile&&a.W_.HelpDialogs["ACT"+n.ActNo].SimpleDialog("close")}a.W_.HelpDialogs["ACT"+n.ActNo]=e("<div />");var m,f=1;if(n.MSAutoC_npform){f=0,a._Grd[0].col='<col width = "45px">'+a._Grd[0].col,a._Grd[0].th="<tr><th>انتخاب</th>"+a._Grd[0].th.substr(4),a._Grd[0].ColAttr.CheckBox0="0"==n.SingleS_npform?"1":"2";var h=l.KCol||"C1,C2";-1==h.indexOf(",")&&(h="C1,C2"),h=h.split(",");var g=l.TipCol,C=h[0].split("C")[1],v=h[1].split("C")[1],b=g?g.split("C")[1]:C;m=function(e,t){}}a.W_.HelpGrids["ACT"+n.ActNo]=e("<table><colgroup>"+a._Grd[0].col+"</colgroup><thead>"+a._Grd[0].th+"</thead><tbody><tr><td>&nbsp;</td></tr></tbody></table>").appendTo(a.Get$bod().parent());var _=a._Grd[0].dat,F=n.term||"";if("1"==n.SAC&&""!=F){n.SCol=n.SCol||"C1,C2";var w=n.SCol.split(","),y=e("row",_).filter((function(){if("%"==n.term)return!0;var t=!1,a=this;return e.each(w,(function(o,i){if((e(a).attr(i)||"").toLowerCase().indexOf(n.term.toLowerCase())>-1)return t=!0,!1})),t}));_=e("<dat/>").append(y)}var S={CheckBox_Index_VAL:C,CheckBox_Index_DSC:v,CheckBox_Index_TIP:b,CheckBox_MS:n.MSAutoC_npform,CheckBox_SS:n.SingleS_npform,DoActParams:n,npform:a,ActNo:n.ActNo,MaxRow:a._Grd[0].MaxRow,HideHeader:a._Grd[0].HideHeader,HideFooter:a._Grd[0].HideFooter,HideGrid:a._Grd[0].HideGrid,UpDat:a._Grd[0].UpDat,InXML:_,GridCursor:"pointer",ColFirstNo:f,RowNodeName:"row",ColPrefix:"C",NewDesign:"1",width:e(window).width()/2,height:a._Grd[0].Height?a._Grd[0].Height:e(window).height()/2,DefaultCloseDialog:!0,DefaultNoRadif:!0,HelpDialog:a.W_.HelpDialogs["ACT"+n.ActNo],ColAttr:a._Grd[0].ColAttr,jsonstruc:a._Grd[0].jsonstruc,AftFilRowInternal:m,AdvSearchParams:n.AdvSearchParams,FullScreenable:0,NoRowColor1:a._Grd[0].NoRowColor1,NoRowColor2:a._Grd[0].NoRowColor2,NoRowColor3:a._Grd[0].NoRowColor3};if((a.W_.IsInMobile||n.fullscreenHelp)&&(S.width=e(window).width()),(l=l||{}).NoPaging=a._Grd[0].titrow.NoPaging||l.NoPaging,l.LinePerPage=a._Grd[0].titrow.LinePerPage||l.LinePerPage||"10",a.CreateNPGrid(l,S,a.W_.HelpGrids["ACT"+n.ActNo]),a.Get$bod().parent().removeClass("d-flex"),a.W_.HelpDialogs["ACT"+n.ActNo].data("npgrdstruc",a._Grd[0].struc).addClass("np-dialog-nopad-noscroll").appendTo(a.Get$bod().parent()).append(a.W_.HelpGrids["ACT"+n.ActNo].npgrid("Container")),a.W_.IsInMobile)a.W_.HelpDialogs["ACT"+n.ActNo].SimpleDialog({title:a._Grd[0].tit,appendTo:a.Get$bod().parent(),close:function(){a.W_.HelpGrids["ACT"+n.ActNo]&&a.W_.HelpGrids["ACT"+n.ActNo].remove(),delete a.W_.HelpGrids["ACT"+n.ActNo],a.W_.HelpDialogs["ACT"+n.ActNo]&&a.W_.HelpDialogs["ACT"+n.ActNo].remove(),delete a.W_.HelpDialogs["ACT"+n.ActNo]}}),a.W_.HelpDialogs["ACT"+n.ActNo].SimpleDialog("show");else{a.W_.HelpDialogs["ACT"+n.ActNo].npUiDialog({appendTo:a.Get$bod().parent(),width:e(a.W_.HelpGrids["ACT"+n.ActNo].npgrid("Container")).outerWidth(!0)+7,title:a._Grd[0].tit,IsHelp:!0,beforeClose:function(){},open:function(){},close:function(){a.W_.HelpGrids["ACT"+n.ActNo]&&a.W_.HelpGrids["ACT"+n.ActNo].remove(),delete a.W_.HelpGrids["ACT"+n.ActNo],a.W_.HelpDialogs["ACT"+n.ActNo]&&a.W_.HelpDialogs["ACT"+n.ActNo].remove(),delete a.W_.HelpDialogs["ACT"+n.ActNo]},resize:function(t,o){var i=e(this).parent(),r=e(".ui-dialog-titlebar",i)?e(".ui-dialog-titlebar",i).outerHeight():30,l=o.size.height-r,s=o.size.width;a.W_.HelpGrids["ACT"+n.ActNo].npgrid("option","width",s).npgrid("option","height",l).npgrid("ReCalcDim",s,l)}});var A=a.W_.HelpDialogs["ACT"+n.ActNo].npUiDialog("widget");d&&(A.css("top",s),A.css("left",d)),"1"!=a._Grd[0].HideGrid&&"1"!=a._Grd[0].HideFooter&&"1"!=a._Grd[0].HideHeader||a.W_.HelpDialogs["ACT"+n.ActNo].npUiDialog("option",{minHeight:0,contentMarginBottom:"10px"})}a.Get$bod().parent().addClass("d-flex")}}else a._Grd.length>0&&e(a._Grd).each((function(t,n){var o,i,r=e("#"+a.MakeFullId(n.id));if(r.length>0)if(n.struc&&n.struc!=r.data("npgrdstruc")){r.npgrid("destroy").hide().html("<colgroup>"+n.col+"</colgroup><thead>"+n.th+"</thead>"),r.data("npgrdstruc",n.struc);var l=a.W_.FrmFld[n.id],s=l.Valid;l.WidgetElem=null;var d,p,c,u={RowNodeName:"row",ColPrefix:"C",ColFirstNo:1,InXML:n.dat,ColAttr:n.ColAttr,jsonstruc:n.jsonstruc,npform:a,DefaultNoRadif:!0,ActNo:s.Act,MaxRowId:s.MaxRowId,NoRowColor1:!(!s.NoRowColor1||"1"!=s.NoRowColor1),NoRowColor2:!(!s.NoRowColor2||"1"!=s.NoRowColor2),NoRowColor3:!(!s.NoRowColor3||"1"!=s.NoRowColor3),NoTdPadding:!(!s.NoTdPadding||"1"!=s.NoTdPadding),NoShowHeader:!(!s.NoShowHeader||"1"!=s.NoShowHeader)},m=null;if((d=s.Switch)&&((m=m||{}).Switch=d),l.Valid.mode&&e.each(l.Valid.mode,(function(e,t){(m=m||{}).All=m.All||[];var n=m.All[e]={};(p=t.id)&&(n.Mode=p),n.ModeXml=t,(c=t.DisableF)&&(n.DisableF=c.split(","))})),m&&(u.Modes=m),delete l.Valid.col,l.Valid.NoPaging=a._Grd[0].titrow.NoPaging||l.Valid.NoPaging,l.Valid.LinePerPage=a._Grd[0].titrow.LinePerPage||l.Valid.LinePerPage,a.CreateNPGrid(l.Valid,u,a.GetFldElem(n.id)),h=s.MaxRowId){var f=a.Val(h);r.npgrid("option","MaxRow",f)}}else{var h;if(r.npgrid("option","jsonstruc",n.jsonstruc),(o=r.npgrid("option","RId"))&&(i=a.Val(o)),r.npgrid("refresh",n.dat,i),h=a.W_.FrmFld[n.id].Valid.MaxRowId){f=a.Val(h);r.npgrid("option","MaxRow",f)}}}));a._Grd=[],a.$ValidXml.r.FindAfterInsert&&"09"==a.ActNo&&"2"==a.FMod&&0==a.ErLen&&(a.ViewModel[a.MChanger]("4"),a.DoAct("08"))}}},DisableFindAfterInsert:function(){this.$ValidXml.r.FindAfterInsert=!1},CloseHelpDialog:function(e){-1==e.indexOf("ACT")&&(e="ACT"+e),e&&this.W_.HelpDialogs[e]&&(!this.W_.IsInMobile&&this.W_.HelpDialogs[e].npUiDialog("close"),this.W_.IsInMobile&&this.W_.HelpDialogs[e].SimpleDialog("close"))},IsVisibleHelpDialog:function(e){return-1==e.indexOf("ACT")&&(e="ACT"+e),!!(e&&this.W_.HelpDialogs[e]&&this.W_.HelpDialogs[e].is(":visible"))},CloseAllHelpDialog:function(){var t=this;e.each(this.W_.HelpDialogs,(function(e,n){!t.W_.IsInMobile&&n.npUiDialog("close"),t.W_.IsInMobile&&n.SimpleDialog("close")}))},_XML2ViewModel:function(n,a){var o=this,i=o.options,r=a&&a.SetByMd;if(!!a&&a.NoAct00&&!o.RunResetBeforeForAct00){o.RunResetBeforeForAct00=!0,o.Reset(!0);var l=!0}if(n){var s=!!a&&a.SetInParam,d=!!a&&a.NoInternalChg_OnSubs;o.InternalChg_OnSubs=!d,n.rset&&n.rset.grd&&e.each(n.rset.grd,(function(t,n){var a;try{a=e("grd",e.parseXML('<?xml version="1.0" encoding="utf-8"?>'+n.xml))}catch(t){a=e("grd",e.parseXML('<?xml version="1.0" encoding="utf-8"?><grd/>'))}var i,r,l,s=a.attr("id"),d={},p=null,c=e("dat",a),u="",m="",f="",h={};n.struc?(r=JSON.parse(n.struc),h.IDTITLE=r.IDTITLE,h.NoPaging=r.NoPaging,h.LinePerPage=r.LinePerPage,h.KCol=r.KCol||r.KCOL,h.TipCol=r.TipCol||r.TIPCOL,h.IDNUMBERCOL=r.Cols.length,e.each(r.Cols,(function(e,t){var n=e+1;h["IDWIDTH"+n]=t.Width,h["IDCOLUMN"+n]=t.Caption||"",h["COLTOPTITLE"+n]=t.TopTitle,h["COLSPAN"+n]=t.ColSpan,h["ALIGN"+n]=t.Align,h["SHOWTAG"+n]=t.ShowTag,h["MULTILINE"+n]=t.Multiline,h["COLTYPE"+n]=t.ColType,h["DIR"+n]=t.Dir,h["FilterType"+n]=t.FilterType,h["SHOWLABEL"+n]=t.ShowLabel,h["ColMdWidth"+n]=t.ColMdWidth,h["ColXsWidth"+n]=t.ColXsWidth,h["NAME"+n]=t.Name,h["Hide"+n]=t.Hide,h["HideIfEmpty"+n]=t.HideIfEmpty,h["NexCol"+n]=t.NexCol,h["NexRow"+n]=t.NexRow,h["CB"+n]=t.CB,h["NOY"+n]=t.NOY,h["Typ"+n]=t.Typ,h["CurLang"+n]=t.CurLang,h["Fro"+n]=t.Fro,h["To"+n]=t.To,h["Max"+n]=t.Max,h["Min"+n]=t.Min,h["Lan"+n]=t.Lan,h["Fil"+n]=t.Fil,h["Jus"+n]=t.Jus,h["inputmode"+n]=t.inputmode}))):(l=e("tit>row",a)).length&&(l=l[0])&&e.each(l.attributes,(function(e,t){var n=t.name.toUpperCase();n=n.replace("HIDE","Hide").replace("KCOL","KCol").replace("TIPCOL","TipCol").replace("GRID","Grid").replace("FOOTER","Footer").replace("HEADER","Header").replace("NOPAGING","NoPaging").replace("LINEPERPAGE","LinePerPage"),h[n]=t.value}));try{p=h.IDTITLE;for(var g=0,C=1;C<=h.IDNUMBERCOL;C++){u+='<col width = "'+h["IDWIDTH"+C]+'px">';var v=h["COLSPAN"+C],b="",_=' rowspan="2"';v&&(b=' colspan="'+v+'"',g=parseInt(v),m+="<th"+b+">"+(h["COLTOPTITLE"+C]||h["IDCOLUMN"+C])+"</th>"),g>0?(_="",g--,f+="<th>"+h["IDCOLUMN"+C]+"</th>"):m+="<th"+_+b+">"+(h["COLTOPTITLE"+C]||h["IDCOLUMN"+C])+"</th>",(i=h["ALIGN"+C])&&(d["ALIGN"+C]=i,d["DIR"+C]="LEFT"==i.toUpperCase()?"ltr":"rtl"),(i=h["COLTYPE"+C])&&(d["COLTYPE"+C]=i),(i=h["SHOWTAG"+C])&&(d["SHOWTAG"+C]=i),(i=h["SHOWLABEL"+C])&&(d["SHOWLABEL"+C]=i),(i=h["ColMdWidth"+C])&&(d["ColMdWidth"+C]=i),(i=h["ColXsWidth"+C])&&(d["ColXsWidth"+C]=i),(i=h["MULTILINE"+C])&&(d["MULTILINE"+C]=i),(i=h["DIR"+C]||h["IDDIRECTION"+C])&&(d["DIR"+C]=i),(i=h["IDDIRECTION"+C])&&(d["NOLATIN"+C]="1"),(i=h["NAME"+C])&&(d["NAME"+C]=i),(i=h["Hide"+C])&&(d["Hide"+C]=i),(i=h["HideIfEmpty"+C])&&(d["HideIfEmpty"+C]=i),(i=h["FilterType"+C])&&(d["FilterType"+C]=i),(i=h["NexCol"+C])&&(d["NexCol"+C]=i),(i=h["NexRow"+C])&&(d["NexRow"+C]=i),(i=h["CB"+C])&&(d["CB"+C]=i),(i=h["NOY"+C])&&(d["NOY"+C]=i),(i=h["Typ"+C])&&(d["Typ"+C]=i),(i=h["CurLang"+C])&&(d["CurLang"+C]=i),(i=h["Fro"+C])&&(d["Fro"+C]=i),(i=h["To"+C])&&(d["To"+C]=i),(i=h["Max"+C])&&(d["Max"+C]=i),(i=h["Min"+C])&&(d["Min"+C]=i),(i=h["Lan"+C])&&(d["Lan"+C]=i),(i=h["Fil"+C])&&(d["Fil"+C]=i),(i=h["Jus"+C])&&(d["Jus"+C]=i),(i=h["inputmode"+C])&&(d["inputmode"+C]=i)}}catch(e){}m="<tr>"+m+"</tr>",f&&(f="<tr>"+f+"</tr>"),s&&r&&(o.W_.FrmFld[s]=o.W_.FrmFld[s]||{},o.W_.FrmFld[s].ColsValid=r.Cols),o._Grd.push({id:s,tit:p,col:u,th:m+f,dat:c,titrow:h,ColAttr:d,KCol:h.KCol||h.KCOL,struc:r?JSON.stringify(h):"",jsonstruc:r,TipCol:h.TipCol||h.TIPCOL,HideHeader:h.HideHeader,HideFooter:h.HideFooter,HideGrid:h.HideGrid,Height:h.HEIGHT,NoRowColor1:h.NOROWCOLOR1,NoRowColor2:h.NOROWCOLOR2,NoRowColor3:h.NOROWCOLOR3,MaxRow:a.attr("MaxRow"),UpDat:a.attr("UpDat")})})),n.rset&&n.rset.nopt&&e.each(n.rset.nopt,(function(n,a){var i=a,r=[],l=i.id;i.val;if(l){o.IsBindingInProgress=!0;try{o.ViewModel[l+t.OPTOPT].removeAll(),e.each(i.d,(function(t,n){var a={};e.each(n,(function(e,t){a[e]=t})),""===a.val&&""===a.dsc||r.push(a)}))}finally{o.ViewModel[l+t.OPTOPT]?o.ViewModel[l+t.OPTOPT](r):alert("رکوردست خروجی که مقدار "+l+"(شناسه یکتا) را پر می کند از نوع کامبو تعریف شده است"),o.IsBindingInProgress=!1}}}));var p,c=!1;if("00"!=o.ActNo||a&&a.inxml||s||o.RunResetBeforeForAct00||(o.RunResetBeforeForAct00=!0,o.Reset(!0),o.InitFrm_Core(),c=!0),n.rset&&n.rset.n&&e.each(n.rset.n,(function(n,a){for(var i=0;i<3;i++)e.each(a,(function(e,n){var a=e,r=n;"Opt"!==a&&(0==i&&a.indexOf(t.ACDesc)>0||1==i&&a.indexOf(t.ACTip)>0||2==i&&-1==a.indexOf(t.ACDesc)&&-1==a.indexOf(t.ACTip))&&(o.IsBindingInProgress=!0,r&&(r=t.utils.NPTrim(r)),o.Val(a,r),o.IsBindingInProgress=!1)}))})),!r||o.$ValidXml.r.NoAuthSAC||o.$ValidXml.r.AuthSAC||(p=!1,n.outpar&&e.each(n.outpar,(function(e,n){var a=n&&t.utils.NPTrim(n);e=o.W_.Alias2Id[e]||o.W_.Alias2Id[e.toUpperCase()]||e,ko.isObservable(o.ViewModel[e])&&o.Val(e)!=(a||"")&&(p=!0)}))),!r||p||o.$ValidXml.r.NoAuthSAC||o.$ValidXml.r.AuthSAC){n.outpar&&e.each(n.outpar,(function(e,n){try{n&&t.utils.NPTrim(n);e=(e=o.W_.Alias2Id[e]||o.W_.Alias2Id[e.toUpperCase()]||e).replace(t.VMCmpXmlUppercase,t.VMCmpXml),o.W_.FrmFld[e]&&-1==e.indexOf(t.ACDesc)&&-1==e.indexOf(t.ACTip)&&"110025"==o.W_.FrmFld[e].Valid.CmpId&&(o.Val(e+t.ACDesc,""),o.Val(e+t.ACTip,""))}catch(e){alert("exception2")}}));for(var u=0;u<3;u++)n.outpar&&e.each(n.outpar,(function(n,a){try{var i=a&&t.utils.NPTrim(a);if(n=(n=o.W_.Alias2Id[n]||o.W_.Alias2Id[n.toUpperCase()]||n).replace(t.VMCmpXmlUppercase,t.VMCmpXml),(0==u&&n.indexOf(t.ACDesc)>0||1==u&&n.indexOf(t.ACTip)>0||2==u&&-1==n.indexOf(t.ACDesc)&&-1==n.indexOf(t.ACTip))&&ko.isObservable(o.ViewModel[n])){o.IsBindingInProgress=!0,o.Val(n,i||""),o.IsBindingInProgress=!1;var r=o.W_.FrmFld[n]&&o.W_.FrmFld[n].SubFrmBrothers;r&&e.each(r,(function(e,t){o.Val(t.idXml,i||"")}))}o.W_.FrmFld[n]&&o.W_.FrmFld[n].Valid&&"1"==o.W_.FrmFld[n].Valid.npViewer&&(e(o.W_.FrmFld[n].Elem).npviewer({Binary:a}),o.W_.FrmFld[n].Valid.RO="1",e(o.W_.FrmFld[n].Elem).npviewer("ShowBinaryImage"))}catch(e){o.IsBindingInProgress=!1,alert("exception")}}))}n.outpar&&e.each(n.outpar,(function(n,a){if("_LkDfi"==n){var i={outpar:{}},r=e(a);r.length&&(e.each(r[0].attributes,(function(e,n){var a=n.name.toUpperCase();-1==a.indexOf(t.ACDesc.toUpperCase())&&-1==a.indexOf(t.ACTip.toUpperCase())&&(i.outpar[a]=n.value),a.indexOf(t.ACDesc.toUpperCase())>-1&&(i.outpar[a.replace(t.ACDesc.toUpperCase(),t.ACDesc)]=n.value),a.indexOf(t.ACTip.toUpperCase())>-1&&(i.outpar[a.replace(t.ACTip.toUpperCase(),t.ACTip)]=n.value)})),o._XML2ViewModel(i))}})),c&&o._XML2ViewModel(i.inxml,{SetInParam:!0}),l&&o.InitFrm_Core(),o.InternalChg_OnSubs=!1}},FindTmplRecord:function(t,n,a){var o=null;return e.each(t,(function(e,t){if(t.idF==n&&t.idFSeq==a)return o=t,!1})),o},CheckVM2XmlRowTmpl:function(e,t,n){return!0},CheckValAct_Core:function(n,a){var o,i=this,r=(a=a||{}).ComponentReq,l=a.Ltl&&1==a.Ltl?1:0,s="",d=(o="ThisMode"==n?i.ModeCode:i.CalcCheckValModeCode(n))&&i.$ValidXml.r.modes["mod"+o];return d?(i.InitFrm_Core({CheckValModeCodeJSON:d}),e.each(i.W_.FrmFld,(function(e,n){var a;if(a=r&&"0"==r?"0":n.CheckValReq,n.CheckValEnable){var o=n.Valid.Ltl&&1==n.Valid.Ltl?1:0;if("Cmp"==n.Valid.Typ&&n.Valid.OnAC){var d=0;(p=i.Val(e))||o||l||(p=i.ValDesc(e),d=1),void 0===p&&(p=""),i.CheckVal(i.MakeFullId(e),e,p,!1,{Req:a,Desc:d})<0&&""==s&&(s=i.MakeFullId(e))}else if("Cmp"!=n.Valid.Typ||n.IsFaci){if(-1==e.indexOf(t.VMCmpXml)){var p;void 0===(p=i.Val(e))&&(p=""),i.CheckVal(i.MakeFullId(e),e,p,!1,{Req:a})<0&&""==s&&(s=i.MakeFullId(e))}}else{var c=n.WidgetSelf.CheckValAct_Core("ThisMode",{ComponentReq:a,Ltl:o});""==s&&(s=c)}}})),s):""},CheckValAct:function(e){var t;return""!==(t=this.CheckValAct_Core(e))?(this.NPSetFocus(t,null,!1,!1),0):1},GetValOfCmp:function(){return this._ViewModel2XML("Cmp")},_ViewModel2XML:function(n,a){var o,i,r,l,s,d=this;if("object"==typeof a?(s=a.RootName,i=a.MaxHlp,r=a.StdHlp):i=a,!i&&t.NOFRowHLP&&(i=t.NOFRowHLP),"Cmp"==n?(s||(s="row"),o={}):(o=d._SndXML.r,d._SndXML.act=n,r&&(o.StdHlp=r),i&&!isNaN(i)?o.MaxHlpMaxHlp=i:delete o.MaxHlpMaxHlp),"NextAct"!==n&&"Cmp"!==n&&0==d.CheckValAct(n))return 0;var p=[];if(e.each(d.W_.FrmFld,(function(a,i){var r=i.Valid.Typ;if(!(i.Valid.RO&&"1"==i.Valid.RO||a.indexOf(t.VMCmpXml)>-1||i.Valid.MasterCmp)){if(d.W_.FrmFld[a+t.VMCmpXml]){var s=d.W_.FrmFld[a+t.VMCmpXml].SubFrmBrothers;if(s){var c=d.W_.FrmFld[a].WidgetSelf;e.each(s,(function(n,a){var o=a.npMode&&a.self.$ValidXml.r.modes["mod"+a.npMode];if(o){var i=a.self.EnableAllField;a.self.EnableAllField=!0,a.self.InitFrm_Core({CheckValModeCodeJSON:o}),a.self.EnableAllField=i,e.each(a.self.W_.FrmFld,(function(e,n){n.CheckValEnable&&(ko.isObservable(c.ViewModel[e+t.VMCmpXml])&&c.ViewModel[e+t.VMCmpXml](a.self.W_.FrmFld[e].WidgetSelf._ViewModel2XML("Cmp")),ko.isObservable(c.ViewModel[e+t.ACDesc])&&c.ViewModel[e+t.ACDesc](a.self.ViewModel[e+t.ACDesc]()),ko.isObservable(c.ViewModel[e])&&c.ViewModel[e](a.self.ViewModel[e]()))}))}else alert("unknown npMode")}))}}if("Cmp"==r&&i.Valid.OnAC)(l=d.Val(a))&&(l=t.utils.NPTrim(l)),o._LkId=l,"1"==i.Valid.SAC&&(p.push(a+t.ACDesc),p.push(a+t.ACTip));else if("Grd"==r){var u;l=i.Elem.npgrid("GetGridData"),d.Acts["act"+n]&&(u=d.Acts["act"+n].ActIn)&&e.each(u,(function(e,t){var n=i.Cols&&i.Cols[t];n&&(o[t]=n)}))}else(l=d.Val(a))&&(l=t.utils.NPTrim(l));var m;if("Cmp"==n&&(m=i.Alias),m||(m=a),l&&"object"!=typeof l&&(o[m]=l),d.$ValidXml.r.n[a+t.VMCmpXml]){var f=i.WidgetSelf.GetValOfCmp();f&&"object"!=typeof f&&(o[m+t.VMCmpXml]=f)}}})),e.each(p,(function(e,t){delete o[t]})),d.iacts&&d.iacts[n]&&e.each(o,(function(e,t){"MaxHlpMaxHlp"!=e&&-1===d.iacts[n].indexOf(e)&&delete o[e]})),"Cmp"==n){if(a&&a.toJson)return o;var c="<"+s;return e.each(o,(function(e,n){if("object"!=typeof n){var a="object"==typeof n?t.utils.escapeXml(JSON.stringify(n)):t.utils.escapeXml(n||"");c+=" "+e+'="'+a+'"'}})),c+="></"+s+">"}return 1},GetCmpInStr:function(n,a){var o=this,i=n.PreLoad,r=0;i.NewComponentsObj={},i.FormComponentsIdArr=[],i.FormFacisIdArr=[];var l=t.utils.NPLocalStorage(n.CmpType,n.CmpId,"XML");i.$ValidXml=JSON.parse(o.ReplaceParameter(n.P_,l||'{"r":{"n":{},"acts":{}}}',{EscapeJSON:!0}));var s=[];e.each(i.$ValidXml.r.load,(function(e,n){var a=n;t.NPPkgs[a]&&!t.NPPkgs[a].Loaded&&s.push(a)})),n.IsMakedFullId||(n.IsMakedFullId=!0,n.IdPrefix="#"+i.PreId,e("[id]",i.html_core).each((function(t,n){var a,o=e(n);a=o.prop("id"),o.attr("orgid",a),o.prop("id",i.PreId+a)})),e("label[for]",i.html_core).each((function(t,n){var a=e(n),o=i.PreId+a.attr("for");a.prop("for",o)})));var d=i.$ValidXml.r.NPGen,p=d?d.ver:0;e.each(i.$ValidXml.r.n,(function(n,a){p<302&&("2"==a.Lan&&"_Var"!=a.Typ&&e("#"+i.PreId+n,i.html_core).addClass("FIDDI"));if(a.OnAC){var o=n;e("#"+i.PreId+n,i.html_core).attr("data-bind","BindingCmp:"+o+",Desc:"+o+t.ACDesc+",Tip:"+o+t.ACTip+',CmpId:"'+o+'"')}if("Cmp"==a.Typ){var l=a.UrlF,s=a.UrlP,d=a.CmpId;l&&s&&!t.utils.NPLocalStorage(a.CmpType,d,"HTML")&&!i.NewComponentsObj[d]&&(i.NewComponentsObj[d]={CmpId:d,CmpType:0},t.fillCmpNames(i.NewComponentsObj[d],s+"/",l),++r),d?i.FormComponentsIdArr.push({id:n,CmpId:d,Loaded:!1}):i.FormFacisIdArr.push(n)}}));var c=i.FormComponentsIdArr.length,u=s.length,m=0,f=0,h=function(r){var l=i.$ValidXml.r.n[r],s=l.CmpId;i.Childs=i.Childs||{},i.Childs[r]={CmpType:0,CmpId:s,PreLoad:{PreId:n.PreLoad.PreId+r+"_W_"}},o._SetValueOf_P_(i.Childs[r],l),i.Childs[r].P_[t.P_IDIDID]=i.Childs[r].PreLoad.PreId;var d=t.utils.NPLocalStorage(0,s,"HTML");i.Childs[r].IsMakedFullId=d.indexOf(t.P_IDIDID)>-1,i.Childs[r].IdPrefix=i.Childs[r].IsMakedFullId?"#"+i.Childs[r].PreLoad.PreId:"#",d=o.ReplaceParameter(i.Childs[r].P_,d,{EscapeXml:!0}),d=e('<div style="position:relative" id="'+i.Childs[r].PreLoad.PreId+'">'+d+"</div>"),i.Childs[r].IsMakedFullId||(i.Childs[r].IsMakedFullId=!0,i.Childs[r].IdPrefix="#"+i.Childs[r].PreLoad.PreId,e("[id]",d).each((function(t,n){var a,o=e(n);a=o.prop("id"),o.attr("orgid",a),o.prop("id",i.Childs[r].PreLoad.PreId+a)})),e("label[for]",d).each((function(t,n){var a=e(n),o=i.Childs[r].PreLoad.PreId+a.attr("for");a.prop("for",o)}))),e(i.Childs[r].IdPrefix+"bod",d).css("overflow","visible").removeClass("ui-widget-content"),e(i.Childs[r].IdPrefix+"dvfrmCenter",d).css("overflow","visible"),e(i.Childs[r].IdPrefix+"dvfrmFooter",d).remove(),i.Childs[r].AddrPath=l.UrlP+"/",i.Childs[r].FName=l.UrlF,i.Childs[r].fname=i.Childs[r].AddrPath+i.Childs[r].FName,i.Childs[r].PreLoad.html_core=e("#"+i.PreId+r,n.PreLoad.html_core),i.Childs[r].PreLoad.html_core.html(d),o.GetCmpInStr(i.Childs[r],(function(e){++f==c&&a()}))},g=function(t){if(++m<r+u){var n=t.CmpId;n&&e.each(i.FormComponentsIdArr,(function(e,t){t.CmpId!=n||t.Loaded||(t.Loaded=!0,h(t.id))}))}else 0==c?a(i.html_core):e.each(i.FormComponentsIdArr,(function(e,t){t.Loaded||(t.Loaded=!0,h(t.id))}))};if(e.each(s,(function(e,t){o.GetPkg(t,g)})),e.each(i.NewComponentsObj,(function(e,t){o.GetComponent(t,g)})),c||u){if(!r&&!u)return m--,void g()}else a(i.html_core)},AfterGetForm:function(n,a,o){var i,r,l,s=this,d=s.options,p=s.element;n.OpenInDialog=!1,d.OpenInDialog&&(n.OpenInDialog=!0),d.OpenedByDashboard&&!n.InlineBox&&(n.InlineBox=p.parent().append('<div style="position:relative"/>').find("div:last").uniqueId(),n.HideOpener=!0,n.OpenInline=!0,n.OpenedByDashboard=!0,null==n.ShowFooter&&(n.ShowFooter=d.ShowFooter),p.addClass("np-d-none")),n.OpenInline?(r=n.InlineBox,l=r.attr("id")):l=t.npUniqueId(),n.fname=n.AddrPath+n.FName,i=t.utils.NPLocalStorage(n.CmpType,n.CmpId,"HTML")||"",n.P_=n.P_||{},n.P_[t.P_IDIDID]=l,n.IsMakedFullId=i.indexOf(t.P_IDIDID)>-1,i=e(s.ReplaceParameter(n.P_,i,{EscapeXml:!0})),n.IsMakedFullId||(n.IsMakedFullId=!0,n.IdPrefix="#"+l,e("[id]",i).add(i).each((function(t,n){var a,o=e(n);a=o.prop("id"),o.attr("orgid",a),o.prop("id",l+a)})),e("label[for]",i).each((function(t,n){var a=e(n),o=l+a.attr("for");a.prop("for",o)}))),n.IdPrefix=n.IsMakedFullId?"#"+l:"#";var c=n.FTitle;d.OpenInDialog&&n.OpenInSameDialog?(n.OpenerSelf=d.OpenerSelf,n.OpenerTicketSelf=s):n.OpenerSelf=s;n.PreLoad={},n.PreLoad.html_core=e(i),n.PreLoad.PreId=l,s.GetCmpInStr(n,(function(){!function(i){if(d.OpenInDialog&&n.OpenInSameDialog&&(n.OpenInDialog_ShowModal=!0,n.OpenInDialog=!0),n.OpenInline?(r.html(i),(m=e(n.IdPrefix+"bod",r)).removeClass("ui-widget-content")):(n.OpenInDialog||n.ForceOpenerTabId)&&(n.TabId=l,r=e("<div id="+l+' class="np-fitdivtoparent tab-pane" style="/*position:relative;*/direction:'+t.rtl+'; padding:0px;/*overflow:hidden*/"></div>').html(i).appendTo(n.ForceOpenerTabId?e("#"+n.ForceOpenerTabId).parent():e(p).parent())),d.OpenInDialog&&n.OpenInSameDialog&&(n.Height=s.options.Height,n.Width=s.options.Width,n.UseOpenerCaption&&(c=d.FTitle)),n.OpenInDialog_ShowModal?n.OpenInDialog_ShowModal=!0:n.OpenInDialog_ShowModal=!1,n.OpenInDialog){var u=n.CloseParentModal;null==u&&(u=!0);var m=d.OpenInDialog&&n.OpenInSameDialog?d.OpenerSelf.Get$bod():s.Get$bod();l=r.attr("id"),n.OpenerSelf.W_.OpenedDialogs[l]=n.$FaciDialogDiv=r;var f={appendTo:m.parent(),class:n.Class||"col-lg-9 col-12",closeButton:!1,destroyOnClose:!0,close:function(){GlobViewModel.OpenedSelf=s;var e=t.utils.GetWidgetSelf(r);e&&e.Close()}};c&&e("[np-frm-title]",e(n.IdPrefix+"dvfrmHeader",r)).html(c),r.removeClass("tab-pane").SimpleDialog(f),r.SimpleDialog("show")}function h(a,o){a&&((r=e(a)).prop("id",l).addClass("np-fitdivtoparent tab-pane"),r.html(i),c&&e("[np-frm-title]",e(n.IdPrefix+"dvfrmHeader",r)).html(c),e("#"+l+"bod",r).css("height","inherit")),e.NPCreateWidget(r,n.FName,n);var s=t.utils.GetWidgetSelf(r,n.FName);o&&o(s),n.Itself=s,s.NotRequireResizeHandler=!0}var g,C=n;n.OpenInDialog||n.InlineBox||n.ForceOpenerTabId?(n.OpenInDialog&&(C.ngData={caption:c},g=t.byNg((()=>s.GetngData().AngularTab.openDialog(C)))),a(),h(null,g),o()):(C.ngData={npform:!0,caption:c,ContinueAfterGetForm:h},a(),o(),t.byNg((()=>s.GetngData().AngularTab.openTab(C))))}(n.PreLoad.html_core)}))},GetNewForm:function(e){var n=this;n.GetngData()?.AngularTab?.openWaiting?n.GetngData()?.AngularTab?.openWaiting(!0,!0):n.ViewModel.OpenLoading(1);var a;a={CmpId:e.CmpId,CmpType:e.CmpType},t.fillCmpNames(a,e.AddrPath,e.FName),n.GetComponent(a,(function(t){t.status?n.AfterGetForm(e,(()=>{n.GetngData()?.AngularTab?.openWaiting?n.GetngData()?.AngularTab?.openWaiting(!1,!0):n.ViewModel.OpenLoading(0)}),(()=>{e.AfterOpen&&e.AfterOpen.call(n,"ok")})):n.GetngData()?.AngularTab?.openWaiting?n.GetngData()?.AngularTab?.openWaiting(!1,!0):n.ViewModel.OpenLoading(0)}))},RunAjax:function(n,a,o){var i=this,r=(i.options,i.element,!0);i.ExitFromSystem&&t.ExitMsg&&(r=!1,t.ExitMsg=!1),t.noNg((()=>e.ajax({type:"POST",xhrFields:{withCredentials:!0},url:i.url,dataType:"json",contentType:"application/json; charset=utf-8",processData:!1,async:r,data:n,complete:function(e,t){a&&a.call(this,e,t)},error:function(e,t,n){o&&o.call(this,e,t,n)}})))},CloseThisFaci:function(t,n,a,o){var i=this,r=i.options;i.GetngData()?.AngularTab?.openWaiting?i.GetngData()?.AngularTab?.openWaiting(!0):i.ViewModel.OpenWaiting(1),r.OpenerTabId=e("#li-"+i.ContId).hasClass("active")?r.OpenerTabId:"Default";i.CallDoAct_Sys((function(e){e.msg.errors.length&&!n?(o&&o(),i.SetRespmsg(e.msg),i.GetngData()?.AngularTab?.openWaiting?i.GetngData()?.AngularTab?.openWaiting(!1):i.ViewModel.OpenWaiting(0)):(i.GetngData()?.AngularTab?.openWaiting?i.GetngData()?.AngularTab?.openWaiting(!1):i.ViewModel.OpenWaiting(0),t.call(i,a))}),(function(e,t,n){o&&o(),i.SetRespmsg({c:[{m:[{e:"2",m:"خروج از امکان/سامانه با خطا مواجه گردید. ممکن است ارتباط شبکه قطع باشد."}]}]}),i.GetngData()?.AngularTab?.openWaiting?i.GetngData()?.AngularTab?.openWaiting(!1):i.ViewModel.OpenWaiting(0)}),{Act:n?"99":"98"})},ChangeUserType:function(e,t){var n=this;n.CallDoAct_Sys((function(t){t.msg.errors.length?(n.SetRespmsg(t.msg),e.call(this,t)):e.call(this,t)}),(function(e,t,a){n.SetRespmsg({c:[{m:[{e:"2",m:"خروج از امکان/سامانه با خطا مواجه گردید. ممکن است ارتباط شبکه قطع باشد."}]}]})}),{Act:t})},CallDoAct_Sys:function(e,n,a){var o=this,i=(o.options,o.element,a.Act);o.ExitFromSystem="99"==i,o._Init_SndXML({NavType:"logout"}),o._SndNavXML.r=a.r||{},o._SndNavXML.act=i,o.url=t.apiUrl+"/frm/sys/sys.svc/";var r=JSON.stringify(o._SndNavXML);o.RunAjax(r,(function(t,n){if("success"==n){var a=JSON.parse(t.responseText);o.SetAutByResp(a),e(a)}}),n)},OpenNewForm:function(n,a,o,i,r,l){var s=this,d=s.options;s.element;if("object"==typeof i&&(l=i,i=null),l.ftype=n,l.fid=a,l.subfrm=o,l.HideOpener&&0!=e("body")[0].scrollTop&&(s.LastScrollTop=e("body")[0].scrollTop),l.UseOpenerAut&&!l.OpenInDialog&&(l.HideOpener=!0,l.CloseOpener=!1),l.CmpId||(l.CmpType="1"==n?1:0),s.options.OpenInDialog||l.CloseOpener||l.UseParentOpenerTabId?l.OpenerTabId=s.options.OpenerTabId:l.OpenInDialog?s.options.IsCmp||s.options.IsFaci?l.OpenerTabId=s.options.OpenerTabId:l.OpenerTabId=s.ContId:l.ForceOpenerTabId?l.OpenerTabId=l.ForceOpenerTabId:l.OpenerTabId=s.RootContId(),l.UseOpenerAut)return l.AddrPath+="/",l.Usrfrm=d.Usrfrm,l.UserLvl=d.UserLvl,void s.GetNewForm(l);var p={OpenWaitingDialog:{NoOverlay:!0,NoCloseWaitingDialog:1}};s.QueueAct((function(e,i,r){if(!s.W_)return e(r),!1;var d;s._Init_SndXML({NavType:"nav"}),s._SndNavXML.act="nav",s._SndNavXML.r={ft:n,fid:a,subfrm:o},l.CmpId&&(s._SndNavXML.r.CmpId=l.CmpId),s.url=t.apiUrl+"/frm/sys/sys.svc/",d=JSON.stringify(s._SndNavXML),s.RunAjax(d,(function(t,n){if("success"==n){var a,d,p;if((p=(a=JSON.parse(t.responseText)).t)&&s.setTicket(p),"1"==(d=a.outpar).FaciNotFound||"1"==d.OldGolestan){var c="1"==d.FaciNotFound?"امکان مورد نظر وجود ندارد":"این امکان در این محیط قابل اجرا نمی باشد";return s.Message({type:"alert",text:c,title:"پیغام"}),e(r),l.AfterNav&&(l.AfterNav.call(s,a),delete l.AfterNav),void(l.ReadyCallBack&&l.ReadyCallBack(null,{cnt:1}))}if(d.cmp&&(l.CmpId=d.cmp),a.msg.errors.length)a.msg.c[0]&&a.msg.c[0].m[0]&&2==a.msg.c[0].m[0].e&&(a.msg.c[0].m[0].m=a.msg.c[0].m[0].m+(d.nam?"("+d.nam+")":"")),i||s.ClearRespmsg(),s.SetRespmsg(a.msg);else{if(l.ParentCmp||s.ClearRespmsg(),l.AddrPath=d.nurlp+"/",l.FName=d.nurlf,l.FTitle=l.OpenInDialog&&l.FTitle?l.FTitle:d.nam,l.HHLP=d.hhlp?d.hhlp:0,l.Usrfrm=d.usrfrm,l.UserLvl=d.usrlvl,l.rp=s.SetAutByResp(a,!0),""!=o||"0"===l.subfrm||l.CmpId||(l.CmpId=parseInt(l.fid,10)+parseInt(l.subfrm,10)),d.nurlp&&l.FName)return e(r),l.AfterNav&&(l.AfterNav.call(s,a),delete l.AfterNav),void s.GetNewForm(l);s.SetRespmsg({c:[{m:[{e:"2",m:"مسیر برنامه این فرم تعریف نشده است.-"+(l.FTitle?l.FTitle:"")}]}]})}}e(r),l.AfterNav&&(l.AfterNav.call(s,a),delete l.AfterNav),l.ReadyCallBack&&l.ReadyCallBack(null,{cnt:1})}),(function(e,t,n){s.SetRespmsg({c:[{m:[{e:"2",m:"خطا در دریافت اطلاعات فرم جدید"}]}]})}))}),p)},GridOnRowClick:function(n,a,o){var i=this;if(!i.IsWebBusy()){var r=a.ActNo,l=!!a.StopFocusToFirst,s=a.ClickEvent,d=e(s.target);d.length&&("INPUT"==d[0].tagName||e("input",d).length)&&(l=!0);var p=a.ColPrefix,c="",u=0,m=!1;if("Access"!=i.$ValidXml.r.Layout&&(m=!0),a.AssignFields){for(var f=0;f<3;f++)e.each(a.Grd.options.RelField,(function(n,o){var r,s,d;if((0==f&&o.id.indexOf(t.ACDesc)>0||1==f&&o.id.indexOf(t.ACTip)>0||2==f&&-1==o.id.indexOf(t.ACDesc)&&-1==o.id.indexOf(t.ACTip))&&(r=c||(o.colD?a.Data.ServerData.attr(p+(o.colD-u))||"":a.Data.Td()[o.col-1-u].Html()),o.col&&(s=a.Grd._vm.Cols()[o.col-1-u].ShowTag),s&&(m=!0),!m&&r.indexOf(",")>-1?(c=r.substr(r.indexOf(",")+1),r=r.substring(0,r.indexOf(",")),u++):c="",r=s&&"2"!=s&&"3"!=s&&"4"!=s?(d=r).indexOf("<")>-1?t.stripHtmlTags(d):d:r,r=t.utils.NPTrim(r),!(i.$ValidXml.r.Layout&&"Access"==i.$ValidXml.r.Layout&&"_TempField"==o.id||(i.Val(o.id,r),l)))){var h=[],g=[];i.GetHlpIn(o.id,h,g),e.each(h,(function(n,a){if(-1==["Cmp","_Var"].indexOf(g[n])){var o=e("#"+a);if(o.length&&!o.prop("readonly")&&"none"!==o.css("display"))return t.noNg((()=>setTimeout((function(){o.data().datepicker||o.prop("readonly")||o[0].focus({preventScroll:!0})}),500))),l=!0,!1}}))}}));i.Acts["act"+r].relfieldopenfaci&&e(i.Acts["act"+r].relfieldopenfaci).each((function(e,t){var n=a.Data.ServerData.attr(p+t.colD);i.OpenFaciVariable(t.ActNo,r,t.colD,n)})),a.MoreGridOnRowClickSelf&&a.MoreGridOnRowClickSelf.GridOnRowClick(n,a,o)}return!0}},OpenFaciVariable:function(e,t,n,a){var o=this;return o.V_=o.V_||{},void 0===a?(void 0===(a=o.V_["_"+e+"_"+t+"_"+n])&&(a=""),a):(o.V_["_"+e+"_"+t+"_"+n]=a,a)},CreateNPGrid:function(n,a,o){var i=this,r=i.options,l=i.element;a=a||{};var s=(n=n||{}).id,d=a.ActNo;r.ParentCmp&&a.IsNotHelp&&(r.ParentCmp.options.HaveGrid=!0),0!==a.FullScreenable&&(a.FullScreenable="1"==n.FullScreenable?1:0),a.LinePerPage=n.LinePerPage||a.LinePerPage||20;var p=n.ColPrefix,c=n.RadifWidth,u=n.ShowRadifTitle,m=n.NpGridWidth,f=n.NewDesign,h=n.NoShowFooter,g=n.Form,C=n.height,v=n.NoRowColor1,b=n.NoRowColor2,_=n.NoRowColor3,F=n.Responsive,w=n.Responsivable,y=n.OddRowClass,S=n.ColHeight,A=n.RowMaxHeight,I=n.EvenRowClass,T=n.ActiveRowClass,N=n.StopSort;w&&(a.Responsivable=w),F&&(a.Responsive=F),c&&(a.RadifWidth=c),u&&(a.ShowRadifTitle=u),m&&(a.width=m),f&&(a.NewDesign=f),h&&(a.NoShowFooter=h),y&&(a.OddRowClass=y),I&&(a.EvenRowClass=I),T&&(a.ActiveRowClass=T),S&&(a.ColHeight=S),A&&(a.RowMaxHeight=A),g&&(a.Form=g),C&&(a.height=C);var x=n.HiddenAllColsFirst;x&&(a.HiddenAllColsFirst=x),p&&(a.ColPrefix=p),N&&(a.StopSort=N),v&&(a.NoRowColor1=v),b&&(a.NoRowColor2=b),_&&(a.NoRowColor3=_),n.NoPaging&&(a.NoPaging="1"==n.NoPaging),!a.HideFooter&&n.HideFooter&&"1"==n.HideFooter&&(a.HideFooter=!0);var W=n.AftFilRow,D=n.OnClickRow,M=n.AftClickRow,O=n.GetRowData,V=n.AftSwitch,k=n.GrdComplete,P=a.DefaultNoRadif?0:1;!n.Radif||"0"!=n.Radif&&"no"!=n.Radif||(P=0),n.Radif&&"1"==n.Radif&&(P=1),P&&(a.Radif=P),n.OnGridTextBlur&&(a.OnGridTextBlur=r[n.OnGridTextBlur]),n.AfterGridTextBlur&&(a.AfterGridTextBlur=r[n.AfterGridTextBlur]),W&&(a.AftFilRow=r[W]),D&&(a.OnRowClick=r[D]),M&&(a.AfterRowClick=r[M]),O&&(a.GetRowData=r[O]),V&&(a.AftSwitch=r[V]),k&&(a.AfterGridDrawCompleted=r[k]),d&&(a.RelField=i.Acts["act"+d].relfield||[]),a.InitOnRowClick=function(t,a){var o=a.Grd.options,i=new Array,r=0;e.each(a.Data.Td(),(function(e,t){i[r++]=t.Html()})),a.MoreGridOnRowClickSelf=n.MoreGridOnRowClickSelf,a.ColPrefix=o.ColPrefix||"F",a.ActNo=o.ActNo,a.FArr=i,a.AssignFields=!0,o.DefaultCloseDialog&&(a.CloseDialog=!0)},a.InitAfterRowClick=function(n,a){var o,i=a.Grd.options.npform,r=a.Grd.options,l=r.ColPrefix,d=r.jsonstruc;if(s){var p=i.W_.FrmFld[s].Cols={};e.each(a.Grd._vm.Cols(),(function(e,t){t.Name&&(p["_"+s+"_"+t.Name]=a.Data.Td()[e].Html())}))}i.GridOnRowClick(n,a,r.HelpDialog),r.DoActParams&&r.DoActParams.MSAutoC_Select&&r.DoActParams.MSAutoC_Select(a),d&&(o=e(a.ClickEvent.target).attr("npname")||e(a.ClickEvent.target.parentElement).attr("npname"))&&e.each(d.Cols,(function(n,r){var s=n+1;r.Acts&&e.each(r.Acts,(function(n,r){if(o==r.ActName+s){var d,p,c,u=r.ThisCmpActNo;if(u)return void i.DoAct(u);inxml={outpar:{},doact:{}};var m={ReturnCaption:"بازگشت",OpenInDialog:!1,OpenInDialog_ShowModal:!1,HideOpener:!0,CloseOpener:!1,DisableOpener:!1,AfterClose:null,AfterOpen:null,ReturnParam:{},After:!0,Width:"auto",Height:"auto",inxml:inxml};if(p=r.OpenFid,d=r.OpenFtype,m.CmpId=r.OpenCmpId,m.AddrPath=r.AddrPath,m.FName=r.FName,m.FTitle=r.FTitle,m.UseOpenerAut=!!r.UseOpenerAut,m.OpenInDialog=!!r.OpenInDialog,m.OpenInDialog_ShowModal=!!r.OpenInDialog_ShowModal,m.CloseOpener=!!r.CloseOpener,m.HideOpener=!!r.HideOpener,m.AfterClose=function(e,n){t.noNg((()=>setTimeout((function(){m.noDoAct||i.DoAct("08")}),0)))},r.ActConnect&&e.each(r.ActConnect,(function(e,n){var o="";if(n.ValueFromCol)if(isNaN(n.ValueFromCol)){var r=a.Grd.GetTdByName(a.Data,n.ValueFromCol);o=r?r.Html():""}else o=a.Data.ServerData.attr(l+n.ValueFromCol);if(!o&&n.ValueFromCmpObjAlias){var s=i.W_.Alias2Id[n.ValueFromCmpObjAlias.toUpperCase()]||n.ValueFromCmpObjAlias;(s=s+(1==n.ValueFromCmpObjRelTyp&&t.ACDesc||"")+(2==n.ValueFromCmpObjRelTyp&&t.VMCmpXml||""))&&(o=i.Val(s))}inxml.outpar[n.OpenCmpObjAlias+(1==n.OpenCmpObjRelTyp&&t.ACDesc||"")+(2==n.OpenCmpObjRelTyp&&t.VMCmpXml||"")]=n.ValueFix||o})),r.OpenCmpActNo&&(inxml.doact.act=r.OpenCmpActNo),r.JavaScriptId&&i[r.JavaScriptId])i[r.JavaScriptId](m,d,p,c),(m.fid||m.CmpId)&&i.OpenNewForm(m.ftype,m.fid,m.subfid,m);else if(r.JavaScript){ParamsAntiUgly=m,selfAntiUgly=i;var f="var Params=ParamsAntiUgly;var self=selfAntiUgly;"+r.JavaScript;t.utils.eval(f),(p||m.CmpId)&&i.OpenNewForm(d,p,c,m)}else(p||m.CmpId)&&i.OpenNewForm(d,p,c,m)}}))})),a.CloseDialog&&(!i.W_.IsInMobile&&r.HelpDialog.npUiDialog("close"),i.W_.IsInMobile&&r.HelpDialog.SimpleDialog("close"))},a.jsonstruc&&a.jsonstruc.Cols&&(a.GetRowDataInternal=function(t,n){var a=n.Grd.options.npform,o=n.Grd.options.ColPrefix;e.each(n.Grd.options.jsonstruc.Cols,(function(t,i){var r=t+1,l=i.Name;i.Acts&&e.each(i.Acts,(function(e,t){var i=n.Grd.GetTdByName(n.Data,l||o+r),s="",d=t.CondMethodName||"";(""==d||d&&a[d]&&a[d].call(a,n,i))&&(1==t.IconType&&(s=a.GetGlyphIcon({name:t.IconName,title:t.IconTitle,style:t.Style,attr:{npname:t.ActName+r},class:t.Class})),2==t.IconType&&(s=a.gettinybutton(t.IconName,{npname:t.ActName+r})),1!=t.IconType&&2!=t.IconType||i.Html(i.Html()+"&nbsp;&nbsp"+s),3==t.IconType&&i.Html(a.SetHyper({name:t.IconName,title:t.IconTitle,style:t.Style,attr:{npname:t.ActName+r},class:t.Class},i.Html())))}))}))});var L=n.MinHeight;L&&(a.MinHeight=L),a.ColAttr=a.ColAttr||{};var R,E,$=a.ColAttr,H=[],G=n.RId,B=n.RIdCol;n.col&&e.each(n.col,(function(e,t){H[e]=t,t.COLTYPE=$["COLTYPE"+e]||t.COLTYPE,t.SHOWTAG=$["SHOWTAG"+e]||t.SHOWTAG,t.SHOWLABEL=$["SHOWLABEL"+e]||t.SHOWLABEL,t.DIR=$["DIR"+e]||t.DIR,t.ALIGN=$["ALIGN"+e]||t.ALIGN,t.MULTILINE=$["MULTILINE"+e]||t.MULTILINE,t.FilterType=$["FilterType"+e]||t.FilterType,t.CheckBox=$["CheckBox"+e]||t.CheckBox,t.GridOutput=$["GridOutput"+e]||t.GridOutput})),H&&(a.Cols=H),G&&(a.RId=G),B&&(a.RIdCol=B),s&&(E=e("#"+i.MakeFullId(s),e(l)))&&(R=i.GetCover(E)),R&&(a.GridCover=R);var X,U=o.npgrid(a);return(X=n.Dlg)&&o.npgrid("SetDlg",i.$np("#"+X)),U},OpenMenuForm:function(e){},showmenu:function(){},ShowFirstForm:function(){},CloseDialog:function(){var e=this,t=e.options;e.IsWebBusy()||(t.$FaciDialogDiv?t.OpenInDialog?t.$FaciDialogDiv.SimpleDialog("close"):t.$FaciDialogDiv.npDialog("close"):e.Close())},Close:function(n,a){var o=this,i=o.options,r=(o.element,(n=n||{}).ForceClose);if((r||!o.IsWebBusy())&&o._trigger("BeforeClose")){var l=function(e){var n=this,o=n.options,i=n.element,l=i.attr("id");r||n._trigger("AfterClose",null,o.ReturnParam),t.noNg((()=>setTimeout((function(){!o.OpenInDialog&&o.OpenedByDashboard&&!o.CloseOpener&&o.OpenerSelf&&o.OpenerSelf.element.removeClass("np-d-none"),o.OpenerSelf&&o.OpenerSelf.W_&&(o.OpenerSelf.W_.OpenedDialogs[l]=null,delete o.OpenerSelf.W_.OpenedDialogs[l]),!o.OpenInDialog&&o.ngData?t.byNg((()=>o.ngData.AngularTab.closeTab())):(o.OpenInDialog&&o.ngData&&t.byNg((()=>o.ngData.AngularTab.closeDialog())),i.remove()),a&&a.call(n)}),0)))},s=0,d=0,p=function(){++s==d&&(i.UseOpenerAut?l.call(o):o.CloseThisFaci(l,!1,n,null))};e.each(o.W_.OpenedDialogs,(function(e,t){t&&d++})),e.each(o.W_.FrmFld,(function(e,t){t.IsFaci&&d++})),e.each(o.W_.StayedForm,(function(e,t){t&&!t.self.options.OpenInDialog&&d++})),s!==d&&e.each(o.W_.OpenedDialogs,(function(e,n){n&&t.utils.GetWidgetSelf(n)&&t.utils.GetWidgetSelf(n).Close({ForceClose:!0},p)})),s!==d&&e.each(o.W_.FrmFld,(function(e,t){t.IsFaci&&t.WidgetSelf.Close({ForceClose:!0},p)})),s!==d&&e.each(o.W_.StayedForm,(function(e,t){t&&!t.self.options.OpenInDialog&&t.self.Close({ForceClose:!0},p)})),0==d&&(--s,p())}},SaveScrollTops:function(){var t=this;e.each(t.W_.HelpGrids,(function(t,n){null!==n&&e(n).npgrid("SaveScrollTop")})),e.each(t.W_.FrmFld,(function(e,t){"Grd"==t.Valid.Typ&&t.Elem.npgrid("SaveScrollTop")})),e.each(t.W_.FrmFld,(function(e,t){t.IsFaci&&t.WidgetSelf.SaveScrollTops()})),t.W_.$dvfrmCenterscrollTop=t.W_.$dvfrmCenter[0].scrollTop,t.W_.$bodyscrollTop=e("body").scrollTop()},LoadScrollTops:function(){var t=this;e.each(t.W_.HelpGrids,(function(t,n){null!==n&&e(n).npgrid("LoadScrollTop")})),e.each(t.W_.FrmFld,(function(e,t){"Grd"==t.Valid.Typ&&t.Elem.npgrid("LoadScrollTop")})),e.each(t.W_.FrmFld,(function(e,t){t.IsFaci&&t.WidgetSelf.LoadScrollTops()})),t.W_.$dvfrmCenterscrollTop&&(t.W_.$dvfrmCenter[0].scrollTop=t.W_.$dvfrmCenterscrollTop),(t.W_.$bodyscrollTop||0===t.W_.$bodyscrollTop)&&e("body").scrollTop(t.W_.$bodyscrollTop)},OpenFaci:function(t,n,a,o,i,r){r=e.extend({ReturnCaption:"بازگشت",inxml:{}},r),this.OpenNewForm(t,n,"",o,i,r)},ResizeHandler:function(){var t=this,n=t.options;t.element;if(n.ParentCmp&&n.ParentCmp.options.HaveGrid){var a=t.W_.$dvfrmCenter.outerHeight(!0)-t.W_.$dvfrmCenter.height(),o=t.W_.$dvfrmHeader.outerHeight(!0),i=t.W_.$dvfrmFooter.outerHeight(!0)||0;"none"!=t.W_.$dvfrmHeader.css("display")&&o||(o=0),"none"!=t.W_.$dvfrmFooter.css("display")&&i||(i=0),n.ParentCmp?t.W_.$bod.parent().parent().height()-a-o-i:t.W_.$bod.height()-a-o-i}e.each(t.W_.FrmFld_Grd,(function(e,n){t.W_.FrmFld[e]&&t.W_.FrmFld[e].Elem&&t.W_.FrmFld[e].Elem.npgrid("ReCalcDim")}))},FixHeader:function(){var e=this;e.$np("#dvfrmHeader").prepend(e.W_.HelpBox),e.dvfrmCenterHeight()},AppendXmlDataToJSON:function(t,n){var a,o;return n=n||this.$ValidXml.r.n,t.each((function(t,i){var r=e(i);(o=r.attr("id"))&&(a=n[o]={},e.each(i.attributes,(function(e,t){a[t.name]=t.value})),r.children().each((function(t,n){a[n.tagName]=a[n.tagName]||[];var o={};e.each(n.attributes,(function(e,t){o[t.name]=t.value})),a[n.tagName].push(o)})))})),a},FaciHelp:function(e,t,n){var a,o,i,r=0,l=this.AutXml();a={attr:function(e){return l.rp[e]}},t||(t=a.attr("f"),r=parseInt(a.attr("subfrm"))),e||(e=a.attr("ft")),(i={ReturnCaption:"بازگشت",OpenInDialog:!1,OpenInDialog_ShowModal:!1,HideOpener:!0,CloseOpener:!1,DisableOpener:!1,AfterClose:n,AfterOpen:null,ReturnParam:{},After:!0,Width:"auto",Height:"auto",title:!0,inxml:o={outpar:{},doact:{}}}).CmpId=110034,i.AddrPath="/frm/F0224_CMP_FORMGUIDE_GETFACILITYHELP",i.FName="F0224_CMP_FORMGUIDE_GETFACILITYHELP",i.FTitle="راهنماي امكان",i.UseOpenerAut=!0,i.OpenInDialog=!0,i.OpenInDialog_ShowModal=!1,i.Width=800,o.outpar.PBW=e,o.outpar.PBX=t,o.outpar.PBY=r+1,o.doact.act="10",this.OpenNewForm(undefined,undefined,undefined,i)},ValidChgAttr:function(e,t,n){this.W_.FrmFld[e].Valid[t]=n},ValidChgNextAct:function(t,n,a){void 0===a&&(a="0");var o,i=this.$ValidXml.r.acts;function r(t){"all"==a?e.each(t,(function(e,t){"mod"==e.substr(0,3)&&(t.nex=n)})):(t["mod"+a]=t["mod"+a]||{},t["mod"+a].nex=n)}"all"==t?e.each(i,(function(e,t){"act"==e.substr(0,3)&&r(t)})):(o=i["act"+t])?r(o):r(o=i["act"+t]={})},EmptyValid:function(t,n){var a,o=this.$ValidXml.r.acts;function i(t){"all"==n?e.each(t,(function(e,t){"mod"==e.substr(0,3)&&(t.f={})})):(t["mod"+n]=t["mod"+n]||{},t["mod"+n].f={})}void 0===n&&(n="0"),"all"==t?e.each(o,(function(e,t){"act"==e.substr(0,3)&&i(t)})):(a=o["act"+t])?i(a):i(a=o["act"+t]={})},AddValid:function(t,n,a,o,i){var r,l=this.$ValidXml.r.acts;function s(t){if("all"==a)e.each(t,(function(t,a){"mod"==t.substr(0,3)&&(a.f=i?{}:a.f||{},e(n).each((function(e,t){a.f[t]||(a.f[t]=o&&"0"!=o?{Req:"1"}:{})})))}));else{var r=t["mod"+a]=t["mod"+a]||{};r.f=i?{}:r.f||{},e(n).each((function(e,t){r.f[t]||(r.f[t]=o&&"0"!=o?{Req:"1"}:{})}))}}void 0===a&&(a="0"),Array.isArray(n)||(n=[n]),"all"==t?e.each(l,(function(e,t){"act"==e.substr(0,3)&&s(t)})):(r=l["act"+t])?s(r):s(r=l["act"+t]={})},RemValid:function(t,n,a){var o,i=this.$ValidXml.r.acts;function r(t){if("all"==a)e.each(t,(function(t,a){"mod"==t.substr(0,3)&&(a.f=a.f||{},e(n).each((function(e,t){a.f[t]&&delete a.f[t]})))}));else{var o=t["mod"+a]=t["mod"+a]||{};o.f=o.f||{},e(n).each((function(e,t){o.f[t]&&delete o.f[t]}))}}void 0===a&&(a="0"),Array.isArray(n)||(n=[n]),"all"==t?e.each(i,(function(e,t){"act"==e.substr(0,3)&&r(t)})):(o=i["act"+t])?r(o):r(o=i["act"+t]={})},RepValid:function(e,t,n,a){void 0===n&&(n="0"),Array.isArray(t)||(t=[t]),this.AddValid(e,t,n,a,"1")},ReFillLookup:function(t){var n=this;if(t){var a=n.GetCmpSelf(t);n=a||n}var o={RunInQueue:!0};n.$ValidXml.r.NoAuth&&(o.NoAuth=!0),e.each(n.W_.FrmFld,(function(t,a){"Cmp"==a.Valid.Typ&&110025==a.Valid.CmpId&&a.Valid.SAC&&"1"==a.Valid.SAC&&e.each(a.WidgetSelf.W_.FrmFld,(function(e,i){i.Valid.IsAC&&(a.Valid.npAutoCompleteWidget=i.Elem.npAutoComplete("instance"),i.Elem.npAutoComplete("FillLookup",o,(function(){var e=n.Val(t);n.Val(t,e)})))}))}))},GetACCache:function(e){this.W_.FrmFld[e].Elem.npAutoComplete("FillLookup")},ClearACCache:function(t){var n=this.W_.FrmFld[t];"Cmp"!=n.Valid.Typ||110025!=n.Valid.CmpId?this.W_.FrmFld[t].Elem.npAutoComplete("ClearCache"):e.each(n.WidgetSelf.W_.FrmFld,(function(e,t){t.Valid.IsAC&&(n.Valid.npAutoCompleteWidget=t.Elem.npAutoComplete("instance"),t.Elem.npAutoComplete("ClearCache"))}))},CreateObs:function(e,t,n){var a=this;t=null==typeof t?"":t,a.ViewModel[e]=ko.observable(t),a.$ValidXml.r.n[e]={id:e,Def:t,Typ:"_Var"},a.W_.FrmFld[e]?alert("error duplicate FrmFld"):(a.W_.FrmFld[e]={},a.W_.FrmFld[e].Valid=a.$ValidXml.r.n[e],n&&(a.W_.FrmFld[e].valParams=n))},CreateObsArr:function(e){this.ViewModel[e]=ko.observableArray([])},XAttrToViewModel:function(e,t,n,a){this.XAttrToObject(null,e,t,n,a)},XAttrToObject:function(e,t,n,a,o,i){var r=this;try{var l="$html"==a?i?r.npFormat(n.text()):n.text():i?r.npFormat(n.attr(a)):n.attr(a);e?e[t]=l:r.Val(t,l)}catch(n){null==typeof o&&(o=""),e?e[t]=o:r.Val(t,o)}},setFrmTitle:function(t){e('[np-frm-title="1"]',this.W_.$dvfrmHeader).text(t)},ClearOpt:function(e){this.ViewModel[e+t.OPTOPT].removeAll()},ValOpts:function(e){var n=this;return e=n.W_.Alias2Id[e]||n.W_.Alias2Id[e.toUpperCase()]||e,n.ViewModel[e+t.OPTOPT]()},ValOpt:function(n){var a=this;n=a.W_.Alias2Id[n]||a.W_.Alias2Id[n.toUpperCase()]||n;var o,i=a.ViewModel[n](),r=a.ViewModel[n+t.OPTOPT]();if(i&&r)return e.each(r,(function(e,t){if(t.val==i)return o=t,!1})),o},_Val:function(e,n,a,o){var i=this,r=i.W_.FrmFld[e];if(void 0===n){var l,s=e.substring(0,e.indexOf(t.VMCmpXml));return s&&i.GetCmpSelf(s)?i.GetCmpSelf(s).GetValOfCmp():(l=ko.unwrap(a[e]),o?.num?l:(l||(l=""),i.NPFix(e,l)))}i.IsBindingInProgress=!0;try{if(ko.isObservable(a[e])){var d,p=null==n?"":n.toString();return p=(p=t.utils.NPChangeNumToLatin(p))?i.NPFormat(e,p):p,o?.num?(a[e](n),i.IsBindingInProgress=!1,n):("object"==typeof n?a[e](n):a[e](p),r.Val=p,r.LastVal=r.Val,i.ShowError(i.MakeFullId(e),e,""),isNaN(p)||t.utils.NPTrim(a[e]())===t.utils.NPTrim(p)||(a[e](null),r.Val=a[e](),r.LastVal=r.Val),(d=r.LabelElemCmp)&&"1"!=d&&(p||!r.Enabled?d.addClass("groupInputFocus"):d.removeClass("groupInputFocus")),r.Valid.OnAC&&(d=i._GetLabelOfElem(e))&&(p||!r.Enabled?d.addClass("groupInputFocus"):d.removeClass("groupInputFocus")),i.IsBindingInProgress=!1,p)}return a[e]=n.toString(),i.IsBindingInProgress=!1,n}catch(e){alert("error"),i.IsBindingInProgress=!1}},ValByKeyboard:function(e,t,n){var a=n.attr("GridId");if(e&&!a&&(this.$np("#"+e).data({npchange:"1",npchangeautoc:"1"}),this.Val(e,t)),a){var o=n.attr("Np-Col-Id"),i=ko.dataFor(n[0]);n.val(t),i.Td()[o].Html(t)}},ValXml:function(e,n){var a=this;return e=a.W_.Alias2Id[e]||a.W_.Alias2Id[e.toUpperCase()]||e,a.Val(e+t.VMCmpXml,n)},ValDesc:function(e,n){var a=this;return e=a.W_.Alias2Id[e]||a.W_.Alias2Id[e.toUpperCase()]||e,a.Val(e+t.ACDesc,n)},ValTip:function(e,n){var a=this;return e=a.W_.Alias2Id[e]||a.W_.Alias2Id[e.toUpperCase()]||e,a.Val(e+t.ACTip,n)},Val:function(n,a,o){var i=this,r=i.ViewModel;if(i.W_.FrmFld[n]?.valParams&&(o=o||{},e.each(i.W_.FrmFld[n]?.valParams,((e,t)=>{void 0===o[e]&&(o[e]=t)}))),!Array.isArray(n)){if(n=i.W_.Alias2Id[n]||i.W_.Alias2Id[n.toUpperCase()]||n,a&&"object"==typeof a&&(void 0!==a.desc&&i._Val(n+t.ACDesc,a.desc,r,o),void 0!==a.tip&&i._Val(n+t.ACTip,a.tip,r,o),void 0!==a.val))return i._Val(n,a.val,r,o);if(a&&(i.$ValidXml.r.NoAuthSAC||i.$ValidXml.r.AuthSAC)){var l=i.W_.FrmFld[n];if("Cmp"==l.Valid.Typ&&110025==l.Valid.CmpId&&l.Valid.SAC&&"1"==l.Valid.SAC)if(l.Valid.MSAutoC&&"1"==l.Valid.MSAutoC);else{var s=l.Valid.npAutoCompleteWidget.GetDescTip(a);s.hasNotData?i.ReFillLookup():(s.Desc&&i._Val(n+t.ACDesc,s.Desc||"",r,o),s.Tip&&i._Val(n+t.ACTip,s.Tip||"",r,o))}}return i._Val(n,a,r,o)}e(n).each((function(e,t){i.Val(t.i,t.v,o)}))},Toggle:function(t){var n,a=this,o="object"==typeof t?t.currentTarget.id:t,i="VIS",r=a.W_.FrmFld[a.MakeOrgId(o)].Valid;"VIS"===r.CurState?(r.CurState="INVIS",e("#"+o).removeClass("ui-icon-circle-minus").addClass("ui-icon-circle-plus")):(r.CurState="VIS",i="INVIS",e("#"+o).addClass("ui-icon-circle-minus").removeClass("ui-icon-circle-plus")),(n=r.RelObj)&&a.$np("#"+n).css("display","INVIS"===i?"":"none"),a.ResizeHandler()},CreateCodeMirrorObj:function(t,n){var a=this,o=a.$np("#"+t);n=n||{};var i="";if("1"==o.attr("np-inline")){a.ViewModel[t].subscribe((function(e){a["codeMirror_"+t].setValue(a.Val(t))}));var r=n.Mode||"javascript",l=CodeMirror.fromTextArea(o[0],{mode:r,indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,foldGutter:!0,autofocus:!1,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{"Ctrl-Space":"autocomplete",Tab:function(e){var t=Array(e.getOption("indentUnit")).join("   ");e.replaceSelection(t)}}});return o.prop("readonly")&&l.setOption("readOnly",!0),o.prop("np-cm",l),l.setSize(null,o.height()),a["codeMirror_"+t]=l,void l.on("blur",(function(e){a.Val(t,e.getValue())}))}var s=e('<input src="/img/fullscr.png" type="image" />').css({marginTop:"-4px",float:"right"}).click((function(){if(o.prop("np-cm"))a.Val(t,o.prop("np-cm").getValue()),o.prop("np-cm").toTextArea(),e(o.prop("np-wd")).append(o.closest("div")),e(o.prop("np-FullScrDiv")).remove(),o.prop("np-cm",null),""!=i&&i.hide();else{o.prop("loc",{w:o.width(),h:o.height()});var r=e("<div />").css({position:"absolute",zIndex:10010,top:"0px",right:"10px",border:"1px solid #ccc"}).append(o.closest("div")).appendTo(a.$np("#bod"));""==i?i=e("<span class='ui-icon ui-icon-carat-2-e-w' style='position:absolute;top:5px;left:5px' title='تنظیم فرمت کد'></span>").appendTo(a.$np("#bod")):i.show(),"sql"==n.Mode&&(n.Mode="text/x-sql");var l=n.Mode||"javascript",s=CodeMirror.fromTextArea(o[0],{mode:l,indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,foldGutter:!0,autofocus:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{"Ctrl-Space":"autocomplete",Tab:function(e){var t=Array(e.getOption("indentUnit")).join("   ");e.replaceSelection(t)}}});i.on("click",(function(e){CodeMirror.commands.selectAll(s);var t={from:s.getCursor(!0),to:s.getCursor(!1)};s.autoFormatRange(t.from,t.to),s.setCursor({line:0,ch:0})})),o.prop("readonly")&&s.setOption("readOnly",!0);for(var d=a,p=a.$np("#bod").height(),c=a.$np("#bod").width();d.options.IsCmp;)p=(d=d.options.ParentCmp).element.height(),c=d.element.width();s.setSize(c-20,p-25),o.prop("np-cm",s),o.prop("np-FullScrDiv",r)}}));o.wrap(e("<div />")).before(s).parent().wrap(e("<div />")),o.prop("np-wd",o.parent().parent())},upl:function(e,t){this.updwn(!0,e,t)},dwn:function(e,t){this.updwn(!1,e,t)},updwn:function(n,a,o){var i=this,r={param:o,AppendTo:i.W_.$bod,InData:function(t,n){var a={r:{}};return e.each(o(),(function(t,o){"act"===t?n.act=o:"pararr"==t&&"up"==n.act?(a.r.id=o[0],a.r.fnam=o[1]):"pararr"==t&&"dw"==n.act?e.each(o,(function(e,t){var n=e+1;a.r["p"+n]=t})):a.r[t]=o})),!!n.act&&(e.extend(a,i.AutXml()),a.act=n.act,n.xml=JSON.stringify(a),!0)},AfterGO:function(e,n){i.Resp=JSON.parse(n.xml),i.SetAutByResp(i.Resp);var a={ErLen:i.ErLen,WarLen:i.WarLen};i.ActNo=a.ActNo=n.act,"up"==n.act&&n.param().pararr&&n.param().pararr.length>0&&(n.param().id=n.param().pararr[0],n.param().fnam=n.param().pararr[1]);var o=n.param().id||n.param().pararr&&n.param().pararr[0],r=n.param().fnam||n.param().pararr&&n.param().pararr[1];o&&i.Val(o,i.Resp.outpar.id),r&&i.Val(r,i.Resp.outpar.fnam),n.param().len&&i.Val(n.param().len,i.Resp.outpar.len),n.param().fuq&&i.Val(n.param().fuq,i.Resp.outpar.fuq),n.param().ftck&&i.Val(n.param().ftck,i.Resp.outpar.ftck),i.ClearRespmsg(),i.SetRespmsg(i.Resp.msg),t.noNg((()=>i.Get_Data(null,a)))},BeginGO:function(){if(i.IsWebBusy())return!1;i.SetFreezServer(!0)},EndGO:function(){i.SetFreezServer(!1)}};n?e(a).npupload(r):e(a).npdownload(r)},Message:function(e){var t=this;t.W_.$bod.is(":np-npmessage")||t.W_.$bod.npmessage(),t.W_.$bod.npmessage("Dialog",e)},_CheckExistsValidationData:function(e){return!!e&&!!this.W_.FrmFld[e]},_SetCurrValidationData:function(e,n,a){var o,i=this,r=i.Valid_;if(e&&i.W_.FrmFld[e])o=i.W_.FrmFld[e].Valid;else{if(!(n&&a&&i.W_.FrmFld[n]&&(o=i.W_.FrmFld[n].ColsValid)))return!1;if(!(o=o[a]))return!1}if(!r)return alert("StartValidationCheck is not running!!!!!!!!!"),!0;if(o.Lan&&"Let"!=o.Typ||(o.Lan=3),t.NoSwitchLangByCtrl){switch(o.Lan){case"2":r.CurLang="latin";break;case"1":r.CurLang="farsi";break;default:r.CurLang="all"}o.CurLang=r.CurLang}else if(!(r.CurLang=o.CurLang)){switch(o.Lan){case"2":r.CurLang="latin";break;case"1":case"3":r.CurLang="farsi";break;default:r.CurLang="all"}o.CurLang=r.CurLang}return o.Cap=o.Cap||"",o},TriggerEvent:function(e,t,n){var a=this;a.W_.FrmFld[e]["np-"+t]&&a._trigger(a.W_.FrmFld[e]["np-"+t],n)},StartValidationCheck:function(){var n=this,a=n.element;LengthOfStudentNo||(LengthOfStudentNo=10),"undefined"!=typeof LengthOfLesNo&&LengthOfLesNo||(LengthOfLesNo=7),e.ui.keyCode.NUMPAD_DECIMAL=110;var o=n.Valid_;function i(e,t,a){n.W_.FrmFld[e]["np-"+t]&&n._trigger(n.W_.FrmFld[e]["np-"+t],a)}n._on(n.W_.$bod,{"click [id]":function(t){var a=e(t.target);if(!a.hasClass("ui-state-disabled")&&!a.prop("readonly")){var o=e(t.currentTarget),r=o.attr("orgid");n.W_.FrmFld[r]&&(i(r,"OnClk",t),i(r,"OpenFaci",t));try{if("FIELDSET"==o[0].nodeName&&"SPAN"==a[0].nodeName){var l=a.prev(),s=l.attr("orgid"),d=l.attr("id");s&&d&&n.W_.FrmFld[s]&&(t.currentTarget=l[0],i(s,"OnClk",t))}}catch(e){}}},"blur [id]":function(t){var a=e(t.currentTarget).attr("orgid");n.W_.FrmFld[a]&&i(a,"OnBl",t)},"mouseover [id]":function(t){var a=e(t.currentTarget).attr("orgid");n.W_.FrmFld[a]&&i(a,"OnOvr",t)},"mouseout [id]":function(t){var a=e(t.currentTarget).attr("orgid");n.W_.FrmFld[a]&&i(a,"OnOut",t)},"focus :input":function(a){o.IsChangeInProgress=!1;var i,r=e(a.currentTarget),l=r.attr("orgid")||r.attr("GrdObjorgid"),s=r.attr("GridId"),d=r.attr("OrgGridId"),p=r.attr("Np-Col-Id");if(s&&r.parent().click(),(i=n._SetCurrValidationData(l,d,p))&&(!t.NoSwitchLangByCtrl||"all"!=o.CurLang)){if(("text"==r[0].type||"textarea"==r[0].type)&&!r.attr("readonly")){n.SetLangShowPosition(r),e("div",GlobViewModel.LangShow.show()).text("farsi"==o.CurLang?"FA":"EN");var c=i.Typ||"";["Int","Num","StdNo","PDat","GDat","SSNo","Flt","Tim"].indexOf(c)>-1&&GlobViewModel.LangShow.hide()}t.noNg((()=>clearTimeout(n.LangTimer))),n.LangTimer=t.noNg((()=>setTimeout((function(){GlobViewModel.LangShow.hide()}),1e3)))}},"focus .groupInput input, input.groupInput":function(t){var n=e(t.currentTarget);e("label[for="+n.attr("id")+"]",a).addClass("groupInputFocus"),t.stopPropagation()},"blur :input":function(t){var a=e(t.currentTarget),i=a.attr("orgid")||a.attr("GrdObjorgid"),r=a.attr("OrgGridId"),l=a.attr("Np-Col-Id");n._SetCurrValidationData(i,r,l)&&(GlobViewModel.LangShow.hide(),o.IsChangeInProgress||"1"==a.data("npchange")&&(a.data("npchange","0"),n._Chg_Core(a)))},"focusout .groupInput input, input.groupInput":function(t){var n=e(t.currentTarget);""==n.val()&&n.prev("span.MSCLASS").length<1&&!n.prop("readonly")&&e("label[for="+n.attr("id")+"]",a).removeClass("groupInputFocus"),t.stopPropagation()},"keypress :input":function(t){n._KeyPress(t,e(t.currentTarget)),t.stopPropagation()},"keyup :input":function(t){n._KeyUp(t,e(t.currentTarget)),t.stopPropagation()},"keydown :input":function(t){n._KeyDown(t,e(t.currentTarget)),t.stopPropagation()},"paste :input":function(t){e(t.currentTarget).data("npchange","1"),t.stopPropagation()},"change :input":function(t){e(t.currentTarget).data("npchange","0"),n._Chg(t,e(t.currentTarget)),t.stopPropagation()}})},SetLangShowPosition:function(e){var t=e.offset(),n="ltr"==e.attr("dir")?t.left:t.left+e.outerWidth()-GlobViewModel.LangShow.outerWidth(),a=t.top-GlobViewModel.LangShow.outerHeight();return GlobViewModel.LangShow.css({left:n+"px",top:a+"px"}),{Left:n,Top:a}},_KeyPress:function(n,a,o){var i,r,l=this,s=(o=o||{}).EditorId,d=a.attr("orgid")||a.attr("GrdObjorgid"),p=a.attr("id"),c=a.attr("GridId"),u=a.attr("OrgGridId"),m=a.attr("Np-Col-Id");if(!d&&a.hasClass("FilterTextbox")&&(i={Typ:"Txt",Lan:"3"}),!d&&a.hasClass("reportTextBox"))i={Typ:"Num"};else if(!(i=l._SetCurrValidationData(d,u,m)))return;if(a.attr("readonly"))n.preventDefault();else if("Check"!=i.Typ){var f,h,g,C=l.Valid_;if(f=n.keyCode?n.keyCode:n.which,h=n.which,g=n.shiftKey,"Htm"!=i.Typ&&(f!=e.ui.keyCode.ENTER||!i.TextArea)){"Let"!=i.Typ&&"Pass"!=i.Typ||(i.Typ="Txt");var v={};if(t.NoSwitchLangByCtrl&&"all"==C.CurLang||(v[1588]=97,v[1584]=98,v[1586]=99,v[1740]=100,v[1579]=101,v[1576]=102,v[1604]=103,v[1575]=104,v[1607]=105,v[1578]=106,v[1606]=107,v[1605]=108,v[1574]=109,v[1583]=110,v[1582]=111,v[1581]=112,v[1590]=113,v[1602]=114,v[1587]=115,v[1601]=116,v[1593]=117,v[1585]=118,v[1589]=119,v[1591]=120,v[1594]=121,v[1592]=122,v[1705]=59,v[1662]=92,v[1670]=93,v[1711]=39,v[1608]=44),t.NoSwitchLangByCtrl&&"all"==C.CurLang||"latin"!=C.CurLang||!g||(v[1614]=65,v[1573]=66,v[1688]=67,v[1616]=68,v[1613]=69,v[1617]=70,v[1728]=71,v[1570]=72,v[93]=73,v[1600]=74,v[171]=75,v[187]=76,v[1569]=77,v[1571]=78,v[91]=79,v[92]=80,v[1611]=81,v[1585]=82,v[1615]=83,v[1548]=84,v[44]=85,v[1572]=86,v[1612]=87,v[1610]=88,v[1563]=89,v[1577]=90),t.NoSwitchLangByCtrl&&"all"==C.CurLang||(f=v[f]?v[f]:f),0!=h&&8!=f&&9!=f&&!n.ctrlKey){if(C.IsChangeInProgress=!1,f==e.ui.keyCode.ENTER&&!s)return n.preventDefault(),n.stopPropagation(),void(l._Chg_Core(a,!0)&&(c?l.NPFocusNextInGrid(a):l.NPFocusNext(p,d)));var b=a.NPSelectionText(),_=a.val(),F=a[0].selectionStart,w=a[0].selectionEnd;if("latin"!=C.CurLang||"BDO"!=a[0].tagName)switch("ANum"==i.Typ&&"Access"!=l.$ValidXml.r.Layout&&(i.Typ="ANum2"),"Al"==i.Typ&&"Access"!=l.$ValidXml.r.Layout&&(i.Typ="Al2"),i.Typ){case"Tim":a.val(),(f<48||f>57)&&n.preventDefault();break;case"Url":break;case"Email":if(!t.NoSwitchLangByCtrl){var y=t.ValidChars.Email.charCodeAt(f-32);"~"==String.fromCharCode(y)||(a.insertAtCaret(String.fromCharCode(y)),l.ValByKeyboard(d,a.val(),a)),n.preventDefault()}break;case"StdNo":(f<48||f>57||a.val().length>=LengthOfStudentNo)&&n.preventDefault();break;case"LesNo":a.val().length>=LengthOfLesNo&&n.preventDefault();break;case"SSNo":case"Num":(f<48||f>57)&&n.preventDefault();break;case"Int":case"Cur":if(f<48||f>57){if(45==f)-1==a.val().indexOf("-")?(r="-"+a.val(),l.ValByKeyboard(d,r,a)):(r=a.val().slice(1),l.ValByKeyboard(d,r,a));n.preventDefault()}break;case"Flt":if(f<48||f>57)if(46==f)b.indexOf(".")<0&&n.preventDefault();else if(45==f){-1==a.val().indexOf("-")?(r="-"+a.val(),l.ValByKeyboard(d,r,a)):(r=a.val().slice(1),l.ValByKeyboard(d,r,a)),n.preventDefault()}else n.preventDefault();break;case"Al":if("farsi"==C.CurLang){!g&&f<91&&f>64&&(f+=32),g&&f<123&&f>96&&(f-=32);y=t.ValidChars.AlFarsi.charCodeAt(f-32);"~"==String.fromCharCode(y)||(a.insertAtCaret(String.fromCharCode(y)),l.ValByKeyboard(d,a.val(),a)),n.preventDefault()}else if("latin"==C.CurLang){y=t.ValidChars.AlLatin.charCodeAt(f-32);"~"==String.fromCharCode(y)||(a.insertAtCaret(String.fromCharCode(y)),l.ValByKeyboard(d,a.val(),a)),n.preventDefault()}break;case"Al2":if("farsi"==C.CurLang){!g&&f<91&&f>64&&(f+=32),g&&f<123&&f>96&&(f-=32);y=t.ValidChars.Al2Farsi.charCodeAt(f-32);"~"==String.fromCharCode(y)||(a.insertAtCaret(String.fromCharCode(y)),l.ValByKeyboard(d,a.val(),a)),n.preventDefault()}else if("latin"==C.CurLang){y=t.ValidChars.Al2Latin.charCodeAt(f-32);"~"==String.fromCharCode(y)||(a.insertAtCaret(String.fromCharCode(y)),l.ValByKeyboard(d,a.val(),a)),n.preventDefault()}break;case"ANum":if("farsi"==C.CurLang){!g&&f<91&&f>64&&(f+=32),g&&f<123&&f>96&&(f-=32);y=t.ValidChars.ANumFarsi.charCodeAt(f-32);"~"==String.fromCharCode(y)||(a.insertAtCaret(String.fromCharCode(y)),l.ValByKeyboard(d,a.val(),a)),n.preventDefault()}else if("latin"==C.CurLang){y=t.ValidChars.ANumLatin.charCodeAt(f-32);"~"==String.fromCharCode(y)||(a.insertAtCaret(String.fromCharCode(y)),l.ValByKeyboard(d,a.val(),a)),n.preventDefault()}break;case"ANum2":if("farsi"==C.CurLang){!g&&f<91&&f>64&&(f+=32),g&&f<123&&f>96&&(f-=32);y=t.ValidChars.ANum2Farsi.charCodeAt(f-32);"~"==String.fromCharCode(y)||(a.insertAtCaret(String.fromCharCode(y)),l.ValByKeyboard(d,a.val(),a)),n.preventDefault()}else if("latin"==C.CurLang){y=t.ValidChars.ANum2Latin.charCodeAt(f-32);"~"==String.fromCharCode(y)||(a.insertAtCaret(String.fromCharCode(y)),l.ValByKeyboard(d,a.val(),a)),n.preventDefault()}break;case"Txt":case"SHtm":case"Htm":if("farsi"==C.CurLang){if(f>32&&f<128){!g&&f<91&&f>64&&(f+=32),g&&f<123&&f>96&&(f-=32);y=t.ValidChars.HtmFarsi.charCodeAt(f-32);if(s)(S=(s.contentWindow||window).document.createElement("div")).innerHTML=String.fromCharCode(y),document.execCommand("insertText",!1,S.innerHTML);else"BDO"==a[0].tagName?(a.pasteHtmlAtCaret(String.fromCharCode(y),window),a[0].innerText=a[0].innerText):(a.insertAtCaret(String.fromCharCode(y)),l.ValByKeyboard(d,a.val(),a));n.preventDefault()}}else if("latin"==C.CurLang){var S;if(s){if(13!=f&&32!=f)(S=(s.contentWindow||window).document.createElement("div")).innerHTML=String.fromCharCode(f),document.execCommand("insertHtml",!1,S.innerHTML),n.preventDefault()}else a.insertAtCaret(String.fromCharCode(f)),l.ValByKeyboard(d,a.val(),a),n.preventDefault()}break;case"PDat":case"GDat":if(0==a[0].selectionStart&&a[0].selectionEnd==a[0].value.length){if(!(f<48||f>57))return void a.data("npchange","1");n.preventDefault()}b.indexOf("/")>-1&&n.preventDefault(),1==a.val().length?47==f?(a.val("/0"+a.val()),n.preventDefault(),a[0].selectionStart=0,a[0].selectionEnd=0):f<48||f>57?n.preventDefault():(_=_.substring(0,F)+String.fromCharCode(f)+_.substring(w,_.length)).length>1&&(a.val("/"+_),n.preventDefault(),a[0].selectionStart=0,a[0].selectionEnd=0):2==a.val().length?47==f?(a.val("/"+a.val()),n.preventDefault(),a[0].selectionStart=0,a[0].selectionEnd=0):(""==b||f<48||f>57)&&n.preventDefault():3==a.val().length?0==F&&0==w?(f<48||f>57)&&n.preventDefault():n.preventDefault():4==a.val().length&&(47==f?(a.val("/0"+a.val()),n.preventDefault(),a[0].selectionStart=0,a[0].selectionEnd=0):f<48||f>57?n.preventDefault():(a.val("/"+_.substr(0,1)+String.fromCharCode(f)+_.substr(1)),n.preventDefault(),a[0].selectionStart=0,a[0].selectionEnd=0))}}}}},_KeyDown:function(t,n){var a=this,o=n.attr("orgid");o&&(8==(t.keyCode?t.keyCode:t.which)&&""==n.val()&&a.BackSpaceFocus&&e.each(a.$ValidXml.r.n,(function(e,n){if(n.Nex==o&&n.Typ&&"HLnk"!=n.Typ&&"DLbl"!=n.Typ&&"MSAutoC"!=n.Typ&&a.W_.FrmFld[e].Elem&&a.W_.FrmFld[e].Enable)return a.W_.FrmFld[e].Elem.focus(),t.preventDefault(),!1})),a.BackSpaceFocus=!1)},_KeyUp:function(n,a){var o=this,i=a.attr("orgid")||a.attr("GrdObjorgid"),r=a.attr("id"),l=a.attr("GridId"),s=a.attr("OrgGridId"),d=a.attr("Np-Col-Id");if(o.BackSpaceFocus=!0,t.noNg((()=>clearTimeout(o.BackSpaceTimer))),!i&&a.hasClass("FilterTextbox"))var p={Typ:"Htm",Lan:"3",CurLang:"farsi"};else if(!(p=o._SetCurrValidationData(i,s,d)))return;if("Check"!=p.Typ){var c,u,m,f,h=o.Valid_,g=e.ui.keyCode;if(c=n.keyCode?n.keyCode:n.which,u=n.shiftKey,!([g.ESCAPE,e.ui.keyCode.ENTER].indexOf(c)>-1)){if([e.ui.keyCode.BACKSPACE,e.ui.keyCode.DELETE].indexOf(c)>-1&&"1"!=p.HtmlArea)return m=a.val(),void o.ValByKeyboard(i,m,a);if(!t.NoSwitchLangByCtrl&&(17==c||18==c&&u)){if("3"==p.Lan){if("farsi"===h.CurLang)h.CurLang="latin";else h.CurLang="farsi";p.CurLang=h.CurLang}var C=e(n.currentTarget);if(("text"==C[0].type||"textarea"==C[0].type)&&!C.attr("readonly")){var v=p.Typ||"";["Int","Num","StdNo","PDat","GDat","SSNo","Flt","Tim"].indexOf(v)>-1?GlobViewModel.LangShow.hide():(o.SetLangShowPosition(C),e("div",GlobViewModel.LangShow.show()).text("farsi"==h.CurLang?"FA":"EN"))}return t.noNg((()=>clearTimeout(o.LangTimer))),o.LangTimer=t.noNg((()=>setTimeout((function(){GlobViewModel.LangShow.hide()}),1e3))),void n.preventDefault()}var b=p.Max;switch(p.Typ){case"Num":case"Int":case"Al":case"ANum":case"Txt":case"PDat":case"GDat":case"Url":case"Email":case"SSNo":break;case"Flt":-1!=a.val().indexOf(".")||c!=g.PERIOD&&c!=g.NUMPAD_DECIMAL||(0==a.val().length||1==a.val().length&&("-"==a.val()||"+"==a.val())?(m=a.val()+"0.",o.ValByKeyboard(i,m,a)):(m=a.val()+".",o.ValByKeyboard(i,m,a)));break;case"Tim":(c>47&&c<58||c>95&&c<106)&&(2==(f=a.val()).length?(m=f+":",o.ValByKeyboard(i,m,a)):f.length>2&&-1==e.inArray(":",f)&&(m=f.slice(0,2)+":"+f.slice(2),o.ValByKeyboard(i,m,a)));break;case"Cur":if(c>47&&c<58||c>95&&c<106||c==g.BACKSPACE||c==g.DELETE){for(var _="",F=1,w=(f=a.val().replace(/,/g,"")).length-1;w>-1;w--,F++)F>1&&(F-1)%3==0&&(_=","+_),_=f[w]+_;o.ValByKeyboard(i,_,a)}break;case"StdNo":b=LengthOfStudentNo;break;case"LesNo":b=LengthOfLesNo}if(b||p.Dec){switch(p.Typ){case"Cur":f=a.val().replace(/,/g,"");break;case"PDat":case"GDat":f=a.val().replace(/\//g,"").replace(/\./g,"");break;case"Tim":f=a.val().replace(/:/g,"");break;default:f="BDO"==a[0].tagName?a.html():a.val()}if(p.Dec&&f.indexOf(".")>0&&(f.length-f.indexOf(".")>parseInt(p.Dec)+1||f.length-f.indexOf(".")==parseInt(p.Dec)+1&&13!==c&&-1==e.inArray(c,h.ControlKeys))&&(f=f.substring(0,f.indexOf(".")+parseInt(p.Dec)+1),o.ValByKeyboard(i,f,a),o._Chg_Core(a,!0)))return void(l?o.NPFocusNextInGrid(a):o.NPFocusNext(r,i));if(b&&(f.length>b||f.length==b&&-1==e.inArray(c,h.ControlKeys)&&13!==c)&&(f.length>b&&(f=f.slice(0,b),o.ValByKeyboard(i,f,a)),o._Chg_Core(a,!0)))return void(l?o.NPFocusNextInGrid(a):o.NPFocusNext(r,i));"1"==p.Nomreh&&(2==(f=a.val()).length&&f.indexOf(".")<0&&0!=p.To.indexOf(f)?o.ValByKeyboard(i,f+".",a):parseFloat(p.To)==parseFloat(f)&&(l?o.NPFocusNextInGrid(a):o.NPFocusNext(r,i)))}}}},_Chg_Core:function(e,t){var n,a,o,i=this,r=e.attr("orgid")||e.attr("GrdObjorgid"),l=e.attr("id"),s=e.attr("GridId"),d=e.attr("OrgGridId"),p=e.attr("Np-Col-Id"),c=!1,u={GridId:s,OrgGridId:d,NpColId:p};if(s&&(u.$CurrObj=e),e.is("input:radio")||e.is("input:checkbox")?c=!0:n=e.val(),void 0===r&&void 0!==(r=e.attr("name"))&&(c=!0,r=i.MakeOrgId(r)),!r&&!d||!(o=i._SetCurrValidationData(r,d,p)))return 0;if(o.IsAC&&e.npAutoComplete("call_change"),e.data("nphaserror",""),c)e.is("input:radio")&&i.ValByKeyboard(r,e.val(),e);else{if(!(i.CheckVal(l,r,n,!0,u)>0))return e.data("nphaserror","1"),s||t||""==o.OnCh||e.hasClass("np-select-readonly")||i._trigger(o.OnCh),0;a=e.val(),d||(a!=i.NPFormat(r,i.NPFix(r,n,u),u)||""==a&&i.Val(r)!=a)&&i.ValByKeyboard(r,n,e)}return s||t||""==o.OnCh||e.prop("readonly")||e.hasClass("np-select-readonly")||i._trigger(o.OnCh),1},_Chg:function(t,n){var a=this,o=(a.element,a.options,n.attr("orgid")),i=a.Valid_;if(a.IsBindingInProgress)return!1;if(1!=i.IsChangeInProgress){if(o){var r=a.W_.FrmFld[o];r&&!r.Enable&&a.ViewModel[o](r.LastVal)}var l=e.ui.keyCode;return(t.keyCode?t.keyCode:t.which)!=l.ENTER&&("INPUT"==n.prop("tagName")&&"text"==n.prop("type")||n.prop("type"),a._Chg_Core(n),!0)}},_Trim:function(e){return e.val(e.val.replace(/(^\s*)|(\s*$)/g,"")),e.val},_Mell:function(e){return 0==e.length||10==e.length&&("1111111111"!=e&&"0000000000"!=e&&"2222222222"!=e&&"3333333333"!=e&&"4444444444"!=e&&"5555555555"!=e&&"7777777777"!=e&&"8888888888"!=e&&"9999999999"!=e&&(("0"!=e.charAt(0)||"0"!=e.charAt(1)||"0"!=e.charAt(2)||"0"!=e.charAt(3)||"0"!=e.charAt(4)||"0"!=e.charAt(5)||"0"!=e.charAt(6))&&(c=parseInt(e.charAt(9)),n=10*parseInt(e.charAt(0))+9*parseInt(e.charAt(1))+8*parseInt(e.charAt(2))+7*parseInt(e.charAt(3))+6*parseInt(e.charAt(4))+5*parseInt(e.charAt(5))+4*parseInt(e.charAt(6))+3*parseInt(e.charAt(7))+2*parseInt(e.charAt(8)),r=n-11*parseInt(n/11),0==r&&r==c||1==r&&1==c||r>1&&c==11-r)))},_EmailCheck:function(e){var t='[^\\s\\(\\)><@,;:\\\\\\"\\.\\[\\]]+',n="("+t+'|("[^"]*"))',a=new RegExp("^"+n+"(\\."+n+")*$"),o=e.match(/^(.+)@(.+)$/);if(null==o)return!1;var i=o[1],r=o[2];for(s=0;s<i.length;s++)if(i.charCodeAt(s)>127)return!1;for(s=0;s<r.length;s++)if(r.charCodeAt(s)>127)return!1;if(null==i.match(a))return!1;var l=r.match(/^\[(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\]$/);if(null!=l){for(var s=1;s<=4;s++)if(l[s]>255)return!1;return!0}var d=new RegExp("^"+t+"$"),p=r.split("."),c=p.length;for(s=0;s<c;s++)if(-1==p[s].search(d))return!1;return(2==p[p.length-1].length||-1!=p[p.length-1].search(/^(com|net|org|edu|int|mil|gov|arpa|biz|aero|name|coop|info|pro|museum)$/))&&!(c<2)},ConvertPersianNumberToLatin:function(e){if(!e||"string"!=typeof e)return e;var t=["0","1","2","3","4","5","6","7","8","9"];if(0==/\>(.*?)\</.test(e)){var n=0;return e.replace(/[۰۱۲۳۴۵۶۷۸۹]/g,(function(e){return"۰"==e&&(n=0),"۱"==e&&(n=1),"۲"==e&&(n=2),"۳"==e&&(n=3),"۴"==e&&(n=4),"۵"==e&&(n=5),"۶"==e&&(n=6),"۷"==e&&(n=7),"۸"==e&&(n=8),"۹"==e&&(n=9),t[+n]}))}return e.replace(/\>(.*?)\</g,(function(e){return e.replace(/[۰۱۲۳۴۵۶۷۸۹]/g,(function(e){return e.replace(/[۰۱۲۳۴۵۶۷۸۹]/g,(function(e){return"۰"==e&&(n=0),"۱"==e&&(n=1),"۲"==e&&(n=2),"۳"==e&&(n=3),"۴"==e&&(n=4),"۵"==e&&(n=5),"۶"==e&&(n=6),"۷"==e&&(n=7),"۸"==e&&(n=8),"۹"==e&&(n=9),t[+n]}))}))}))},NPFix:function(e,n,a){var o;if((n&&"string"==typeof n&&(n=this.ConvertPersianNumberToLatin(n)),(a=a||{}).$CurrObj)&&a.GridId)var r=a.OrgGridId,l=a.NpColId;if(!e&&!r||!(o=this._SetCurrValidationData(e,r,l)))return n;var s=n;switch(o.Typ){case"PDat":case"GDat":s=t.utils.NPTrim(s.replace(/\//g,"").replace(/\./g,""));break;case"Tim":s=t.utils.NPTrim(s.replace(/\:/g,""));break;case"Cur":s=n.replace(/,/g,"");break;default:if("boolean"==typeof n&&(s=n?"1":"0"),n&&""!=o.Fil&&""!=n){var d=parseFloat(o.Max),p=o.Fil,c=o.Jus;if(n.length<d){var u="";for(i=0;i<d-n.length;i++)u+=p;s="L"==c?n+u:u+n}}}return s},NPFormat:function(e,t,n){var a;if((n=n||{}).$CurrObj&&n.GridId)var o=n.OrgGridId,i=n.NpColId;if(!e&&!o||!(a=this._SetCurrValidationData(e,o,i)))return t;var r=t;switch(a.Typ){case"PDat":case"GDat":if(8!=(r=(r=r.replace(/\//g,"")).replace(/\./g,"")).length)return t;r=r?r.substr(0,4)+"/"+r.substr(4,2)+"/"+r.substr(6,2):"";break;case"Tim":r=(r=r.replace(/\:/g,""))?r.substr(0,2)+":"+r.substr(2,2):"";break;case"Cur":for(var l=r.replace(/,/g,""),s="",d=1,p=l.length-1;p>-1;p--,d++)d>1&&(d-1)%3==0&&(s=","+s),s=l.substr(p,1)+s;r=s}return r},CheckValNotVisibleElem:function(e,t){return!0},CheckValidChars:function(e,n){var a=n.Lan,o="";o="1"==a?t.ValidChars.ANumFarsi:"2"==a?t.ValidChars.ANumLatin:t.ValidChars.ANumFarsi.concat(t.ValidChars.ANumLatin);var i=String.fromCharCode(96),r="[^("+o.replace(/~/g,"")+i+"!@#$^%&()\\-.+,/\"_{|}\\[,?؟\\]*\r\t<>\n=';:)]";return!e.match(new RegExp(r,"g"))},CheckVal:function(n,a,o,i,r){var l,s,d,p=this,c=p.options,u=p.NPGen?p.NPGen.ver:0;if((r=r||{}).$CurrObj&&r.GridId)var m=r.OrgGridId,f=r.NpColId;if(!a&&!m||!(l=p._SetCurrValidationData(a,m,f)))return-1;d=m?l.Req:p.W_.FrmFld[a].CheckValReq;var h=n&&e("#"+n).is(":visible");if(u<305&&!m&&!h&&"1"!=l.HtmlArea)return 1;"1"==d&&c.IsCmp&&(p.ComponentReq&&"1"==p.ComponentReq||(d="0"));var g=p.NPFix(a,o,r);if(g=t.utils.NPTrim(g),l.MSAutoC&&"0"!=l.MSAutoC&&!m){if("1"!==d)return 1;var C=l.IsAC?p.Val(l.MSAutoC):p.W_.FrmFld[a].WidgetSelf.GetFinalValOfCmp();if(0==(C=e("row",C).length))return s="مقدار معتبری انتخاب نشده است",p._ShowError(n,a,s,i,r),-1}var v=!1,b=p.W_.FrmFld[a]&&p.W_.FrmFld[a].Act,_="Cmp"==l.Typ?l.VTyp||"Txt":l.Typ;if(b&&"Cmp"!==l.Typ){var F=p.Acts["act"+b].relfield||[];e.each(F,(function(e,t){"_TempField"!=t.id&&""==p.Val(t.id)&&"1"==p.W_.FrmFld[t.id].Req&&p.W_.FrmFld[t.id].Enable&&(v=!0)}))}var w=l.DescTyp||"Txt";if(r&&r.Desc&&"Txt"==w&&g)return p._ShowError(n,a,"",!1,r),1;if("boolean"==typeof g||g){if(b&&v&&"1"==d)return s="مقدار معتبری انتخاب نشده است",p._ShowError(n,a,s,i,r),-1;if(r&&r.Desc)return p._ShowError(n,a,"",!1,r),1;if(""!=l.Min&&g.length<parseFloat(l.Min))return s='طول"'+l.Cap+'" نمي تواند کمتر از  '+l.Min+" کاراکتر باشد",p._ShowError(n,a,s,i,r),-1;if(""!=l.Max&&g.length>parseFloat(l.Max))return s='طول"'+l.Cap+'" نمي تواند بیشتر از  '+l.Max+" کاراکتر باشد",p._ShowError(n,a,s,i,r),-1;switch(_){case"GDat":var y=0;if(g&&isNaN(g)&&(y=1,s="تاریخ نمی تواند غیرعددی باشد"),y)return p._ShowError(n,a,s,i,r),-1;break;case"PDat":y=0;var S=g.substr(6,2),A=g.substr(4,2);g.substr(0,4);if(parseInt(g)<parseInt(l.Fro)&&(s=l.Cap+" کمتر از مقدار مجاز است",y=1),parseInt(g)>parseInt(l.To)&&(s=l.Cap+" بیشتر از مقدار مجاز است",y=1),parseInt(A)<=6&&parseInt(S)>31&&(y=1,s="روز نمی تواند بزرگتر از 31 باشد"),parseInt(A)>6&&parseInt(S)>30&&(y=1,s="روز نمی تواند بزرگتر از 30 باشد"),parseInt(A)>12&&(y=1,s="ماه نمی تواند بزرگتر از 12 باشد"),parseInt(S)<=0&&(y=1,s="روز نمی تواند کوچکتر از 1 باشد"),parseInt(A)<=0&&(y=1,s="ماه نمی تواند کوچکتر از 1 باشد"),g&&isNaN(g)&&(y=1,s="تاریخ نمی تواند غیرعددی باشد"),y)return p._ShowError(n,a,s,i,r),-1;break;case"Tim":var I=0,T=g.substring(0,2),N=g.substring(2,4);if(parseInt(N)>59&&(I=1,s="دقیقه نباید بیشتر از 59 باشد"),parseInt(T)>23&&(I=1,s="ساعت نباید بیشتر از 23 باشد"),g&&isNaN(g)&&(y=1,s="ساعت نمی تواند غیرعددی باشد"),(g.length<4||!g.substr(2,2).match(/^\d+$/)||!g.substr(0,2).match(/^\d+$/))&&(I=1,s="مقدار نامعتبر است"),I)return p._ShowError(n,a,s,i,r),-1;break;case"SSNo":var x=g.replace(/(\/)/g,"");if(!p._Mell(x))return s=l.Cap+" نامعتبر است",p._ShowError(n,a,s,i,r),-1;break;case"Email":if(x=(x=g.replace(/(\/)/g,"")).toLowerCase(),!p._EmailCheck(x))return s=l.Cap+" نامعتبر است",p._ShowError(n,a,s,i,r),-1;break;case"StdNo":if(isNaN(g)||g.length>LengthOfStudentNo)return s=l.Cap+" نامعتبر است",p._ShowError(n,a,s,i,r),-1;break;case"LesNo":if(g.length>LengthOfLesNo)return s=l.Cap+" نامعتبر است",p._ShowError(n,a,s,i,r),-1}if(-1!=e.inArray(_,["Num","Int","Cur","Flt"])){var W=t.utils.NPChangeNumToLatin(g);if(isNaN(W))return s="Cmp"==l.Typ?"مقدار معتبری انتخاب نشده است":l.Cap+" نمي تواند غير عددي باشد",p._ShowError(n,a,s,i,r),-1;if(""!=l.Dec&&g.length-g.indexOf(".")-1>parseInt(l.Dec)&&g.indexOf(".")>=1)return s=l.Cap+'" نمي تواند بيش از '+l.Dec+' رقم اعشار داشته باشد"',p._ShowError(n,a,s,i,r),-1;if(""!=l.Fro&&g<parseFloat(l.Fro))return s=l.Cap+'" نمي تواند کوچکتر از  '+l.Fro+' باشد"',p._ShowError(n,a,s,i,r),-1;if(""!=l.To&&g>parseFloat(l.To))return s=l.Cap+'" نمي تواند بزرگتر از '+l.To+' باشد"',p._ShowError(n,a,s,i,r),-1}}else if("1"==d&&(!l.MSAutoC||"0"==l.MSAutoC))return s="مقدار معتبری انتخاب نشده است"+(!h&&l.Cap&&"-"!=l.Cap&&"LOOKUPF"!=l.Cap?": "+l.Cap:""),p._ShowError(n,a,s,i,r),-1;return p._ShowError(n,a,"",!1,r),1},ShowError:function(e,t,n,a,o){this._ShowError(e,t,n,a,o)},ShowErrorMessageCallback:e.noop,_ShowError:function(n,a,o,i,r){var l=this,s=l.element,d=l.options,p=(r=r||{}).$CurrObj;if(p){var c=r.GridId;if(c)var u=r.OrgGridId,m=r.NpColId;u&&o&&(l.Message({text:o,AfterSelect:function(){l.ShowErrorMessageCallback(null,c,m,o)}}),p.select(),p.focus())}else{var f=l.W_.FrmFld[a];if(f.WidgetSelf&&"Cmp"==f.Valid.Typ&&f.Valid.OnAC){var h=f.WidgetSelf.GetOrgId();f=f.WidgetSelf.W_.FrmFld[h]}var g=f.ElemTooltipOverlay,C=f.Elem;if(f&&"SHtm"==f.Valid.Typ&&(C=C.siblings("div")?C.siblings("div"):C),C&&C.length||(C=e("#"+n,s)).attr("GridId")&&(g=C),C&&C.length){if(!g){var v=C;f.ElemReqPar&&(v=f.ElemReqPar);var b=v.parent();g=b.is("span")?b:C,f.ElemTooltipOverlay=g}var _="";if(""!=o){if(""!==(_=f.lastnptitle||"")?(g.tooltip("dispose"),g.removeAttr("data-original-title")):(""==(_=C.attr("title")||"")&&(_="*"),f.lastnptitle=_),g.length>0&&!g.is(":visible")){for(g=g.parent();g.length>0&&!g.is(":visible");)g=g.parent();var F=g.attr("title");g.attr("title",o),setTimeout((function(){g.tooltip("dispose"),g.removeAttr("data-original-title"),g.attr("title",F||"")}),2e3)}else g.attr("title",o);t.noNg((()=>setTimeout((function(){g.tooltip("show"),t.noNg((()=>setTimeout((function(){g.tooltip("hide")}),3e3)))}),100))),i&&l.NPSetFocus(n,a,!1,i)}else""!==(_=f.lastnptitle||"")&&("*"==_&&(_=""),g.tooltip("dispose"),g.removeAttr("data-original-title"),g.attr("title",_),f.lastnptitle="")}else{var w=f.dm&&f.dm[0];w&&d.ParentCmp&&d.ParentCmp._ShowError(null,w,o,i)}}},NPFocusNextInGrid:function(t){for(var n=this,a=n.element,o=(n.options,t.attr("GridId")),i=0;++i<200;){var r=t.attr("GrdNexObjid");if(!(r=e("#"+r,a))||!r.length)return void(n.MakeOrgId(o)&&n.NPFocusNext(null,n.MakeOrgId(o)));if(r.is(":visible")&&!r.prop("readonly")&&!r.attr("readonly")&&!r.prop("disabled"))return r.focus(),void r.select();t=r}},NPFocusNext:function(t,n,a){var o,i=this,r=i.element,l=i.options,s=!1;if("Cmp"==t){if(a=n,(n=i.$ValidXml.r.FirstElem)||(n=null,e.each(i.$ValidXml.r.n,(function(e,t){return n=e,!1}))),s=!0,!n)return!1;t=i.MakeFullId(n)}else(a=a||i.W_.FrmFld[n]&&i.W_.FrmFld[n].Elem)&&a.blur();for(var d=0;d<500;){var p;if(!(p=i._SetCurrValidationData(n)))return;if(s||(n=p.Nex),s=!1,n&&!i.W_.FrmFld[n]&&i.W_.Alias2Id[n.toUpperCase()]&&(n=i.W_.Alias2Id[n.toUpperCase()]),(!n||!i.W_.FrmFld[n])&&l.ParentCmp)return t=r.parent().prop("id"),n=l.ParentCmp.MakeOrgId(t),void l.ParentCmp.NPFocusNext(t,n,a);if(!n||!i.W_.FrmFld[n]||"Com"===n||d>498)return void e("button:visible:not(.dropdown-toggle)",i.W_.$dvfrmFooter).each((function(t,n){var a=e(n);if(!a.is(":np-npButton")||!a.npButton("option","disabled"))return a.focus(),!1}));if(t=i.MakeFullId(n),o=i.W_.FrmFld[n].Elem,"DLbl"!=i.W_.FrmFld[n].Valid.Typ&&"_Var"!=i.W_.FrmFld[n].Valid.Typ&&o&&!(o.length<1)&&i.W_.FrmFld[n].Enable&&!o.prop("readonly")&&o.is(":visible")&&!o.attr("readonly"))break;d++}if(!(d>498)){try{if(i.W_.FrmFld[n]&&"Cmp"==i.W_.FrmFld[n].Valid.Typ&&i.W_.FrmFld[n].WidgetSelf.NPFocusNext("Cmp",a))return!0;switch(o.prop("tagName").toUpperCase()){case"BUTTON":case"SPAN":case"IMG":o.focus(),o.click();break;case"TEXTAREA":case"INPUT":o.focus(),o.select();break;case"SELECT":o.focus()}}catch(r){}return!0}},NPSetFocus:function(n,a,o,i){var r,l=this,s=(r=a&&l.W_.FrmFld[a]?l.W_.FrmFld[a].Elem:e("#"+n,l.W_.$bod)).attr("orgid")?r.attr("orgid"):a;s&&l.W_.FrmFld[s]&&"SHtm"==l.W_.FrmFld[s].Valid.Typ&&(r=r.siblings("div")?r.siblings("div"):r),a=a||r.attr("orgid");for(var d,p=l.W_.FrmFld,c=l.MakeOrgId(n);(d=c.indexOf("_W_"))&&d>-1;){var u=c.substring(0,d);if(!l.W_.FrmFld[u]||!l.W_.FrmFld[u].WidgetSelf)break;p=l.W_.FrmFld[u].WidgetSelf.W_.FrmFld,c=c.substr(d+3)}if(p[a]&&p[a].WidgetSelf&&"Cmp"==p[a].Valid.Typ&&p[a].Valid.OnAC){var m=p[a].WidgetSelf.GetOrgId();r=p[a].WidgetSelf.GetFldWidgetElem(m)}if(r.prop("readonly"))this.NPFocusNext(n,a);else{try{if(i)t.noNg((()=>setTimeout((function(){r[0].focus({preventScroll:o})}),0)));else if("DIV"===r.prop("tagName").toUpperCase())e("input:eq(0)",r)[0].focus({preventScroll:o});else t.noNg((()=>setTimeout((function(){r.data().datepicker||(r[0].focus({preventScroll:o}),r.select())}),0)))}catch(e){}o?("FIELDSET"!=r[0].tagName&&r.addClass("ui-state-highlight"),t.noNg((()=>setTimeout((function(){r.removeClass("ui-state-highlight")}),300)))):(r.addClass("ui-state-error"),t.noNg((()=>setTimeout((function(){r.removeClass("ui-state-error")}),300))))}return 1},SetDashOpr:function(e,t){t=this.Val(t),this.Val(e,t.split("@@")[1])},ValidAddCond:function(e){this.$ValidXml.r.modes["mod"+e.Mode].Cond.push({if:e.if})},ValidAddImgCond:function(e){this.$ValidXml.r.modes["mod"+e.Mode].imgCond.push({if:e.if})},ValidSetNexMod:function(e){this.$ValidXml.r.acts["act"+e.act].NexMod[e.p-1].mod=e.mod,e.cond&&(this.$ValidXml.r.acts["act"+e.act].NexMod[e.p-1].cond=e.cond)},ValidAddNexMod:function(e){var t=this;t.$ValidXml.r.acts["act"+e.act].NexMod=t.$ValidXml.r.acts["act"+e.act].NexMod||[],t.$ValidXml.r.acts["act"+e.act].NexMod.push({mod:e.mod,cond:e.cond||""})},ValidationDelete:function(t){var n=this.$ValidXml.r.modes,a=[t];this.RequireInitFrm=!0,e.each(n,(function(t,n){var o=n.Cond;e.each(o,(function(t,n){e.each(["Ena","Hide","Show","Dis","NReq","Req","Clear"],(function(t,o){n["Exc"+o]=n["Exc"+o]||{},e.each(a,(function(e,t){delete n["Exc"+o][t],delete n["Exc"+o][t+"_Div"]}))}))}))}))},Validation:function(t){var n,a=this,o=t.f,i=t.Mode,r=t.Cond;a.RequireInitFrm=!0,void 0===o&&(o="all"),void 0===i&&(i="all"),void 0===r&&(r="all"),"all"==o||Array.isArray(o)||(o=[o]),void 0!==t.display&&("none"==t.display?t.Show=0:t.Show=1),void 0!==t.Disa&&("true"==t.Disa?t.Ena=0:t.Ena=1),void 0!==t.Ena&&("disable"==t.Ena&&(t.Ena=0),"enable"==t.Ena&&(t.Ena=1)),void 0!==t.visibility&&("hidden"==t.visibility?t.Show=0:t.Show=1),void 0===t.Show&&void 0!==t.Hide&&(t.Show=1,1==t.Hide&&(t.Show=0)),void 0!==t.Show&&void 0===t.Hide&&(t.Hide=1,1==t.Show&&(t.Hide=0)),"all"==i?n=a.$ValidXml.r.modes:(n=[],Array.isArray(i)||(i=[i]),e.each(i,(function(e,t){a.$ValidXml.r.modes["mod"+t]&&n.push(a.$ValidXml.r.modes["mod"+t])}))),e.each(n,(function(n,i){var l=i.Cond;0==l.length&&l.push({if:""}),"all"!=r&&(l=[],Array.isArray(r)||(r=[r]),e.each(r,(function(e,t){i.Cond[t]&&l.push(i.Cond[t])}))),e.each(l,(function(n,i){e.each(["Ena","Hide","Show","Dis","NReq","Req","Clear"],(function(n,r){i["Exc"+r]=i["Exc"+r]||{},0===t[r]&&("all"==o?i["Exc"+r]={}:e.each(o,(function(e,t){"Hide"!=r&&"Show"!=r||a.W_.FrmFld[t+"_Div"]&&(t+="_Div"),delete i["Exc"+r][t]}))),1===t[r]&&"all"!=o&&e.each(o,(function(e,t){"Hide"!=r&&"Show"!=r||a.W_.FrmFld[t+"_Div"]&&(t+="_Div"),i["Exc"+r][t]=""}))}))}))}))},GetGidOfCellName:function(t){var n=[];return e.each(this.W_.FrmFld,(function(e,a){a.Valid.CellName==t&&n.push(e)})),n},CommanderIcon:function(t){var n,a=this,o=t.ImgId,i=t.Mode,r=t.Cond;void 0!==t.display&&("none"==t.display?t.Show=0:t.Show=1),void 0!==t.Disa&&("true"==t.Disa?t.Enable=0:t.Enable=1),a.RequireInitFrm=!0,void 0===o&&(o="all"),void 0===i&&(i="all"),void 0===r&&(r="all");var l={IM08_Control:"IM01",IM06_Search:"IM08",IM01_Create:"IM09",IM01_Delete:"IM09",IM03_Modify:"IM09",IM13_Do:"IM09",IM11_Reset:"IM99"};"all"==i?n=a.$ValidXml.r.modes:(n=[],Array.isArray(i)||(i=[i]),e.each(i,(function(e,t){a.$ValidXml.r.modes["mod"+t]&&n.push(a.$ValidXml.r.modes["mod"+t])}))),"all"==o||Array.isArray(o)||(o=[o]),e.each(o,(function(e,t){if(t.indexOf("xx_")>-1){var n=t.split("xx_")[1];o[e]=l[n]}})),e.each(n,(function(n,a){var i=a.imgCond;"all"!=r&&(i=[],Array.isArray(r)||(r=[r]),e.each(r,(function(e,t){a.imgCond[t]&&i.push(a.imgCond[t])}))),e.each(i,(function(n,a){"all"!=o&&t.Append&&e.each(o,(function(e,t){a[t]||(a[t]={})})),e.each(a,(function(e,n){"if"!=e&&(o.indexOf(e)>-1||"all"==o)&&(0===t.Show?n.Hidden=1:1===t.Show&&(n.Hidden=0),0===t.Enable?n.Enable="1":1===t.Enable&&(n.Enable="2"),t.Text&&(n.text=t.Text),t.Icon&&(n.icon=t.Icon))}))}))}))},ShowCommander:function(e){var t=this.$np("#tbFooterAlignmentRight",this.W_.$tbFooterAlignment);e?t.removeClass("np-d-none"):t.addClass("np-d-none")},OpenedInWindow:function(){return!!this.options.OpenInDialog},OpenWindow:function(t){var n=this,a=(n.element,n.options,(t=t||{}).ftype),o=t.fid,i=t.subfrm||0,r=t.outpar,l={outpar:{},doact:{}};e.each(r,(function(e,t){l.outpar[e]=t})),l.doact.act=t.doact,t.inxml=l,t.After=!0,n.OpenNewForm(a,o,i,t)},npnfwin:function(t,n,a,o,i,r,l,s){var d=this,p=(d.element,d.options,{ftype:t,fid:n=parseInt(n),subfrm:a,OpenInDialog:void 0===r||r,HideOpener:l||!1,OpenInDialog_ShowModal:s||!1,doact:o,ReturnCaption:"بازگشت",AfterClose:i,outpar:{},call:function(){for(var e=0;e<arguments.length;e+=2)this.outpar[arguments[e]]=arguments[e+1]},setscale:function(t,n){this.Width=t,"90%"==n&&(n=e(window).height()-150),this.Height=n,d.OpenWindow(this)}});return p},setValidation:function(e,t,n){var a=this;a.element,a.options;Array.isArray(e)||(e=[e]),"Nul"==t&&(t="Req",n="1"==n?"0":"1");for(var o=0;o<e.length;o++)a.W_.FrmFld[e[o]].Valid[t]=n},getValidation:function(e,t){var n=this;n.element,n.options;return n.W_.FrmFld[e].Valid[t]},reload:function(){location.reload()},Grid:function(t){var n=this,a=(n.element,n.options,t.id);switch(t.type){case"self":return n.$np("#"+a).npgrid("instance");case"rowcount":return t.Responsive?e("div.row:visible",n.$np("#"+a).npgrid("instance").$GridBody).length:e("tr",n.$np("#"+a).npgrid("instance").$GridBody).length;case"setoption":e.each(t.option,(function(e,t){n.$np("#"+a).npgrid("option",e,t)}));break;case"hidecol":(o=t.colname)&&n.$np("#"+a).npgrid("ShowHideColByName",o,1),t.width&&n.$np("#"+a).npgrid("instance")._vm.GridWidth(t.width);break;case"showcol":(o=t.colname)&&n.$np("#"+a).npgrid("ShowHideColByName",o,0),t.width&&n.$np("#"+a).npgrid("instance")._vm.GridWidth(t.width);break;case"showtag":var o=t.colname,i=n.$np("#"+a).npgrid("GetColId",o);n.$ValidXml.r.n[a].col[i].SHOWTAG=t.showtag,n.$np("#"+a).npgrid("SetShowTage",o,t.showtag);case"event":"change"==t.event&&n._on(e(n.$np("#"+a).npgrid("widget")),{"change :input[gridid]":t.change})}},RunAfterAct:function(){var e=this,t=(e.element,e.options);t.ReturnActParam&&e._trigger("AfterAct",null,t.ReturnActParam)},FadeShow:function(t,n,a){e(t).hide().fadeIn({duration:1e3})},FadeHide:function(t,n,a){e(t).hide({duration:1e3},(function(){}))},_destroy:function(){var t=this,n=t.options;e.each(t.W_.HelpGrids,(function(e,t){if(null!==t)try{t.remove()}catch(e){}})),e.each(t.W_.HelpDialogs,(function(e,t){if(null!==t)try{t.remove()}catch(e){}})),e.each(t.W_.FrmFld,(function(e,n){switch(n.Valid.Typ){case"Grd":n.Elem.is(":np-npgrid")&&n.Elem.npgrid("destroy");break;case"SHtm":case"Htm":ko.removeNode(t.$np("#"+e)[0])}})),ko.removeNode(t.W_.$bod[0]),delete n.IsCmp,delete n.ParentCmp,delete n.ParentCmp,delete n.UseOpenerAut,delete n.OpenerSelf,delete t.W_,delete t.Valid_,delete t.$ValidXml}})}(jQuery,NowPardaz),function(e){e.fn.pasteHtmlAtCaret=function(e,t,n){var a,o;if((t=t||window).getSelection){if((a=t.getSelection()).getRangeAt&&a.rangeCount){(o=a.getRangeAt(0)).deleteContents();var i=t.document.createElement("div");i.innerHTML=e;for(var r,l,s=t.document.createDocumentFragment();r=i.firstChild;)l=s.appendChild(r);o.insertNode(s),l&&((o=o.cloneRange()).setStartAfter(l),o.collapse(!0),a.removeAllRanges(),a.addRange(o))}}else t.document.selection&&"Control"!=t.document.selection.type&&t.document.selection.createRange().pasteHTML(e)},e.fn.NPSelectionStart=function(){if(this.length)return this[0].selectionStart},e.fn.NPSelectionEnd=function(){if(this.length)return this[0].selectionEnd},e.fn.NPSelectionText=function(){if(this.length){var e=this[0].selectionStart,t=this[0].selectionEnd,n=this[0].value;return void 0!==e&&t&&e!=t?n.substring(e,t):""}},e.fn.insertAtCaret=function(e){return this.each((function(){if(this.selectionStart||"0"==this.selectionStart){var t=this.selectionStart,n=this.selectionEnd,a=this.scrollTop;this.value=this.value.substring(0,t)+e+this.value.substring(n,this.value.length),this.focus(),this.selectionStart=t+e.length,this.selectionEnd=t+e.length,this.scrollTop=a}else this.value?this.value+=e:this.value=e,this.focus()}))},npLog=function(e,t){try{console&&(t?console.error(e):console.log(e))}catch(e){}}}(jQuery),function(e){var t,n;e.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},n={},(t=e.uaMatch(navigator.userAgent)).browser&&(n[t.browser]=!0,n.version=t.version),n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0),e.browser=n,e.sub=function(){function t(e,n){return new t.fn.init(e,n)}e.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(a,o){return o&&o instanceof e&&!(o instanceof t)&&(o=t(o)),e.fn.init.call(this,a,o,n)},t.fn.init.prototype=t.fn;var n=t(document);return t}}(jQuery),function(e){e.widget("np.npdownload",{options:{url:np.apiUrl+"/frm/npdwn/default.aspx",param:null,InData:null,AfterGO:null,BeginGO:null,EndGO:null},_create:function(){var e=this;e.options;e.element.click((function(){e.AfterClick()}))},AfterClick:function(){var t=this,n=t.options;t.element;if((!this.element||!e(this.element).hasClass("ui-state-disabled"))&&(t.data={},t._trigger("InData",null,t.data)))if(t._trigger("BeginGO")){var a=new FormData;a.append("medxml",escape(t.data.xml)),np.noNg((()=>fetch(n.url,{method:"POST",withCredentials:!0,body:a}).then((e=>e.text())).then((a=>{if(t._trigger("EndGO"),a&&(t.data.xml=e(a).find("#medxml").val())&&0!==t.data.xml.length){t.data.param=n.param,t._trigger("AfterGO",null,t.data);var o="",i=JSON.parse(t.data.xml);if(0==i.msg.errors.length){i.outpar&&e.each(i.outpar,(function(e,t){"cfn"!=e&&(o=o+"&"+e+"="+t)}));var r=i.outpar&&i.outpar.cfn||"NP.Zip";np.noNg((()=>{try{return fetch("/frm/npdwn/getfile.ashx?"+o.substr(1),{method:"GET",withCredentials:!0}).then((e=>{if(!e.ok)throw new Error(`Response status: ${e.status}`);return e.blob()})).then((e=>{var t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=r,document.body.appendChild(n),n.click(),n.remove()}))}catch(e){console.error(e)}}))}}else t.err=!0})).catch((e=>console.error("Error:",e)))))}else t.SetRespmsg({c:[{m:[{e:"1",m:"لطفا صبر کنید"}]}]})}}),e.widget("np.npupload",{options:{url:np.apiUrl+"/frm/npupl/default.aspx",param:null,AppendTo:null,InData:null,AfterGO:null,BeginGO:null,EndGO:null},_create:function(){var t=this,n=t.options,a=t.element,o="upload"+(new Date).getTime()+parseInt(1e6*Math.random());t.uploadElem=e('<input type="file" id="'+o+'" style="display:none" />').appendTo(n.AppendTo),t.uploadElem.change((function(){var a=t.uploadElem.get(0);if(a.files.length)if(t._trigger("BeginGO")){var o=new FormData;o.append("medxml",t.medxml),o.append("fileupl",a.files[0]),np.noNg((()=>fetch(n.url,{method:"POST",withCredentials:!0,body:o}).then((e=>e.text())).then((o=>{a.value="",t._trigger("EndGO"),o&&(t.data.xml=e(o).find("#medxml").val())&&0!==t.data.xml.length?(t.data.param=n.param,t._trigger("AfterGO",null,t.data)):t.err=!0})).catch((e=>{a.value="",console.error("Error:",e)}))))}else t.SetRespmsg({c:[{m:[{e:"1",m:"لطفا صبر کنید"}]}]})})),a.click((function(){t.AfterClick()}))},AfterClick:function(){var t=this;t.options,t.element;this.element&&e(this.element).hasClass("ui-state-disabled")||(t.data={},t._trigger("InData",null,t.data)&&(t.medxml=escape(t.data.xml),t.uploadElem.click()))},_destroy:function(){this.uploadElem.remove()}})}(jQuery),function(e){e.widget("np.npmessage",{options:{type:"alert",text:"",height:200,width:300,title:"پيغام",category:"def",MessageCallback:null},_create:function(){var t=this,n=t.options,a=t.element;t.AlertButton={"تایید":function(){t.TriggerFired=!0,e(this).npUiDialog("close"),t._trigger("MessageCallback",null)}},t.ConfirmButton=[{text:"بله",click:function(){t.TriggerFired=!0,e(this).npUiDialog("close"),t._trigger("MessageCallback",null,{yes:!0,no:!1})},class:"offset-1"},{text:"خیر",click:function(){t.TriggerFired=!0,e(this).npUiDialog("close"),t._trigger("MessageCallback",null,{yes:!1,no:!0})}}],t.DialogContent=e("<div/>"),a.append(t.DialogContent),t.DialogContent.npUiDialog({autoOpen:!1,closeOnEscape:!1,resizable:!1,appendTo:a,title:n.title,modal:!0,close:function(){t.TriggerFired||(t.ConfirmButton==t.DialogContent.npUiDialog("option","buttons")?t._trigger("MessageCallback",null,{yes:!1,no:!0}):t._trigger("MessageCallback",null))}})},Dialog:function(e){var t,n=this,a=n.options;n.element;a.MessageCallback=e.AfterSelect||null,t="confirm"==(e.type||a.type)?n.ConfirmButton:n.AlertButton;var o="err"==a.category?"text-danger":"suc"==a.category?"text-success":"";n.DialogContent.html("<p style='text-align:center;padding-top:20px;padding-right:30px;padding-left:30px' class='"+o+"'>"+e.text+"</p>"),n.TriggerFired=!1,n.DialogContent.npUiDialog("option","title",e.title||a.title).npUiDialog("option","CloseParentModal",!1).npUiDialog("option","width",e.width||a.width).npUiDialog("option","buttons",t).npUiDialog("open")}}),e.widget("np.npeditor",{options:{npform:null,Minimize:"0",title:null,change:null,HideIcon:!1},_create:function(){var t=this,n=t.options,a=t.element;id=a.attr("id");var o=a.outerWidth()-3,i=a.outerHeight();o<200&&(o=450),i<45&&(i=45),t.EditorHeight=0,t.ElemId=a.attr("id")+"_Editor";var r=a[0].className||"",l=a[0].style.width?a[0].style.width:"auto",s=parseInt(i)+20;t.Parent=e("<div style='border:1px solid #ccc;;width:"+l+";heigh_t:"+s+"px;overflow:hidden'class='m-2 border-radius6000 "+r+"'></div>"),t.RequireSpan=e("<span style='float:left;display:none'>*</span>").appendTo(t.Parent);var d=null;"1"==n.Minimize?d=e("<i class='npglyphicon npglyph-popout text-success' style='font-size:17px' title='"+n.title+"' ></i>").appendTo(t.Parent):n.HideIcon||(d=e("<i class='npglyphicon npglyph-popout text-success' style='font-size:17px' ></i>").appendTo(t.Parent)),t.FullScr=d,t.Main=e("<div style='padding:0px;margin:0px;height:"+i+"px;overflow-y:scroll;width:100%'  ></div>").appendTo(t.Parent),"1"==n.Minimize&&t.Main.css("display","none"),t.Buttons=e("<div style='display:none;padding:auto 8px;margin-bottom:5px' class='bg-info'><button class='btn btn-info' style='padding:3px 8px;margin-left:4px;margin-right:4px'><i id='bold' title='درشت' class='npglyphicon glyphicon-bold' style='margin-left:10px' ></i></button><button class='btn btn-info' style='padding:3px 8px;margin-left:4px'><i id='italic' title='کج' class='npglyphicon glyphicon-italic' style='margin-left:10px'></i></button><button class='btn btn-info' style='padding:3px 8px;margin-left:4px'><i id='JustifyLeft' title='چپ چین' class='npglyphicon npglyphicon-align-left2' style='margin-left:10px'></i></button><button class='btn btn-info' style='padding:3px 8px;margin-left:4px'><i id='JustifyCenter' title='وسط چین' class='npglyphicon npglyphicon-align-center2' style='margin-left:10px'></i></button><button class='btn btn-info' style='padding:3px 8px;margin-left:4px'><i id='JustifyRight' title='راست چین' class='npglyphicon npglyphicon-align-right2' style='margin-left:10px'></i></button><button class='btn btn-info' style='padding:3px 8px;margin-left:4px'><i id='underline' title='زیر خط دار' class='npglyphicon npglyphicon-COMM'></i></button></div>").appendTo(t.Main),t.BackButton=e("<button class='btn btn-outline-danger' style='display:none;padding: 3px 6px;float:left;margin-left:10px' ></button>"),t.Buttons.append(t.BackButton);var p=a.attr("dir")||np.rtl,c="ltr"==p?"left":"right",u=t.Editor=e("<div id="+t.ElemId+" contenteditable='true' class='np-editor' dir='"+p+"'   style='text-align:"+c+";white-space: pre-wrap;width:auto;height:auto;display:block;outline:none;word-wrap: break-word;margin-right:5px' ></div>").appendTo(t.Main);t.HtmlBox=e("<div style='display:none'><textarea cols='50' rows='2' dir='ltr'></textarea><button>ثبت</button></div>").appendTo(t.Parent),t.Parent.insertAfter(a),np.noNg((()=>setTimeout((function(){a.hide()}),100))),t._on(t.Main,{click:function(){u.focus()}}),t._on(!0,d,{click:function(n){t.parentModal=e(n.currentTarget).closest(".modal"),d.hide(),t.Buttons.show();var a=t.options.npform.Get$bod();Array.max([e("body").height()-300,parseInt(4*e("body").height()/5,10)]),Array.max([a.width()-300,parseInt(4*a.width()/5,10)]);t.Main.SimpleDialog({title:"ویرایشگر متن",show:!0,destroyOnClose:!0,appendTo:t.options.npform.$np("#bod"),onShow:function(e,n){t.Main.css("height","auto")},onShow_:function(n,a){if(n.target.style.overflowY="visible",n.target.parentElement.style.overflow="auto",n.target.style.width="fit-content",n.target.style.minWidth="100%",u.focus(),t.SetZIndex(e(n.target).parent()),0!=t.parentModal.length){var o="<span>بازگشت به : </span> "+e(".modal-title",t.parentModal).text();t.BackButton.show().html(o)}t.UpdateToolbar()},close:function(e,n){t.Buttons.hide(),d.show()}})}}),t._on(t.HtmlBox,{"click button":function(n){u.pasteHtmlAtCaret(e("textarea",t.HtmlBox).val(),u.contentWindow,u)}}),t._on(u,{blur:function(e){t._trigger("change",e,{Val:u.html().replace(/style="color: rgb\(133, 133, 133\);"/g,"")})},keyup:function(n){t.options.npform._KeyUp(n,e(t.element)),t.UpdateToolbar()},keypress:function(n){t.options.npform._KeyPress(n,e(t.element),{EditorId:u})},paste:function(e){var t;return e.originalEvent.clipboardData&&(t=(t=e.originalEvent.clipboardData.getData("text/plain")).replace(/\r\n/g,"<br />").replace(/\n\r/g,"<br />").replace(/\n/g,"<br />").replace(/\r/g,"<br />"),document.execCommand("insertHTML",!1,t)),!1},mouseup:function(){t.UpdateToolbar()}}),t._on(t.Buttons,{"click button":function(n){var a=e(n.currentTarget).find("i");switch(document.execCommand("styleWithCSS",!1,!1),a.attr("id")){case"bold":document.execCommand("bold",0,null);break;case"italic":document.execCommand("italic",0,null);break;case"underline":document.execCommand("underline",0,null);break;case"JustifyLeft":document.execCommand("JustifyLeft",0,null);break;case"JustifyRight":document.execCommand("JustifyRight",0,null);break;case"JustifyCenter":document.execCommand("JustifyCenter",0,null);break;case"ltr":case"rtl":document.execCommand("fontName",!1,"_");var o=a.attr("id"),i="ltr"==o?"left":"right",r=0,l=e("[style*='_']",t.Editor),s=e("[face*='_']",t.Editor);0!=l.length?(r=1,l.parent("div").hasClass("np-editor")?(l.wrap("<div></div>"),l.css("font-family","tahoma").parent("div").css("text-align",i).attr("dir",o)):l.parent("div").css("text-align",i).attr("dir",o)):0!=s.length&&(r=1,"0"!=s.closest("p").length?s.closest("p").attr("align",i).attr("dir",o):(s.wrap("<p></p>"),s.attr("face","tahoma").closest("p").attr("align",i).attr("dir",o))),document.execCommand("fontName",!1,"tahoma"),t.Editor.attr("dir",np.rtl),r&&a.addClass("ui-state-highlight")}t.UpdateToolbar()}})},SetZIndex:function(e){},getSelectionCoords:function(e){var t,n,a=(e=e||window).document.selection,o=0;return a?(t=document.createRange(),document.getElementById(this.ElemId).getClientRects()[0]&&(o=document.getElementById(this.ElemId).getClientRects()[0].bottom)):e.getSelection&&(a=e.getSelection()).rangeCount&&(t=a.getRangeAt(0).cloneRange()).getClientRects&&(t.collapse(!0),t.getClientRects().length>0&&(n=t.getClientRects()[0]),n&&(o=n.top)),o},UpdateToolbar:function(){var t=this;t.options,t.element;e(["bold","italic","JustifyLeft","JustifyRight","JustifyCenter","underline"]).each((function(n,a){document.queryCommandState(a)?e("#"+a,t.Buttons).parent("button").removeClass("btn-info").addClass("btn-success"):e("#"+a,t.Buttons).parent("button").addClass("btn-info").removeClass("btn-success")})),np.noNg((()=>setTimeout((function(){e("#ltr",t.Buttons).removeClass("ui-state-highlight"),e("#rtl",t.Buttons).removeClass("ui-state-highlight")}),1e3)))},Require:function(e){var t=this;t.options,t.element;e?t.RequireSpan.show():t.RequireSpan.hide()},_setOption:function(e,t){var n=this;"readonly"!==e&&"disabled"!==e||(this.Editor.prop("contentEditable",!t),
//!value?ed.removeClass('ui-state-disabled'):ed.addClass('ui-state-disabled');
t?(n.Main.css("cursor","default"),n.FullScr&&n.FullScr.removeClass("text-success")):(n.Main.css("cursor","text"),n.FullScr&&n.FullScr.addClass("text-success")));this._super(e,t)},Val:function(e,t){if(void 0!==e){var n=np.utils.StandardHtml(e);n.flag?this.Editor.html(e):this.Editor.html(n.Str)}return this.Editor.html()},_destroy:function(){this.options,this.element}}),e.widget("np.npStepNav",{options:{npformSelf:null,navs:[],AfterAct:null,inxml:null,type:1,OnlyUpdateNav:0},_create:function(){var e=this,t=e.element;e.options;t.addClass("d-flex flex-column sw-main sw-theme-arrows"),e.main="",e.OpenedFaci=[]},Run:function(){var t=this,n=t.element,a=t.options;t.ul=e("<ul class='nav nav-tabs step-anchor' />"),a.OnlyUpdateNav?(e("ul:first",n).remove(),n.prepend(t.ul)):(n.empty(),n.append(t.ul)),t.ul.append("<li class='disabled'><a href='#' style='height:auto;display:none' > </a></li>");for(var o=-1,i=0;i<a.navs.length;i++){var r="1"==a.navs[i].disable?"disabled":"";r="1"==a.navs[i].active?"active":r,t.ul.append("<li  class='"+r+"' order='"+i+"' act='"+a.navs[i].act+"'><a  href='javascript:void(0)' ><div style='white-space:  nowrap;overflow: hidden;text-overflow: ellipsis;' title='"+a.navs[i].label+"'>"+a.navs[i].label+"</div></a></li>"),"1"==a.navs[i].active&&(o=i)}e("li",t.ul).on("click",(function(n){e(this).hasClass("disabled")||(e(this).addClass("active").siblings().removeClass("active"),t.openFaci(t.options.navs[e(this).attr("order")],e(this).attr("order")))})),-1==o||a.OnlyUpdateNav||t.openFaci(a.navs[o],o)},openFaci:function(t,n){var a=this,o=a.element,i=a.options,r=t.act;e(".tooltip.show","body").remove(),""!=a.main&&o.children("div").remove(),a.main=e("<div />").uniqueId();var l=a.main.attr("id"),s='<div class="d-flex flex-grow-1" style="position:relative;heigh_t:calc(100% - '+a.ul.height()+'px" id="'+i.npformSelf.MakeFullId(l)+'_W_"></div>';a.main.empty().html(s),a.main=i.npformSelf.$np("#"+l+"_W_",a.main),o.append(a.main);var d={HideOpener:!1,OpenInline:!0,InlineBox:a.main,HideFo_oter:!0,AfterAct:i.AfterAct,ReturnCaption:"",inxml:i.inxml,Active:t};i.npformSelf.$np("#dvfrmFooter").hide(),d.AfterNav=function(e){e.msg.c.length&&i.npformSelf.$np("#dvfrmFooter").show()},i.npformSelf.DoAct(r,null,d)},_setOption:function(e,t){this._super(e,t),"navs"===e&&this.Run()}}),e.widget("np.npDropdown",{options:{list:[],position:"bottom",relativeTo:null,clickCallBack:null,ItemsStyle:null,ItemClass:null},_create:function(){var e=this;e.element,e.options;e.createDropdown(),e.setPosition(),e.AddEvents()},createDropdown:function(){var t,n=this,a=n.element,o=n.options;t="bottom"==o.position?"top:"+(t=e(a).offset().top+15)+"px":"bottom:"+(t=e(window).height()-e(a).offset().top)+"px";var i=e(a).offset().left+"px";n.DropdownContainer=e("<div class='npDropdown' style='position:absolute;"+t+";left:"+i+"' ></div>"),n.DropdownUl=e("<div class='npDropdown-content'></div>"),e.each(o.list,(function(e,t){var a=o.ItemClass||t.ItemClass,i=o.ItemsStyle||t.ItemsStyle;n.DropdownUl.append("<span class='"+a+"' style='cursor:pointer;"+i+"' >"+t.text+"</span>")})),n.DropdownContainer.append(n.DropdownUl),e("body").append(n.DropdownContainer)},setPosition:function(){var t=this,n=t.element,a=t.options,o=a.relativeTo?a.relativeTo:n;if("bottom"==a.position){var i=e(o).offset().top+e(o).outerHeight();if(i+t.DropdownContainer.height()+50>e(window).height())return a.position="top",void t.setPosition();t.DropdownContainer.css({top:i+"px",bottom:"auto"})}else{var r=e(window).height()-e(o).offset().top;t.DropdownContainer.css({bottom:r+"px",top:"auto"}),t.DropdownContainer.height()>n.offset().top&&t.DropdownContainer.css({height:n.offset().top+"px",overflow:"auto"})}var l=e(o).offset().left;l+t.DropdownContainer.width()+50>e(window).width()?(t.DropdownContainer.css("left","auto"),t.DropdownContainer.css("right","0px")):t.DropdownContainer.css("left",l+"px")},AddEvents:function(){var t=this,n=t.element,a=t.options,o=a.relativeTo?a.relativeTo:n;e(o).on("mouseover",(function(){t.Remove=!1})),e(o).on("mouseleave",(function(){t.Remove=!0,np.noNg((()=>setTimeout((function(){t.Remove&&t.DropdownContainer&&t.RemoveDropdown(),t.Remove=!0}),700)))})),t.DropdownContainer.on("mouseleave",(function(){t.Remove=!0,t.DropdownContainer&&t.RemoveDropdown()})),t.DropdownContainer.on("mouseover",(function(){t.Remove=!1})),e("span",t.DropdownContainer).on("click",(function(n){a.clickCallBack&&(a.clickCallBack.call(this,n.currentTarget,a.list[e(this).index()]),t.RemoveDropdown())}))},RemoveDropdown:function(){var e=this;e.element,e.options;e.DropdownContainer.remove(),e.DropdownContainer=void 0,e.destroy()}}),e.widget("np.npPopup",{options:{text:null,position:"bottom",minWidth:e(window).width()/8,width:e(window).width()/4,height:"auto",clickContent:null,parent:null},_create:function(){var t=this,n=t.element,a=t.options;e(n).html();t.Remove=!0,t.Popup=e("<div class='npPopup'  style='width:"+a.width+"px;height:"+a.height+"px' />").html(a.text),a.parent?(a.parent.npPopup=t.Popup,appendTo=a.parent.W_.$bod):appendTo=e("body"),t.Popup.appendTo(appendTo),t.FixWidthAndHeight(),t.setPosition(),t.AddEvents(),t.Popup.on("click",(function(e){t._trigger("clickContent",null,{event:e})}))},FixWidthAndHeight:function(){var t=this,n=(t.element,t.options);for(n.width;t.Popup.height()>t.Popup.width()/(e(window).width()/e(window).height());){if(t.Popup.width()>e(window).width()){t.height(t.Popup.width()/(e(window).width()/e(window).height()));break}t.Popup.width(t.Popup.width()+n.minWidth/10)}},setPosition:function(){var t=this,n=t.element,a=t.options;if("bottom"==a.position){var o=e(n).offset().top+15;if(o+t.Popup.height()+50>e(window).height())return a.position="top",void t.setPosition();t.Popup.css({top:o+"px",bottom:"auto"})}else{var i=e(window).height()-e(n).offset().top;t.Popup.css({bottom:i+"px",top:"auto"})}var r=e(n).offset().left;r+t.Popup.width()+50>e(window).width()?(t.Popup.css("left","auto"),t.Popup.css("right","0px")):t.Popup.css("left",r+"px")},AddEvents:function(){var t=this,n=t.element;t.options;e(n).on("mouseover",(function(){t.Remove=!1})),e(n).on("mouseleave",(function(){t.Remove=!0,np.noNg((()=>setTimeout((function(){t.Remove&&t.Popup&&t.RemovePopup(),t.Remove=!0}),700)))})),t.Popup.on("mouseleave",(function(n){np.noNg((()=>setTimeout((function(){1!=e(n.relatedTarget).closest(".npDropdown").length&&(t.RemovePopup(),t.Remove=!0)}),0)))})),t.Popup.on("mouseover",(function(){t.Remove=!1}))},HidePopup:function(){var t=this.element;this.options;e(t).hide()},ShowPopup:function(){var t=this.element;this.options;e(t).hide()},RemovePopup:function(){var e=this;e.element,e.options;e.Popup.remove(),e.destroy()}})}(jQuery);
